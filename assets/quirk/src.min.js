!function(a){"use strict";function b(a){a.Reflect=a.Reflect||{},a.Reflect.global=a.Reflect.global||a}if(!a.$traceurRuntime){b(a);var c=function(a){
return typeof a};a.$traceurRuntime={options:{},setupGlobals:b,"typeof":c}}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this),
function(){function a(a,b,c,d,e,f,g){var h=[];return a&&h.push(a,":"),c&&(h.push("//"),b&&h.push(b,"@"),h.push(c),d&&h.push(":",d)),
e&&h.push(e),f&&h.push("?",f),g&&h.push("#",g),h.join("")}function b(a){return a.match(h)}function c(a){if("/"===a)return"/";for(var b="/"===a[0]?"/":"",c="/"===a.slice(-1)?"/":"",d=a.split("/"),e=[],f=0,g=0;g<d.length;g++){
var h=d[g];switch(h){case"":case".":break;case"..":e.length?e.pop():f++;break;default:e.push(h)}}if(!b){for(;f-- >0;)e.unshift("..");
0===e.length&&e.push(".")}return b+e.join("/")+c}function d(b){var d=b[i.PATH]||"";return d=c(d),b[i.PATH]=d,a(b[i.SCHEME],b[i.USER_INFO],b[i.DOMAIN],b[i.PORT],b[i.PATH],b[i.QUERY_DATA],b[i.FRAGMENT]);
}function e(a){var c=b(a);return d(c)}function f(a,c){var e=b(c),f=b(a);if(e[i.SCHEME])return d(e);e[i.SCHEME]=f[i.SCHEME];for(var g=i.SCHEME;g<=i.PORT;g++)e[g]||(e[g]=f[g]);
if("/"==e[i.PATH][0])return d(e);var h=f[i.PATH],j=h.lastIndexOf("/");return h=h.slice(0,j+1)+e[i.PATH],e[i.PATH]=h,d(e)}function g(a){
if(!a)return!1;if("/"===a[0])return!0;var c=b(a);return!!c[i.SCHEME]}var h=new RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([\\w\\d\\-\\u0100-\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),i={
SCHEME:1,USER_INFO:2,DOMAIN:3,PORT:4,PATH:5,QUERY_DATA:6,FRAGMENT:7};$traceurRuntime.canonicalizeUrl=e,$traceurRuntime.isAbsolute=g,
$traceurRuntime.removeDotSegments=c,$traceurRuntime.resolveUrl=f}(),function(a){"use strict";function b(a,b){this.url=a,this.value_=b;
}function c(a,b){this.message=this.constructor.name+": "+this.stripCause(b)+" in "+a,b instanceof c||!b.stack?this.stack="":this.stack=this.stripStack(b.stack);
}function d(a,b){var c=[],d=b-3;0>d&&(d=0);for(var e=d;b>e;e++)c.push(a[e]);return c}function e(a,b){var c=b+1;c>a.length-1&&(c=a.length-1);
for(var d=[],e=b;c>=e;e++)d.push(a[e]);return d}function f(a){for(var b="",c=0;a-1>c;c++)b+="-";return b}function g(a,c){b.call(this,a,null),
this.func=c}function h(a){if(a){var b=r.normalize(a);return o[b]}}function i(a){var b=arguments[1],c=Object.create(null);return Object.getOwnPropertyNames(a).forEach(function(d){
var e,f;if(b===q){var g=Object.getOwnPropertyDescriptor(a,d);g.get&&(e=g.get)}e||(f=a[d],e=function(){return f}),Object.defineProperty(c,d,{
get:e,enumerable:!0})}),Object.preventExtensions(c),c}var j,k=$traceurRuntime,l=k.canonicalizeUrl,m=k.resolveUrl,n=k.isAbsolute,o=Object.create(null);
j=a.location&&a.location.href?m(a.location.href,"./"):"",c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c.prototype.stripError=function(a){
return a.replace(/.*Error:/,this.constructor.name+":")},c.prototype.stripCause=function(a){return a?a.message?this.stripError(a.message):a+"":"";
},c.prototype.loadedBy=function(a){this.stack+="\n loaded by "+a},c.prototype.stripStack=function(a){var b=[];return a.split("\n").some(function(a){
return/UncoatedModuleInstantiator/.test(a)?!0:void b.push(a)}),b[0]=this.stripError(b[0]),b.join("\n")},g.prototype=Object.create(b.prototype),
g.prototype.getUncoatedModule=function(){var b=this;if(this.value_)return this.value_;try{var g;return void 0!==typeof $traceurRuntime&&$traceurRuntime.require&&(g=$traceurRuntime.require.bind(null,this.url)),
this.value_=this.func.call(a,g)}catch(h){if(h instanceof c)throw h.loadedBy(this.url),h;if(h.stack){var i=this.func.toString().split("\n"),j=[];
h.stack.split("\n").some(function(a,c){if(a.indexOf("UncoatedModuleInstantiator.getUncoatedModule")>0)return!0;var g=/(at\s[^\s]*\s).*>:(\d*):(\d*)\)/.exec(a);
if(g){var h=parseInt(g[2],10);j=j.concat(d(i,h)),1===c?j.push(f(g[3])+"^ "+b.url):j.push(f(g[3])+"^"),j=j.concat(e(i,h)),j.push("= = = = = = = = =");
}else j.push(a)}),h.stack=j.join("\n")}throw new c(this.url,h)}};var p=Object.create(null),q={},r={normalize:function(a,b,c){if("string"!=typeof a)throw new TypeError("module name must be a string, not "+typeof a);
if(n(a))return l(a);if(/[^\.]\/\.\.\//.test(a))throw new Error("module name embeds /../: "+a);return"."===a[0]&&b?m(b,a):l(a)},get:function(a){
var b=h(a);if(b){var c=p[b.url];return c?c:(c=i(b.getUncoatedModule(),q),p[b.url]=c)}},set:function(a,b){a=String(a),o[a]=new g(a,function(){
return b}),p[a]=b},get baseURL(){return j},set baseURL(a){j=String(a)},registerModule:function(a,b,c){var d=r.normalize(a);if(o[d])throw new Error("duplicate module named "+d);
o[d]=new g(d,c)},bundleStore:Object.create(null),register:function(a,b,c){b&&(b.length||c.length)?this.bundleStore[a]={deps:b,execute:function(){
var a=arguments,d={};b.forEach(function(b,c){return d[b]=a[c]});var e=c.call(this,d);return e.execute.call(this),e.exports}}:this.registerModule(a,b,c);
},getAnonymousModule:function(b){return new i(b.call(a),q)}},s=new i({ModuleStore:r});r.set("@traceur/src/runtime/ModuleStore.js",s);
var t=$traceurRuntime.setupGlobals;$traceurRuntime.setupGlobals=function(a){t(a)},$traceurRuntime.ModuleStore=r,$traceurRuntime.registerModule=r.registerModule.bind(r),
$traceurRuntime.getModule=r.get,$traceurRuntime.setModule=r.set,$traceurRuntime.normalizeModuleName=r.normalize}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/new-unique-string.js",[],function(){"use strict";function a(){
return"__$"+(1e9*b()>>>1)+"$"+ ++c+"$__"}var b=Math.random,c=Date.now()%1e9,d=a;return{get default(){return d}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/has-native-symbols.js",[],function(){
"use strict";function a(){return b}var b=!!Object.getOwnPropertySymbols&&"function"==typeof Symbol,c=a;return{get default(){return c;
}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/symbols.js",[],function(){"use strict";function a(a){
return{configurable:!0,enumerable:!1,value:a,writable:!0}}function b(a){var b=i();l(this,s,{value:this}),l(this,q,{value:b}),l(this,r,{
value:a}),m(this),t[b]=this}function c(a){return t[a]}function d(a){for(var b=[],d=0;d<a.length;d++)c(a[d])||b.push(a[d]);return b;
}function e(a){return d(n(a))}function f(a){return d(o(a))}function g(a){for(var b=[],c=n(a),d=0;d<c.length;d++){var e=t[c[d]];e&&b.push(e);
}return b}function h(b){var c=b.Object;j()||(b.Symbol=u,c.getOwnPropertyNames=e,c.keys=f,l(c,"getOwnPropertySymbols",a(g))),b.Symbol.iterator||(b.Symbol.iterator=b.Symbol("Symbol.iterator")),
b.Symbol.observer||(b.Symbol.observer=b.Symbol("Symbol.observer"))}var i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../new-unique-string.js","traceur-runtime@0.0.104/src/runtime/modules/symbols.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../has-native-symbols.js","traceur-runtime@0.0.104/src/runtime/modules/symbols.js"))["default"],k=Object.create,l=Object.defineProperty,m=Object.freeze,n=Object.getOwnPropertyNames,o=Object.keys,p=TypeError,q=i(),r=i(),s=i(),t=k(null),u=function(a){
var c=new b(a);if(!(this instanceof u))return c;throw new p("Symbol cannot be new'ed")};l(u.prototype,"constructor",a(u)),l(u.prototype,"toString",a(function(){
var a=this[s];return a[q]})),l(u.prototype,"valueOf",a(function(){var a=this[s];if(!a)throw p("Conversion from symbol to string");
return a[q]})),l(b.prototype,"constructor",a(u)),l(b.prototype,"toString",{value:u.prototype.toString,enumerable:!1}),l(b.prototype,"valueOf",{
value:u.prototype.valueOf,enumerable:!1}),m(b.prototype);var v="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;
h(v);var w=j()?function(a){return typeof a}:function(a){return a instanceof b?"symbol":typeof a};return{get typeof(){return w}}}),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/typeof.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./symbols.js","traceur-runtime@0.0.104/src/runtime/modules/typeof.js"));
return{get default(){return a["typeof"]}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/symbols.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/typeof.js","traceur-runtime@0.0.104/src/runtime/symbols.js"))["default"];
return $traceurRuntime["typeof"]=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/createClass.js",[],function(){
"use strict";function a(a,b){m(a).forEach(b),n&&n(a).forEach(b)}function b(b){var c={};return a(b,function(a){c[a]=l(b,a),c[a].enumerable=!1;
}),c}function c(b){a(b,function(a){k(b,a,o)})}function d(a,d,f,g){return k(d,"constructor",{value:a,configurable:!0,enumerable:!1,
writable:!0}),arguments.length>3?("function"==typeof g&&(a.__proto__=g),a.prototype=i(e(g),b(d))):(c(d),a.prototype=d),k(a,"prototype",{
configurable:!1,writable:!1}),j(a,b(f))}function e(a){if("function"==typeof a){var b=a.prototype;if(f(b)===b||null===b)return a.prototype;
throw new g("super prototype must be an Object or null")}if(null===a)return null;throw new g("Super expression must either be null or a function, not "+typeof a+".");
}var f=Object,g=TypeError,h=Object,i=h.create,j=h.defineProperties,k=h.defineProperty,l=h.getOwnPropertyDescriptor,m=h.getOwnPropertyNames,n=h.getOwnPropertySymbols,o={
enumerable:!1},p=d;return{get default(){return p}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/superConstructor.js",[],function(){
"use strict";function a(a){return a.__proto__}var b=a;return{get default(){return b}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/superDescriptor.js",[],function(){
"use strict";function a(a,b){var e=d(a);do{var f=c(e,b);if(f)return f;e=d(e)}while(e)}var b=Object,c=b.getOwnPropertyDescriptor,d=b.getPrototypeOf,e=a;
return{get default(){return e}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/superGet.js",[],function(){
"use strict";function a(a,c,d){var e=b(c,d);if(e){var f=e.value;return f?f:e.get?e.get.call(a):f}}var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./superDescriptor.js","traceur-runtime@0.0.104/src/runtime/modules/superGet.js"))["default"],c=a;
return{get default(){return c}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/superSet.js",[],function(){
"use strict";function a(a,d,e,f){var g=b(d,e);if(g&&g.set)return g.set.call(a,f),f;throw c("super has no setter '"+e+"'.")}var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./superDescriptor.js","traceur-runtime@0.0.104/src/runtime/modules/superSet.js"))["default"],c=TypeError,d=a;
return{get default(){return d}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/classes.js",[],function(){"use strict";
var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/createClass.js","traceur-runtime@0.0.104/src/runtime/classes.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/superConstructor.js","traceur-runtime@0.0.104/src/runtime/classes.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/superGet.js","traceur-runtime@0.0.104/src/runtime/classes.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/superSet.js","traceur-runtime@0.0.104/src/runtime/classes.js"))["default"];
return $traceurRuntime.createClass=a,$traceurRuntime.superConstructor=b,$traceurRuntime.superGet=c,$traceurRuntime.superSet=d,{}}),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/exportStar.js",[],function(){"use strict";function a(a){
for(var b=arguments,e=function(e){var f,g=b[e],h=d(g),i=function(b){var d=h[b];return"__esModule"===d||"default"===d?0:void c(a,d,{
get:function(){return g[d]},enumerable:!0})};a:for(var j=0;j<h.length;j++)switch(f=i(j)){case 0:continue a}},f=1;f<arguments.length;f++)e(f);
return a}var b=Object,c=b.defineProperty,d=b.getOwnPropertyNames,e=a;return{get default(){return e}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/exportStar.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/exportStar.js","traceur-runtime@0.0.104/src/runtime/exportStar.js"))["default"];
return $traceurRuntime.exportStar=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/private-symbol.js",[],function(){
"use strict";function a(a){return l[a]}function b(){var a=(i||h)();return l[a]=!0,a}function c(a,b){return hasOwnProperty.call(a,b);
}function d(a,b){return c(a,b)?(delete a[b],!0):!1}function e(a,b,c){a[b]=c}function f(a,b){var c=a[b];if(void 0!==c)return hasOwnProperty.call(a,b)?c:void 0;
}function g(){j&&(Object.getOwnPropertySymbols=function(b){for(var c=[],d=j(b),e=0;e<d.length;e++){var f=d[e];a(f)||c.push(f)}return c;
})}var h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./new-unique-string.js","traceur-runtime@0.0.104/src/runtime/private-symbol.js"))["default"],i="function"==typeof Symbol?Symbol:void 0,j=Object.getOwnPropertySymbols,k=Object.create,l=k(null);
return{get isPrivateSymbol(){return a},get createPrivateSymbol(){return b},get hasPrivate(){return c},get deletePrivate(){return d;
},get setPrivate(){return e},get getPrivate(){return f},get init(){return g}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/private-weak-map.js",[],function(){
"use strict";function a(a){return!1}function b(){return new h}function c(a,b){return b.has(a)}function d(a,b){return b["delete"](a);
}function e(a,b,c){b.set(a,c)}function f(a,b){return b.get(a)}function g(){}var h="function"==typeof WeakMap?WeakMap:void 0;return{
get isPrivateSymbol(){return a},get createPrivateSymbol(){return b},get hasPrivate(){return c},get deletePrivate(){return d},get setPrivate(){
return e},get getPrivate(){return f},get init(){return g}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/private.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./private-symbol.js","traceur-runtime@0.0.104/src/runtime/private.js")),b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./private-weak-map.js","traceur-runtime@0.0.104/src/runtime/private.js")),c="function"==typeof WeakMap,d=c?b:a,e=d.isPrivateSymbol,f=d.createPrivateSymbol,g=d.hasPrivate,h=d.deletePrivate,i=d.setPrivate,j=d.getPrivate;
return d.init(),{get isPrivateSymbol(){return e},get createPrivateSymbol(){return f},get hasPrivate(){return g},get deletePrivate(){
return h},get setPrivate(){return i},get getPrivate(){return j}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/properTailCalls.js",[],function(){
"use strict";function a(a,b,c){return[o,a,b,c]}function b(a){return a&&a[0]===o}function c(a,b,c){for(var d=[b],e=0;e<c.length;e++)d[e+1]=c[e];
var f=n(Function.prototype.bind,a,d);return f}function d(a,b){var d=new(c(a,null,b));return d}function e(a){return!!k(a,p)}function f(c,d,f){
var g=f[0];if(b(g))return g=n(c,d,g[3]);for(g=a(c,d,f);;){if(g=e(c)?n(c,g[2],[g]):n(c,g[2],g[3]),!b(g))return g;c=g[1]}}function g(){
var b;return b=e(this)?d(this,[a(null,null,arguments)]):d(this,arguments)}function h(){p=m(),Function.prototype.call=i(function(b){
var c=f(function(b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];var e=a(this,b,c);return e},this,arguments);return c;
}),Function.prototype.apply=i(function(b,c){var d=f(function(b,c){var d=a(this,b,c);return d},this,arguments);return d})}function i(a){
return null===p&&h(),l(a,p,!0),a}var j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/modules/properTailCalls.js")),k=j.getPrivate,l=j.setPrivate,m=j.createPrivateSymbol,n=Function.prototype.call.bind(Function.prototype.apply),o=Object.create(null),p=null;
return{get construct(){return g},get initTailRecursiveFunction(){return i},get call(){return f},get continuation(){return a}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/properTailCalls.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/properTailCalls.js","traceur-runtime@0.0.104/src/runtime/properTailCalls.js")),b=a.initTailRecursiveFunction,c=a.call,d=a.continuation,e=a.construct;
return $traceurRuntime.initTailRecursiveFunction=b,$traceurRuntime.call=c,$traceurRuntime.continuation=d,$traceurRuntime.construct=e,
{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/relativeRequire.js",[],function(){"use strict";function a(a,c){
function d(a){return"/"===a.slice(-1)}function e(a){return"/"===a[0]}function f(a){return"."===a[0]}return b=b||"undefined"!=typeof require&&require("path"),
d(c)||e(c)?void 0:f(c)?require(b.resolve(b.dirname(a),c)):require(c)}var b;return $traceurRuntime.require=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/checkObjectCoercible.js",[],function(){
"use strict";function a(a){if(null===a||void 0===a)throw new b("Value cannot be converted to an Object");return a}var b=TypeError,c=a;
return{get default(){return c}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/spread.js",[],function(){
"use strict";function a(){for(var a,c=[],d=0,e=0;e<arguments.length;e++){var f=b(arguments[e]);if("function"!=typeof f[Symbol.iterator])throw new TypeError("Cannot spread non-iterable object.");
for(var g=f[Symbol.iterator]();!(a=g.next()).done;)c[d++]=a.value}return c}var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../checkObjectCoercible.js","traceur-runtime@0.0.104/src/runtime/modules/spread.js"))["default"],c=a;
return{get default(){return c}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/spread.js",[],function(){"use strict";
var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/spread.js","traceur-runtime@0.0.104/src/runtime/spread.js"))["default"];
return $traceurRuntime.spread=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/iteratorToArray.js",[],function(){
"use strict";function a(a){for(var b,c=[],d=0;!(b=a.next()).done;)c[d++]=b.value;return c}var b=a;return{get default(){return b}};
}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/destructuring.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/iteratorToArray.js","traceur-runtime@0.0.104/src/runtime/destructuring.js"))["default"];
return $traceurRuntime.iteratorToArray=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/async.js",[],function(){
"use strict";function a(){}function b(){}function c(a){return a.prototype=m(b.prototype),a.__proto__=b,a}function d(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];
var e=m(b.prototype);return k(e,o,a),e}function e(a,b){return new Promise(function(c,d){var e=a({next:function(a){return b.call(e,a);
},"throw":function(a){d(a)},"return":function(a){c(a)}})})}function f(a){return Promise.resolve().then(a)}function g(a,b){return new s(a,b);
}var h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/modules/async.js")),i=h.createPrivateSymbol,j=h.getPrivate,k=h.setPrivate,l=Object,m=l.create,n=l.defineProperty,o=i();
a.prototype=b,b.constructor=a,n(b,"constructor",{enumerable:!1});var p=function(){function a(a){var b=this;this.decoratedObserver=g(a,function(){
b.done=!0}),this.done=!1,this.inReturn=!1}return $traceurRuntime.createClass(a,{"throw":function(a){if(!this.inReturn)throw a},"yield":function(a){
if(this.done)throw void(this.inReturn=!0);var b;try{b=this.decoratedObserver.next(a)}catch(c){throw this.done=!0,c}if(void 0!==b){
if(b.done)throw this.done=!0,void(this.inReturn=!0);return b.value}},yieldFor:function(a){var b=this;return e(a[Symbol.observer].bind(a),function(a){
if(b.done)return void this["return"]();var c;try{c=b.decoratedObserver.next(a)}catch(d){throw b.done=!0,d}if(void 0!==c)return c.done&&(b.done=!0),
c})}},{})}();b.prototype[Symbol.observer]=function(a){var b=j(this,o),c=new p(a);return f(function(){return b(c)}).then(function(a){
c.done||c.decoratedObserver["return"](a)})["catch"](function(a){c.done||c.decoratedObserver["throw"](a)}),c.decoratedObserver},n(b.prototype,Symbol.observer,{
enumerable:!1});var q=Symbol(),r=Symbol(),s=function(){function a(a,b){this[q]=a,this[r]=b}return $traceurRuntime.createClass(a,{
next:function(a){var b=this[q].next(a);return void 0!==b&&b.done&&this[r].call(this),b},"throw":function(a){return this[r].call(this),
this[q]["throw"](a)},"return":function(a){return this[r].call(this),this[q]["return"](a)}},{})}();return Array.prototype[Symbol.observer]=function(a){
var b=!1,c=g(a,function(){return b=!0}),d=!0,e=!1,f=void 0;try{for(var h=void 0,i=this[Symbol.iterator]();!(d=(h=i.next()).done);d=!0){
var j=h.value;if(c.next(j),b)return}}catch(k){e=!0,f=k}finally{try{d||null==i["return"]||i["return"]()}finally{if(e)throw f}}return c["return"](),
c},n(Array.prototype,Symbol.observer,{enumerable:!1}),{get initAsyncGeneratorFunction(){return c},get createAsyncGeneratorInstance(){
return d},get observeForEach(){return e},get schedule(){return f},get createDecoratedGenerator(){return g}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/initAsyncGeneratorFunction.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./async.js","traceur-runtime@0.0.104/src/runtime/modules/initAsyncGeneratorFunction.js"));
return{get default(){return a.initAsyncGeneratorFunction}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/createAsyncGeneratorInstance.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./async.js","traceur-runtime@0.0.104/src/runtime/modules/createAsyncGeneratorInstance.js"));
return{get default(){return a.createAsyncGeneratorInstance}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/observeForEach.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./async.js","traceur-runtime@0.0.104/src/runtime/modules/observeForEach.js"));
return{get default(){return a.observeForEach}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/schedule.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./async.js","traceur-runtime@0.0.104/src/runtime/modules/schedule.js"));
return{get default(){return a.schedule}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/createDecoratedGenerator.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./async.js","traceur-runtime@0.0.104/src/runtime/modules/createDecoratedGenerator.js"));
return{get default(){return a.createDecoratedGenerator}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/async.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/initAsyncGeneratorFunction.js","traceur-runtime@0.0.104/src/runtime/async.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/createAsyncGeneratorInstance.js","traceur-runtime@0.0.104/src/runtime/async.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/observeForEach.js","traceur-runtime@0.0.104/src/runtime/async.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/schedule.js","traceur-runtime@0.0.104/src/runtime/async.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/createDecoratedGenerator.js","traceur-runtime@0.0.104/src/runtime/async.js"))["default"];
return $traceurRuntime.initAsyncGeneratorFunction=a,$traceurRuntime.createAsyncGeneratorInstance=b,$traceurRuntime.observeForEach=c,
$traceurRuntime.schedule=d,$traceurRuntime.createDecoratedGenerator=e,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/generators.js",[],function(){
"use strict";function a(a){return{configurable:!0,enumerable:!1,value:a,writable:!0}}function b(a){return new Error("Traceur compiler bug: invalid state in state machine: "+a);
}function c(){this.state=0,this.GState=v,this.storedException=void 0,this.finallyFallThrough=void 0,this.sent_=void 0,this.returnValue=void 0,
this.oldReturnValue=void 0,this.tryStack_=[]}function d(a,b,c,d){switch(a.GState){case w:throw new Error('"'+c+'" on executing generator');
case y:if("next"==c)return{value:void 0,done:!0};if(d===B)return{value:a.returnValue,done:!0};throw d;case v:if("throw"===c){if(a.GState=y,
d===B)return{value:a.returnValue,done:!0};throw d}if(void 0!==d)throw q("Sent value to newborn generator");case x:a.GState=w,a.action=c,
a.sent=d;var e;try{e=b(a)}catch(f){if(f!==B)throw f;e=a}var g=e===a;return g&&(e=a.returnValue),a.GState=g?y:x,{value:e,done:g}}}
function e(){}function f(){}function g(a,b,d){var e=k(a,d),f=new c,g=s(b.prototype);return p(g,C,f),p(g,D,e),g}function h(a){return a.prototype=s(f.prototype),
a.__proto__=f,a}function i(){c.call(this),this.err=void 0;var a=this;a.result=new Promise(function(b,c){a.resolve=b,a.reject=c})}
function j(a,b){var c=k(a,b),d=new i;return d.createCallback=function(a){return function(b){d.state=a,d.value=b,c(d)}},d.errback=function(a){
l(d,a),c(d)},c(d),d.result}function k(a,b){return function(c){for(;;)try{return a.call(b,c)}catch(d){l(c,d)}}}function l(a,b){a.storedException=b;
var c=a.tryStack_[a.tryStack_.length-1];return c?(a.state=void 0!==c["catch"]?c["catch"]:c["finally"],void(void 0!==c.finallyFallThrough&&(a.finallyFallThrough=c.finallyFallThrough))):void a.handleException(b);
}var m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/modules/generators.js")),n=m.createPrivateSymbol,o=m.getPrivate,p=m.setPrivate,q=TypeError,r=Object,s=r.create,t=r.defineProperties,u=r.defineProperty,v=0,w=1,x=2,y=3,z=-2,A=-3,B={};
c.prototype={pushTry:function(a,b){if(null!==b){for(var c=null,d=this.tryStack_.length-1;d>=0;d--)if(void 0!==this.tryStack_[d]["catch"]){
c=this.tryStack_[d]["catch"];break}null===c&&(c=A),this.tryStack_.push({"finally":b,finallyFallThrough:c})}null!==a&&this.tryStack_.push({
"catch":a})},popTry:function(){this.tryStack_.pop()},maybeUncatchable:function(){if(this.storedException===B)throw B},get sent(){
return this.maybeThrow(),this.sent_},set sent(a){this.sent_=a},get sentIgnoreThrow(){return this.sent_},maybeThrow:function(){if("throw"===this.action)throw this.action="next",
this.sent_},end:function(){switch(this.state){case z:return this;case A:throw this.storedException;default:throw b(this.state)}},
handleException:function(a){throw this.GState=y,this.state=z,a},wrapYieldStar:function(a){var b=this;return{next:function(b){return a.next(b);
},"throw":function(c){var d;if(c===B){if(a["return"]){if(d=a["return"](b.returnValue),!d.done)return b.returnValue=b.oldReturnValue,
d;b.returnValue=d.value}throw c}if(a["throw"])return a["throw"](c);throw a["return"]&&a["return"](),q("Inner iterator does not have a throw method");
}}}};var C=n(),D=n();return e.prototype=f,u(f,"constructor",a(e)),f.prototype={constructor:f,next:function(a){return d(o(this,C),o(this,D),"next",a);
},"throw":function(a){return d(o(this,C),o(this,D),"throw",a)},"return":function(a){var b=o(this,C);return b.oldReturnValue=b.returnValue,
b.returnValue=a,d(b,o(this,D),"throw",B)}},t(f.prototype,{constructor:{enumerable:!1},next:{enumerable:!1},"throw":{enumerable:!1
},"return":{enumerable:!1}}),Object.defineProperty(f.prototype,Symbol.iterator,a(function(){return this})),i.prototype=s(c.prototype),
i.prototype.end=function(){switch(this.state){case z:this.resolve(this.returnValue);break;case A:this.reject(this.storedException);
break;default:this.reject(b(this.state))}},i.prototype.handleException=function(){this.state=A},{get createGeneratorInstance(){return g;
},get initGeneratorFunction(){return h},get asyncWrap(){return j}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/asyncWrap.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./generators.js","traceur-runtime@0.0.104/src/runtime/modules/asyncWrap.js"));
return{get default(){return a.asyncWrap}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/initGeneratorFunction.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./generators.js","traceur-runtime@0.0.104/src/runtime/modules/initGeneratorFunction.js"));
return{get default(){return a.initGeneratorFunction}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/createGeneratorInstance.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./generators.js","traceur-runtime@0.0.104/src/runtime/modules/createGeneratorInstance.js"));
return{get default(){return a.createGeneratorInstance}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/generators.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/asyncWrap.js","traceur-runtime@0.0.104/src/runtime/generators.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/initGeneratorFunction.js","traceur-runtime@0.0.104/src/runtime/generators.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/createGeneratorInstance.js","traceur-runtime@0.0.104/src/runtime/generators.js"))["default"];
return $traceurRuntime.asyncWrap=a,$traceurRuntime.initGeneratorFunction=b,$traceurRuntime.createGeneratorInstance=c,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/getTemplateObject.js",[],function(){
"use strict";function a(a){var b=arguments[1],g=a.join("${}"),h=f[g];return h?h:(b||(b=e.call(a)),f[g]=d(c(b,"raw",{value:d(a)})));
}var b=Object,c=b.defineProperty,d=b.freeze,e=Array.prototype.slice,f=Object.create(null),g=a;return{get default(){return g}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/template.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/getTemplateObject.js","traceur-runtime@0.0.104/src/runtime/template.js"))["default"];
return $traceurRuntime.getTemplateObject=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/assign.js",[],function(){
"use strict";function a(a){for(var c=1;c<arguments.length;c++){var d=arguments[c],e=null==d?[]:b(d),f=void 0,g=e.length;for(f=0;g>f;f++){
var h=e[f];a[h]=d[h]}}return a}var b=Object.keys,c=a;return{get default(){return c}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/modules/objectAssign.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../polyfills/assign.js","traceur-runtime@0.0.104/src/runtime/modules/objectAssign.js"));
return{get default(){return a["default"]}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/jsx.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./modules/objectAssign.js","traceur-runtime@0.0.104/src/runtime/jsx.js"))["default"];
return $traceurRuntime.objectAssign=a,{}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/runtime-modules.js",[],function(){
"use strict";return $traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./symbols.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./classes.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./exportStar.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./properTailCalls.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./relativeRequire.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./spread.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./destructuring.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./async.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./generators.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./template.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./jsx.js","traceur-runtime@0.0.104/src/runtime/runtime-modules.js")),
{}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/runtime-modules.js"),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/frozen-data.js",[],function(){
"use strict";function a(a,b){for(var c=0;c<a.length;c+=2)if(a[c]===b)return c;return-1}function b(b,c,d){var e=a(b,c);-1===e&&b.push(c,d);
}function c(b,c){var d=a(b,c);return-1!==d?b[d+1]:void 0}function d(b,c){return-1!==a(b,c)}function e(b,c){var d=a(b,c);return-1!==d?(b.splice(d,2),
!0):!1}return{get setFrozen(){return b},get getFrozen(){return c},get hasFrozen(){return d},get deleteFrozen(){return e}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/utils.js",[],function(){
"use strict";function a(a){if(null==a)throw y();return z(a)}function b(a){return a>>>0}function c(a){return a&&("object"==typeof a||"function"==typeof a);
}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return a=+a,v(a)?0:0!==a&&u(a)?a>0?t(a):s(a):a;
}function g(a){var b=f(a);return 0>b?0:x(b,A)}function h(a){return c(a)?a[Symbol.iterator]:void 0}function i(a){return d(a)}function j(a,b){
return{value:a,done:b}}function k(a,b,c){b in a||Object.defineProperty(a,b,c)}function l(a,b,c){k(a,b,{value:c,configurable:!0,enumerable:!1,
writable:!0})}function m(a,b,c){k(a,b,{value:c,configurable:!1,enumerable:!1,writable:!1})}function n(a,b){for(var c=0;c<b.length;c+=2){
var d=b[c],e=b[c+1];l(a,d,e)}}function o(a,b){for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];m(a,d,e)}}function p(a,b,c){c&&c.iterator&&!a[c.iterator]&&(a["@@iterator"]&&(b=a["@@iterator"]),
Object.defineProperty(a,c.iterator,{value:b,configurable:!0,enumerable:!1,writable:!0}))}function q(a){B.push(a)}function r(a){B.forEach(function(b){
return b(a)})}var s=Math.ceil,t=Math.floor,u=isFinite,v=isNaN,w=Math.pow,x=Math.min,y=TypeError,z=Object,A=w(2,53)-1,B=[];return{
get toObject(){return a},get toUint32(){return b},get isObject(){return c},get isCallable(){return d},get isNumber(){return e},get toInteger(){
return f},get toLength(){return g},get checkIterable(){return h},get isConstructor(){return i},get createIteratorResultObject(){return j;
},get maybeDefine(){return k},get maybeDefineMethod(){return l},get maybeDefineConst(){return m},get maybeAddFunctions(){return n;
},get maybeAddConsts(){return o},get maybeAddIterator(){return p},get registerPolyfill(){return q},get polyfillAll(){return r}}}),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Map.js",[],function(){"use strict";function a(a){return i(a,y);
}function b(b){var c=a(b);return c||(c=x++,j(b,y,c)),c}function c(b,c){if("string"==typeof c)return b.stringIndex_[c];if(p(c)){if(!v(c))return m(b.frozenData_,c);
var d=a(c);if(void 0===d)return;return b.objectIndex_[d]}return b.primitiveIndex_[c]}function d(a){a.entries_=[],a.objectIndex_=Object.create(null),
a.stringIndex_=Object.create(null),a.primitiveIndex_=Object.create(null),a.frozenData_=[],a.deletedCount_=0}function e(a){var b=a,c=b.Map,d=b.Symbol;
if(!(c&&r()&&c.prototype[d.iterator]&&c.prototype.entries))return!0;try{return 1!==new c([[]]).size}catch(e){return!1}}function f(a){
e(a)&&(a.Map=z)}var g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/polyfills/Map.js")),h=g.createPrivateSymbol,i=g.getPrivate,j=g.setPrivate,k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../frozen-data.js","traceur-runtime@0.0.104/src/runtime/polyfills/Map.js")),l=k.deleteFrozen,m=k.getFrozen,n=k.setFrozen,o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Map.js")),p=o.isObject,q=o.registerPolyfill,r=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../has-native-symbols.js","traceur-runtime@0.0.104/src/runtime/polyfills/Map.js"))["default"],s=Object,t=s.defineProperty,u=(s.getOwnPropertyDescriptor,
s.hasOwnProperty),v=s.isExtensible,w={},x=1,y=h(),z=function(){function e(){var a,b,c=arguments[0];if(!p(this))throw new TypeError("Map called on incompatible type");
if(u.call(this,"entries_"))throw new TypeError("Map can not be reentrantly initialised");if(d(this),null!==c&&void 0!==c){var e=!0,f=!1,g=void 0;
try{for(var h=void 0,i=c[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){var j=h.value,k=(a=j[Symbol.iterator](),(b=a.next()).done?void 0:b.value),l=(b=a.next()).done?void 0:b.value;
this.set(k,l)}}catch(m){f=!0,g=m}finally{try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}}}}return $traceurRuntime.createClass(e,{
get size(){return this.entries_.length/2-this.deletedCount_},get:function(a){var b=c(this,a);return void 0!==b?this.entries_[b+1]:void 0;
},set:function(a,d){var e=c(this,a);if(void 0!==e)this.entries_[e+1]=d;else if(e=this.entries_.length,this.entries_[e]=a,this.entries_[e+1]=d,
p(a))if(v(a)){var f=b(a);this.objectIndex_[f]=e}else n(this.frozenData_,a,e);else"string"==typeof a?this.stringIndex_[a]=e:this.primitiveIndex_[a]=e;
return this},has:function(a){return void 0!==c(this,a)},"delete":function(b){var d=c(this,b);if(void 0===d)return!1;if(this.entries_[d]=w,
this.entries_[d+1]=void 0,this.deletedCount_++,p(b))if(v(b)){var e=a(b);delete this.objectIndex_[e]}else l(this.frozenData_,b);else"string"==typeof b?delete this.stringIndex_[b]:delete this.primitiveIndex_[b];
return!0},clear:function(){d(this)},forEach:function(a){for(var b=arguments[1],c=0;c<this.entries_.length;c+=2){var d=this.entries_[c],e=this.entries_[c+1];
d!==w&&a.call(b,e,d,this)}},entries:$traceurRuntime.initGeneratorFunction(function f(){var a,b,c;return $traceurRuntime.createGeneratorInstance(function(d){
for(;;)switch(d.state){case 0:a=0,d.state=12;break;case 12:d.state=a<this.entries_.length?8:-2;break;case 4:a+=2,d.state=12;break;
case 8:b=this.entries_[a],c=this.entries_[a+1],d.state=9;break;case 9:d.state=b===w?4:6;break;case 6:return d.state=2,[b,c];case 2:
d.maybeThrow(),d.state=4;break;default:return d.end()}},f,this)}),keys:$traceurRuntime.initGeneratorFunction(function g(){var a,b,c;
return $traceurRuntime.createGeneratorInstance(function(d){for(;;)switch(d.state){case 0:a=0,d.state=12;break;case 12:d.state=a<this.entries_.length?8:-2;
break;case 4:a+=2,d.state=12;break;case 8:b=this.entries_[a],c=this.entries_[a+1],d.state=9;break;case 9:d.state=b===w?4:6;break;case 6:
return d.state=2,b;case 2:d.maybeThrow(),d.state=4;break;default:return d.end()}},g,this)}),values:$traceurRuntime.initGeneratorFunction(function h(){
var a,b,c;return $traceurRuntime.createGeneratorInstance(function(d){for(;;)switch(d.state){case 0:a=0,d.state=12;break;case 12:d.state=a<this.entries_.length?8:-2;
break;case 4:a+=2,d.state=12;break;case 8:b=this.entries_[a],c=this.entries_[a+1],d.state=9;break;case 9:d.state=b===w?4:6;break;case 6:
return d.state=2,c;case 2:d.maybeThrow(),d.state=4;break;default:return d.end()}},h,this)})},{})}();return t(z.prototype,Symbol.iterator,{
configurable:!0,writable:!0,value:z.prototype.entries}),q(f),{get Map(){return z},get polyfillMap(){return f}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Map.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Set.js",[],function(){"use strict";function a(a){var b=a,c=b.Set,d=b.Symbol;
if(!(c&&g()&&c.prototype[d.iterator]&&c.prototype.values))return!0;try{return 1!==new c([1]).size}catch(e){return!1}}function b(b){
a(b)&&(b.Set=i)}var c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Set.js")),d=c.isObject,e=c.registerPolyfill,f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./Map.js","traceur-runtime@0.0.104/src/runtime/polyfills/Set.js")).Map,g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../has-native-symbols.js","traceur-runtime@0.0.104/src/runtime/polyfills/Set.js"))["default"],h=Object.prototype.hasOwnProperty,i=function(){
function a(){var a=arguments[0];if(!d(this))throw new TypeError("Set called on incompatible type");if(h.call(this,"map_"))throw new TypeError("Set can not be reentrantly initialised");
if(this.map_=new f,null!==a&&void 0!==a){var b=!0,c=!1,e=void 0;try{for(var g=void 0,i=a[Symbol.iterator]();!(b=(g=i.next()).done);b=!0){
var j=g.value;this.add(j)}}catch(k){c=!0,e=k}finally{try{b||null==i["return"]||i["return"]()}finally{if(c)throw e}}}}return $traceurRuntime.createClass(a,{
get size(){return this.map_.size},has:function(a){return this.map_.has(a)},add:function(a){return this.map_.set(a,a),this},"delete":function(a){
return this.map_["delete"](a)},clear:function(){return this.map_.clear()},forEach:function(a){var b=arguments[1],c=this;return this.map_.forEach(function(d,e){
a.call(b,e,e,c)})},values:$traceurRuntime.initGeneratorFunction(function b(){var a,c;return $traceurRuntime.createGeneratorInstance(function(b){
for(;;)switch(b.state){case 0:a=b.wrapYieldStar(this.map_.keys()[Symbol.iterator]()),b.sent=void 0,b.action="next",b.state=12;break;
case 12:c=a[b.action](b.sentIgnoreThrow),b.state=9;break;case 9:b.state=c.done?3:2;break;case 3:b.sent=c.value,b.state=-2;break;case 2:
return b.state=12,c.value;default:return b.end()}},b,this)}),entries:$traceurRuntime.initGeneratorFunction(function c(){var a,b;return $traceurRuntime.createGeneratorInstance(function(c){
for(;;)switch(c.state){case 0:a=c.wrapYieldStar(this.map_.entries()[Symbol.iterator]()),c.sent=void 0,c.action="next",c.state=12;break;
case 12:b=a[c.action](c.sentIgnoreThrow),c.state=9;break;case 9:c.state=b.done?3:2;break;case 3:c.sent=b.value,c.state=-2;break;case 2:
return c.state=12,b.value;default:return c.end()}},c,this)})},{})}();return Object.defineProperty(i.prototype,Symbol.iterator,{configurable:!0,
writable:!0,value:i.prototype.values}),Object.defineProperty(i.prototype,"keys",{configurable:!0,writable:!0,value:i.prototype.values
}),e(b),{get Set(){return i},get polyfillSet(){return b}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Set.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/node_modules/rsvp/lib/rsvp/asap.js",[],function(){"use strict";function a(a,b){
r[k]=a,r[k+1]=b,k+=2,2===k&&j()}function b(){var a=process.nextTick,b=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);
return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(g)}}function c(){return function(){i(g)}}function d(){
var a=0,b=new o(g),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function e(){var a=new MessageChannel;
return a.port1.onmessage=g,function(){a.port2.postMessage(0)}}function f(){return function(){setTimeout(g,1)}}function g(){for(var a=0;k>a;a+=2){
var b=r[a],c=r[a+1];b(c),r[a]=void 0,r[a+1]=void 0}k=0}function h(){try{var a=require,b=a("vertx");return i=b.runOnLoop||b.runOnContext,
c()}catch(d){return f()}}var i,j,k=0,l=({}.toString,a),m="undefined"!=typeof window?window:void 0,n=m||{},o=n.MutationObserver||n.WebKitMutationObserver,p="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),q="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,r=new Array(1e3);
return j=p?b():o?d():q?e():void 0===m&&"function"==typeof require?h():f(),{get default(){return l}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Promise.js",[],function(){
"use strict";function a(a){return a&&"object"==typeof a&&void 0!==a.status_}function b(a){return a}function c(a){throw a}function d(a){
var d=void 0!==arguments[1]?arguments[1]:b,f=void 0!==arguments[2]?arguments[2]:c,g=e(a.constructor);switch(a.status_){case void 0:
throw TypeError;case 0:a.onResolve_.push(d,g),a.onReject_.push(f,g);break;case 1:k(a.value_,[d,g]);break;case-1:k(a.value_,[f,g]);
}return g.promise}function e(a){if(this===y){var b=g(new y(w));return{promise:b,resolve:function(a){h(b,a)},reject:function(a){i(b,a);
}}}var c={};return c.promise=new a(function(a,b){c.resolve=a,c.reject=b}),c}function f(a,b,c,d,e){return a.status_=b,a.value_=c,a.onResolve_=d,
a.onReject_=e,a}function g(a){return f(a,0,void 0,[],[])}function h(a,b){j(a,1,b,a.onResolve_)}function i(a,b){j(a,-1,b,a.onReject_);
}function j(a,b,c,d){0===a.status_&&(k(c,d),f(a,b,c))}function k(a,b){o(function(){for(var c=0;c<b.length;c+=2)l(a,b[c],b[c+1])});
}function l(b,c,e){try{var f=c(b);if(f===e.promise)throw new TypeError;a(f)?d(f,e.resolve,e.reject):e.resolve(f)}catch(g){try{e.reject(g);
}catch(g){}}}function m(b,c){if(!a(c)&&q(c)){var d;try{d=c.then}catch(f){var g=z.call(b,f);return v(c,A,g),g}if("function"==typeof d){
var h=u(c,A);if(h)return h;var i=e(b);v(c,A,i.promise);try{d.call(c,i.resolve,i.reject)}catch(f){i.reject(f)}return i.promise}}return c;
}function n(a){a.Promise||(a.Promise=x)}var o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../../../node_modules/rsvp/lib/rsvp/asap.js","traceur-runtime@0.0.104/src/runtime/polyfills/Promise.js"))["default"],p=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Promise.js")),q=p.isObject,r=p.registerPolyfill,s=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/polyfills/Promise.js")),t=s.createPrivateSymbol,u=s.getPrivate,v=s.setPrivate,w={},x=function(){
function j(a){if(a!==w){if("function"!=typeof a)throw new TypeError;var b=g(this);try{a(function(a){h(b,a)},function(a){i(b,a)})}catch(c){
i(b,c)}}}return $traceurRuntime.createClass(j,{"catch":function(a){return this.then(void 0,a)},then:function(e,f){"function"!=typeof e&&(e=b),
"function"!=typeof f&&(f=c);var g=this,h=this.constructor;return d(this,function(b){return b=m(h,b),b===g?f(new TypeError):a(b)?b.then(e,f):e(b);
},f)}},{resolve:function(b){return this===y?a(b)?b:f(new y(w),1,b):new this(function(a,c){a(b)})},reject:function(a){return this===y?f(new y(w),-1,a):new this(function(b,c){
c(a)})},all:function(a){var b=e(this),c=[];try{var d=function(a){return function(d){c[a]=d,0===--f&&b.resolve(c)}},f=0,g=0,h=!0,i=!1,j=void 0;
try{for(var k=void 0,l=a[Symbol.iterator]();!(h=(k=l.next()).done);h=!0){var m=k.value,n=d(g);this.resolve(m).then(n,function(a){
b.reject(a)}),++g,++f}}catch(o){i=!0,j=o}finally{try{h||null==l["return"]||l["return"]()}finally{if(i)throw j}}0===f&&b.resolve(c);
}catch(p){b.reject(p)}return b.promise},race:function(a){var b=e(this);try{for(var c=0;c<a.length;c++)this.resolve(a[c]).then(function(a){
b.resolve(a)},function(a){b.reject(a)})}catch(d){b.reject(d)}return b.promise}})}(),y=x,z=y.reject,A=t();return r(n),{get Promise(){
return x},get polyfillPromise(){return n}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Promise.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/StringIterator.js",[],function(){"use strict";function a(a){
var b=String(a),c=Object.create(h.prototype);return c[f]=b,c[g]=0,c}var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/StringIterator.js")),c=b.createIteratorResultObject,d=b.isObject,e=Object.prototype.hasOwnProperty,f=Symbol("iteratedString"),g=Symbol("stringIteratorNextIndex"),h=function(){
function a(){}var b;return $traceurRuntime.createClass(a,(b={},Object.defineProperty(b,"next",{value:function(){var a=this;if(!d(a)||!e.call(a,f))throw new TypeError("this must be a StringIterator object");
var b=a[f];if(void 0===b)return c(void 0,!0);var h=a[g],i=b.length;if(h>=i)return a[f]=void 0,c(void 0,!0);var j,k=b.charCodeAt(h);
if(55296>k||k>56319||h+1===i)j=String.fromCharCode(k);else{var l=b.charCodeAt(h+1);j=56320>l||l>57343?String.fromCharCode(k):String.fromCharCode(k)+String.fromCharCode(l);
}return a[g]=h+j.length,c(j,!1)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,Symbol.iterator,{value:function(){
return this},configurable:!0,enumerable:!0,writable:!0}),b),{})}();return{get createStringIterator(){return a}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/String.js",[],function(){
"use strict";function a(a){var b=String(this);if(null==this||"[object RegExp]"==p.call(a))throw TypeError();var c=b.length,d=String(a),e=(d.length,
arguments.length>1?arguments[1]:void 0),f=e?Number(e):0;isNaN(f)&&(f=0);var g=Math.min(Math.max(f,0),c);return q.call(b,d,f)==g}function b(a){
var b=String(this);if(null==this||"[object RegExp]"==p.call(a))throw TypeError();var c=b.length,d=String(a),e=d.length,f=c;if(arguments.length>1){
var g=arguments[1];void 0!==g&&(f=g?Number(g):0,isNaN(f)&&(f=0))}var h=Math.min(Math.max(f,0),c),i=h-e;return 0>i?!1:r.call(b,d,i)==i;
}function c(a){if(null==this)throw TypeError();var b=String(this);if(a&&"[object RegExp]"==p.call(a))throw TypeError();var c=b.length,d=String(a),e=d.length,f=arguments.length>1?arguments[1]:void 0,g=f?Number(f):0;
g!=g&&(g=0);var h=Math.min(Math.max(g,0),c);return e+h>c?!1:-1!=q.call(b,d,g)}function d(a){if(null==this)throw TypeError();var b=String(this),c=a?Number(a):0;
if(isNaN(c)&&(c=0),0>c||c==1/0)throw RangeError();if(0==c)return"";for(var d="";c--;)d+=b;return d}function e(a){if(null==this)throw TypeError();
var b=String(this),c=b.length,d=a?Number(a):0;if(isNaN(d)&&(d=0),!(0>d||d>=c)){var e,f=b.charCodeAt(d);return f>=55296&&56319>=f&&c>d+1&&(e=b.charCodeAt(d+1),
e>=56320&&57343>=e)?1024*(f-55296)+e-56320+65536:f}}function f(a){var b=a.raw,c=b.length>>>0;if(0===c)return"";for(var d="",e=0;;){
if(d+=b[e],e+1===c)return d;d+=arguments[++e]}}function g(a){var b,c,d=[],e=Math.floor,f=-1,g=arguments.length;if(!g)return"";for(;++f<g;){
var h=Number(arguments[f]);if(!isFinite(h)||0>h||h>1114111||e(h)!=h)throw RangeError("Invalid code point: "+h);65535>=h?d.push(h):(h-=65536,
b=(h>>10)+55296,c=h%1024+56320,d.push(b,c))}return String.fromCharCode.apply(null,d)}function h(){var a=j(this),b=String(a);return k(b);
}function i(i){var j=i.String;m(j.prototype,["codePointAt",e,"endsWith",b,"includes",c,"repeat",d,"startsWith",a]),m(j,["fromCodePoint",g,"raw",f]),
n(j.prototype,h,Symbol)}var j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../checkObjectCoercible.js","traceur-runtime@0.0.104/src/runtime/polyfills/String.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./StringIterator.js","traceur-runtime@0.0.104/src/runtime/polyfills/String.js")).createStringIterator,l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/String.js")),m=l.maybeAddFunctions,n=l.maybeAddIterator,o=l.registerPolyfill,p=Object.prototype.toString,q=String.prototype.indexOf,r=String.prototype.lastIndexOf;
return o(i),{get startsWith(){return a},get endsWith(){return b},get includes(){return c},get repeat(){return d},get codePointAt(){
return e},get raw(){return f},get fromCodePoint(){return g},get stringPrototypeIterator(){return h},get polyfillString(){return i;
}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/String.js"),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/ArrayIterator.js",[],function(){
"use strict";function a(a,b){var c=f(a),d=new l;return d.iteratorObject_=c,d.arrayIteratorNextIndex_=0,d.arrayIterationKind_=b,d}
function b(){return a(this,k)}function c(){return a(this,i)}function d(){return a(this,j)}var e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/ArrayIterator.js")),f=e.toObject,g=e.toUint32,h=e.createIteratorResultObject,i=1,j=2,k=3,l=function(){
function a(){}var b;return $traceurRuntime.createClass(a,(b={},Object.defineProperty(b,"next",{value:function(){var a=f(this),b=a.iteratorObject_;
if(!b)throw new TypeError("Object is not an ArrayIterator");var c=a.arrayIteratorNextIndex_,d=a.arrayIterationKind_,e=g(b.length);
return c>=e?(a.arrayIteratorNextIndex_=1/0,h(void 0,!0)):(a.arrayIteratorNextIndex_=c+1,d==j?h(b[c],!1):d==k?h([c,b[c]],!1):h(c,!1));
},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,Symbol.iterator,{value:function(){return this},configurable:!0,
enumerable:!0,writable:!0}),b),{})}();return{get entries(){return b},get keys(){return c},get values(){return d}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Array.js",[],function(){
"use strict";function a(a){var b,c,d=arguments[1],e=arguments[2],f=this,g=u(a),h=void 0!==d,i=0;if(h&&!n(d))throw TypeError();if(m(g)){
b=o(f)?new f:[];var j=!0,k=!1,l=void 0;try{for(var p=void 0,q=g[Symbol.iterator]();!(j=(p=q.next()).done);j=!0){var r=p.value;h?b[i]=d.call(e,r,i):b[i]=r,
i++}}catch(s){k=!0,l=s}finally{try{j||null==q["return"]||q["return"]()}finally{if(k)throw l}}return b.length=i,b}for(c=t(g.length),
b=o(f)?new f(c):new Array(c);c>i;i++)h?b[i]="undefined"==typeof e?d(g[i],i):d.call(e,g[i],i):b[i]=g[i];return b.length=c,b}function b(){
for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];for(var c=this,d=a.length,e=o(c)?new c(d):new Array(d),f=0;d>f;f++)e[f]=a[f];
return e.length=d,e}function c(a){var b=void 0!==arguments[1]?arguments[1]:0,c=arguments[2],d=u(this),e=t(d.length),f=s(b),g=void 0!==c?s(c):e;
for(f=0>f?Math.max(e+f,0):Math.min(f,e),g=0>g?Math.max(e+g,0):Math.min(g,e);g>f;)d[f]=a,f++;return d}function d(a){var b=arguments[1];
return f(this,a,b)}function e(a){var b=arguments[1];return f(this,a,b,!0)}function f(a,b){var c=arguments[2],d=void 0!==arguments[3]?arguments[3]:!1,e=u(a),f=t(e.length);
if(!n(b))throw TypeError();for(var g=0;f>g;g++){var h=e[g];if(b.call(c,h,g,e))return d?g:h}return d?-1:void 0}function g(f){var g=f,h=g.Array,l=g.Object,m=g.Symbol,n=k;
m&&m.iterator&&h.prototype[m.iterator]&&(n=h.prototype[m.iterator]),p(h.prototype,["entries",i,"keys",j,"values",n,"fill",c,"find",d,"findIndex",e]),
p(h,["from",a,"of",b]),q(h.prototype,n,m),q(l.getPrototypeOf([].values()),function(){return this},m)}var h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./ArrayIterator.js","traceur-runtime@0.0.104/src/runtime/polyfills/Array.js")),i=h.entries,j=h.keys,k=h.values,l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Array.js")),m=l.checkIterable,n=l.isCallable,o=l.isConstructor,p=l.maybeAddFunctions,q=l.maybeAddIterator,r=l.registerPolyfill,s=l.toInteger,t=l.toLength,u=l.toObject;
return r(g),{get from(){return a},get of(){return b},get fill(){return c},get find(){return d},get findIndex(){return e},get polyfillArray(){
return g}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Array.js"),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Object.js",[],function(){
"use strict";function a(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}function b(a,b){var c,d,e=k(b),f=e.length;for(c=0;f>c;c++){
e[c];d=j(b,e[c]),i(a,e[c],d)}return a}function c(c){var d=c.Object;e(d,["assign",g,"is",a,"mixin",b])}var d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Object.js")),e=d.maybeAddFunctions,f=d.registerPolyfill,g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./assign.js","traceur-runtime@0.0.104/src/runtime/polyfills/Object.js"))["default"],h=Object,i=h.defineProperty,j=h.getOwnPropertyDescriptor,k=h.getOwnPropertyNames;
return f(c),{get assign(){return g},get is(){return a},get mixin(){return b},get polyfillObject(){return c}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Object.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Number.js",[],function(){"use strict";function a(a){
return g(a)&&m(a)}function b(b){return a(b)&&k(b)===b}function c(a){return g(a)&&n(a)}function d(b){if(a(b)){var c=k(b);if(c===b)return l(c)<=o;
}return!1}function e(e){var f=e.Number;h(f,["MAX_SAFE_INTEGER",o,"MIN_SAFE_INTEGER",p,"EPSILON",q]),i(f,["isFinite",a,"isInteger",b,"isNaN",c,"isSafeInteger",d]);
}var f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Number.js")),g=f.isNumber,h=f.maybeAddConsts,i=f.maybeAddFunctions,j=f.registerPolyfill,k=f.toInteger,l=Math.abs,m=isFinite,n=isNaN,o=Math.pow(2,53)-1,p=-Math.pow(2,53)+1,q=Math.pow(2,-52);
return j(e),{get MAX_SAFE_INTEGER(){return o},get MIN_SAFE_INTEGER(){return p},get EPSILON(){return q},get isFinite(){return a},get isInteger(){
return b},get isNaN(){return c},get isSafeInteger(){return d},get polyfillNumber(){return e}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Number.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/fround.js",[],function(){"use strict";function a(a,b,c){
function d(a){var b=k(a),c=a-b;return.5>c?b:c>.5?b+1:b%2?b+1:b}var e,f,g,h,o,p,q,r=(1<<b-1)-1;for(a!==a?(f=(1<<b)-1,g=n(2,c-1),e=0):a===1/0||a===-(1/0)?(f=(1<<b)-1,
g=0,e=0>a?1:0):0===a?(f=0,g=0,e=1/a===-(1/0)?1:0):(e=0>a,a=j(a),a>=n(2,1-r)?(f=m(k(l(a)/i),1023),g=d(a/n(2,f)*n(2,c)),g/n(2,c)>=2&&(f+=1,
g=1),f>r?(f=(1<<b)-1,g=0):(f+=r,g-=n(2,c))):(f=0,g=d(a/n(2,1-r-c)))),o=[],h=c;h;h-=1)o.push(g%2?1:0),g=k(g/2);for(h=b;h;h-=1)o.push(f%2?1:0),
f=k(f/2);for(o.push(e?1:0),o.reverse(),p=o.join(""),q=[];p.length;)q.push(parseInt(p.substring(0,8),2)),p=p.substring(8);return q;
}function b(a,b,c){var d,e,f,g,h,i,j,k,l=[];for(d=a.length;d;d-=1)for(f=a[d-1],e=8;e;e-=1)l.push(f%2?1:0),f>>=1;return l.reverse(),
g=l.join(""),h=(1<<b-1)-1,i=parseInt(g.substring(0,1),2)?-1:1,j=parseInt(g.substring(1,1+b),2),k=parseInt(g.substring(1+b),2),j===(1<<b)-1?0!==k?NaN:i*(1/0):j>0?i*n(2,j-h)*(1+k/n(2,c)):0!==k?i*n(2,-(h-1))*(k/n(2,c)):0>i?-0:0;
}function c(a){return b(a,8,23)}function d(b){return a(b,8,23)}function e(a){return 0===a||!f(a)||g(a)?a:c(d(Number(a)))}var f=isFinite,g=isNaN,h=Math,i=h.LN2,j=h.abs,k=h.floor,l=h.log,m=h.min,n=h.pow;
return{get fround(){return e}}}),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/Math.js",[],function(){
"use strict";function a(a){if(a=x(+a),0==a)return 32;var b=0;return 0===(4294901760&a)&&(a<<=16,b+=16),0===(4278190080&a)&&(a<<=8,
b+=8),0===(4026531840&a)&&(a<<=4,b+=4),0===(3221225472&a)&&(a<<=2,b+=2),0===(2147483648&a)&&(a<<=1,b+=1),b}function b(a,b){a=x(+a),
b=x(+b);var c=a>>>16&65535,d=65535&a,e=b>>>16&65535,f=65535&b;return d*f+(c*f+d*e<<16>>>0)|0}function c(a){return a=+a,a>0?1:0>a?-1:a;
}function d(a){return.4342944819032518*F(a)}function e(a){return 1.4426950408889634*F(a)}function f(a){if(a=+a,-1>a||z(a))return NaN;
if(0===a||a===1/0)return a;if(-1===a)return-(1/0);var b=0,c=50;if(0>a||a>1)return F(1+a);for(var d=1;c>d;d++)d%2===0?b-=G(a,d)/d:b+=G(a,d)/d;
return b}function g(a){return a=+a,a===-(1/0)?-1:y(a)&&0!==a?D(a)-1:a}function h(a){return a=+a,0===a?1:z(a)?NaN:y(a)?(0>a&&(a=-a),
a>21?D(a)/2:(D(a)+D(-a))/2):1/0}function i(a){return a=+a,y(a)&&0!==a?(D(a)-D(-a))/2:a}function j(a){if(a=+a,0===a)return a;if(!y(a))return c(a);
var b=D(a),d=D(-a);return(b-d)/(b+d)}function k(a){return a=+a,1>a?NaN:y(a)?F(a+H(a+1)*H(a-1)):a}function l(a){return a=+a,0!==a&&y(a)?a>0?F(a+H(a*a+1)):-F(-a+H(a*a+1)):a;
}function m(a){return a=+a,-1===a?-(1/0):1===a?1/0:0===a?a:z(a)||-1>a||a>1?NaN:.5*F((1+a)/(1-a))}function n(a,b){for(var c=arguments.length,d=new Array(c),e=0,f=0;c>f;f++){
var g=arguments[f];if(g=+g,g===1/0||g===-(1/0))return 1/0;g=B(g),g>e&&(e=g),d[f]=g}0===e&&(e=1);for(var h=0,i=0,f=0;c>f;f++){var g=d[f]/e,j=g*g-i,k=h+j;
i=k-h-j,h=k}return H(h)*e}function o(a){return a=+a,a>0?E(a):0>a?C(a):a}function p(a){if(a=+a,0===a)return a;var b=0>a;b&&(a=-a);var c=G(a,1/3);
return b?-c:c}function q(q){var s=q.Math;v(s,["acosh",k,"asinh",l,"atanh",m,"cbrt",p,"clz32",a,"cosh",h,"expm1",g,"fround",r,"hypot",n,"imul",b,"log10",d,"log1p",f,"log2",e,"sign",c,"sinh",i,"tanh",j,"trunc",o]);
}var r,s,t=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./fround.js","traceur-runtime@0.0.104/src/runtime/polyfills/Math.js")).fround,u=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/Math.js")),v=u.maybeAddFunctions,w=u.registerPolyfill,x=u.toUint32,y=isFinite,z=isNaN,A=Math,B=A.abs,C=A.ceil,D=A.exp,E=A.floor,F=A.log,G=A.pow,H=A.sqrt;
return"function"==typeof Float32Array?(s=new Float32Array(1),r=function(a){return s[0]=Number(a),s[0]}):r=t,w(q),{get clz32(){return a;
},get imul(){return b},get sign(){return c},get log10(){return d},get log2(){return e},get log1p(){return f},get expm1(){return g;
},get cosh(){return h},get sinh(){return i},get tanh(){return j},get acosh(){return k},get asinh(){return l},get atanh(){return m;
},get hypot(){return n},get trunc(){return o},get fround(){return r},get cbrt(){return p},get polyfillMath(){return q}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/Math.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/WeakMap.js",[],function(){"use strict";function a(a){
var b=a,c=b.WeakMap;b.Symbol;if(!c||!q())return!0;try{var d={},e=new c([[d,!1]]);return e.get(d)}catch(f){return!1}}function b(b){
a(b)&&(b.WeakMap=u)}var c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakMap.js")),d=c.createPrivateSymbol,e=c.deletePrivate,f=c.getPrivate,g=c.hasPrivate,h=c.setPrivate,i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../frozen-data.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakMap.js")),j=i.deleteFrozen,k=i.getFrozen,l=i.hasFrozen,m=i.setFrozen,n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakMap.js")),o=n.isObject,p=n.registerPolyfill,q=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../has-native-symbols.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakMap.js"))["default"],r=Object,s=(r.defineProperty,
r.getOwnPropertyDescriptor,r.isExtensible),t=TypeError,u=(Object.prototype.hasOwnProperty,function(){function a(){this.name_=d(),
this.frozenData_=[]}return $traceurRuntime.createClass(a,{set:function(a,b){if(!o(a))throw new t("key must be an object");return s(a)?h(a,this.name_,b):m(this.frozenData_,a,b),
this},get:function(a){return o(a)?s(a)?f(a,this.name_):k(this.frozenData_,a):void 0},"delete":function(a){return o(a)?s(a)?e(a,this.name_):j(this.frozenData_,a):!1;
},has:function(a){return o(a)?s(a)?g(a,this.name_):l(this.frozenData_,a):!1}},{})}());return p(b),{get WeakMap(){return u},get polyfillWeakMap(){
return b}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/WeakMap.js"),$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/WeakSet.js",[],function(){
"use strict";function a(a){var b=a,c=b.WeakSet;b.Symbol;if(!c||!o())return!0;try{var d={},e=new c([[d]]);return!e.has(d)}catch(f){
return!1}}function b(b){a(b)&&(b.WeakSet=s)}var c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../private.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakSet.js")),d=c.createPrivateSymbol,e=c.deletePrivate,f=(c.getPrivate,
c.hasPrivate),g=c.setPrivate,h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../frozen-data.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakSet.js")),i=h.deleteFrozen,j=h.getFrozen,k=h.setFrozen,l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakSet.js")),m=l.isObject,n=l.registerPolyfill,o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("../has-native-symbols.js","traceur-runtime@0.0.104/src/runtime/polyfills/WeakSet.js"))["default"],p=Object,q=(p.defineProperty,
p.isExtensible),r=TypeError,s=(Object.prototype.hasOwnProperty,function(){function a(){this.name_=d(),this.frozenData_=[]}return $traceurRuntime.createClass(a,{
add:function(a){if(!m(a))throw new r("value must be an object");return q(a)?g(a,this.name_,!0):k(this.frozenData_,a,a),this},"delete":function(a){
return m(a)?q(a)?e(a,this.name_):i(this.frozenData_,a):!1},has:function(a){return m(a)?q(a)?f(a,this.name_):j(this.frozenData_,a)===a:!1;
}},{})}());return n(b),{get WeakSet(){return s},get polyfillWeakSet(){return b}}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/WeakSet.js"),
$traceurRuntime.registerModule("traceur-runtime@0.0.104/src/runtime/polyfills/polyfills.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("./utils.js","traceur-runtime@0.0.104/src/runtime/polyfills/polyfills.js")).polyfillAll;
a(Reflect.global);var b=$traceurRuntime.setupGlobals;return $traceurRuntime.setupGlobals=function(c){b(c),a(c)},{}}),$traceurRuntime.getModule("traceur-runtime@0.0.104/src/runtime/polyfills/polyfills.js"),
$traceurRuntime.registerModule("src/base/CooldownThrottle.js",[],function(){"use strict";var a=function(){function a(a,b){this.action=a,
this.cooldownDuration=b,this._state="idle",this._lastCompletionTime=-(1/0)}return $traceurRuntime.createClass(a,{trigger:function(){
switch(this._state){case"idle":var a=this.cooldownDuration-(performance.now()-this._lastCompletionTime);if(a>0)this._state="waiting",
this._forceIdleTriggerAfter(a);else{this._state="running";try{this.action()}finally{this._lastCompletionTime=performance.now(),"running-and-triggered"===this._state?(this._state="waiting",
this._forceIdleTriggerAfter(this.cooldownDuration)):this._state="idle"}}break;case"waiting":break;case"running":this._state="running-and-triggered";
break;case"running-and-triggered":break;default:throw new Error("Unrecognized throttle state: "+this._state)}},_forceIdleTriggerAfter:function(a){
var b=this;setTimeout(function(){b._state="idle",b._lastCompletionTime=-(1/0),b.trigger()},a)}},{})}(),b=a;return{get default(){return b;
}}}),$traceurRuntime.registerModule("src/base/Describe.js",[],function(){"use strict";function a(a){var f=void 0!==arguments[1]?arguments[1]:i;
if(null===a)return"null";if(void 0===a)return"undefined";if("string"==typeof a)return'"'+a+'"';if("number"==typeof a)return""+a;if(0===f)return h;
if(a instanceof Map)return b(a,f);if(a instanceof Set)return c(a,f);if(void 0!==a[Symbol.iterator])return d(a,f);var j=String(a);return j!==g?j:e(a,f);
}function b(b,c){var d,e,g=[],h=!0,i=!1,j=void 0;try{for(var k=void 0,l=b.entries()[Symbol.iterator]();!(h=(k=l.next()).done);h=!0){
var m=k.value,n=(d=m[Symbol.iterator](),(e=d.next()).done?void 0:e.value),o=(e=d.next()).done?void 0:e.value;if(g.length>f){g.push("[...]");
break}var p=a(n,c-1),q=a(o,c-1);g.push(p+": "+q)}}catch(r){i=!0,j=r}finally{try{h||null==l["return"]||l["return"]()}finally{if(i)throw j;
}}return"Map{"+g.join(", ")+"}"}function c(b,c){var d=[],e=!0,g=!1,h=void 0;try{for(var i=void 0,j=b[Symbol.iterator]();!(e=(i=j.next()).done);e=!0){
var k=i.value;if(d.length>f){d.push("[...]");break}d.push(a(k,c-1))}}catch(l){g=!0,h=l}finally{try{e||null==j["return"]||j["return"]();
}finally{if(g)throw h}}return"Set{"+d.join(", ")+"}"}function d(b,c){var d=[],e=!0,g=!1,h=void 0;try{for(var i=void 0,j=b[Symbol.iterator]();!(e=(i=j.next()).done);e=!0){
var k=i.value;if(d.length>f){d.push("[...]");break}d.push(a(k,c-1))}}catch(l){g=!0,h=l}finally{try{e||null==j["return"]||j["return"]();
}finally{if(g)throw h}}var m=Array.isArray(b)?"":b.constructor.name;return m+"["+d.join(", ")+"]"}function e(b,c){var d=[];for(var e in b)if(b.hasOwnProperty(e)){
if(d.length>f){d.push("[...]");break}var g=b[e],h=a(e,c-1),i=a(g,c-1);d.push(h+": "+i)}var j=b.constructor.name,k=j==={}.constructor.name?"":"(Type: "+j+")";
return k+"{"+d.join(", ")+"}"}var f=1e3,g=(new function(){}).toString(),h="!recursion-limit!",i=10,j=a;return{get default(){return j;
}}}),$traceurRuntime.registerModule("src/base/DetailedError.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Describe.js","src/base/DetailedError.js"))["default"],b=0,c=function(c){
function d(c,e){$traceurRuntime.superConstructor(d).call(this,c),this.detailsObj=e,this.name="Error",this.message=c,this.stack=(new Error).stack,
void 0!==this.stack&&(this.stack=this.stack.replace(/^Error\n\s+at new DetailedError (\S+)\s?\n\s+at /,"\n    ")),b++;try{this.details=1===b?a(e):"(failed to describe detailsObj due to possibly re-entrancy)";
}catch(f){console.error(f),this.details="(failed to describe detailsObj, see the console for details)"}finally{b--}}return $traceurRuntime.createClass(d,{
toString:function(){return $traceurRuntime.superGet(this,d.prototype,"toString").call(this)+"\nDetails: "+this.details}},{},c)}(Error),d=c;
return{get default(){return d}}}),$traceurRuntime.registerModule("src/base/Equate.js",[],function(){"use strict";function a(a,h){
if(a===h||b(a)&&b(h))return!0;var k=c(a,h);return void 0!==k?k:d(a)||d(h)||!f(a,h)?!1:a instanceof Map?i(a,h):a instanceof Set?j(a,h):e(a)?g(a,h):l(a,h);
}function b(a){return"number"==typeof a&&isNaN(a)}function c(a,b){return!d(a)&&a.constructor.prototype.hasOwnProperty("isEqualTo")?a.isEqualTo(b):!d(b)&&b.constructor.prototype.hasOwnProperty("isEqualTo")?b.isEqualTo(a):void 0;
}function d(a){return null===a||void 0===a||"string"==typeof a||"number"==typeof a||"boolean"==typeof a}function e(a){return Array.isArray(a)||!n.every(function(b){
return!(a instanceof b)})}function f(a,b){return a.constructor.name===b.constructor.name}function g(b,c){if(b.length!==c.length)return!1;
for(var d=0;d<b.length;d++)if(!a(b[d],c[d]))return!1;return!0}function h(b,c){var d=c[Symbol.iterator](),e=!0,f=!1,g=void 0;try{for(var h=void 0,i=b[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){
var j=h.value,k=d.next();if(k.done||!a(j,k.value))return!1}}catch(l){f=!0,g=l}finally{try{e||null==i["return"]||i["return"]()}finally{
if(f)throw g}}return d.next().done}function i(b,c){var d,e;if(b.size!==c.size)return!1;var f=!0,g=!1,h=void 0;try{for(var i=void 0,j=b[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){
var k=i.value,l=(d=k[Symbol.iterator](),(e=d.next()).done?void 0:e.value),m=(e=d.next()).done?void 0:e.value;if(!c.has(l))return!1;
var n=c.get(l);if(!a(m,n))return!1}}catch(o){g=!0,h=o}finally{try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}}return!0;
}function j(a,b){if(a.size!==b.size)return!1;var c=!0,d=!1,e=void 0;try{for(var f=void 0,g=a[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){
var h=f.value;if(!b.has(h))return!1}}catch(i){d=!0,e=i}finally{try{c||null==g["return"]||g["return"]()}finally{if(d)throw e}}return!0;
}function k(a){var b=new Set;for(var c in a)a.hasOwnProperty(c)&&b.add(c);return b}function l(b,c){var d=k(b);if(!j(d,k(c)))return!1;
var e=!0,f=!1,g=void 0;try{for(var i=void 0,l=d[Symbol.iterator]();!(e=(i=l.next()).done);e=!0){var m=i.value;if(m!==Symbol.iterator&&!a(b[m],c[m]))return!1;
}}catch(n){f=!0,g=n}finally{try{e||null==l["return"]||l["return"]()}finally{if(f)throw g}}var o=void 0!==b[Symbol.iterator],p=void 0!==c[Symbol.iterator];
return o!==p?!1:!o||!p||h(b,c)}var m=a,n=[Float32Array,Float64Array,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Uint8ClampedArray];
return{get default(){return m}}}),$traceurRuntime.registerModule("src/base/Format.js",[],function(){"use strict";function a(b){var c=void 0!==arguments[1]?arguments[1]:0,f=arguments[2];
if(Math.abs(b)<c)return"0";if(0>b)return"-"+a(-b,c,f);var g=e(d,function(a){return Math.abs(a.value-b)<=c});if(void 0!==g)return g.character;
var h=e(d,function(a){return Math.abs(Math.sqrt(a.value)-b)<=c});return void 0!==h?"√"+h.character:b%1!==0&&void 0!==f?b.toFixed(f):b.toString();
}var b=function(){function b(a,b,c,d){this.allowAbbreviation=a,this.maxAbbreviationError=b,this.fixedDigits=c,this.itemSeparator=d;
}return $traceurRuntime.createClass(b,{formatFloat:function(b){return this.allowAbbreviation?a(b,this.maxAbbreviationError,this.fixedDigits):void 0!==this.fixedDigits?b.toFixed(this.fixedDigits):b+"";
}},{parseFloat:function(a){if(0===a.length)throw new Error("Not a number: '"+a+"'");if("-"===a[0])return-b.parseFloat(a.substr(1));
if("√"===a[0])return Math.sqrt(b.parseFloat(a.substr(1)));var c=e(d,function(b){return b.character===a});if(void 0!==c)return c.value;
var f=parseFloat(a);if(isNaN(f))throw new Error("Not a number: '"+a+"'");return f},simplifyByRounding:function(a,c){if(0>a)return-b.simplifyByRounding(-a,c);
var f=a%1;if(c>=f||c>=1-f)return Math.round(a);var g=e(d,function(b){return Math.abs(b.value-a)<=c});if(void 0!==g)return g.value;
var h=e(d,function(b){return Math.abs(Math.sqrt(b.value)-a)<=c});return void 0!==h?Math.sqrt(h.value):a}})}(),c=b,d=[{character:"½",
ref:"½",expanded:"1/2",value:.5},{character:"¼",ref:"¼",expanded:"1/4",value:.25},{character:"¾",ref:"¾",expanded:"3/4",value:.75
},{character:"⅓",ref:"⅓",expanded:"1/3",value:1/3},{character:"⅔",ref:"⅔",expanded:"2/3",value:2/3},{character:"⅕",ref:"⅕",expanded:"1/5",
value:.2},{character:"⅖",ref:"⅖",expanded:"2/5",value:.4},{character:"⅗",ref:"⅗",expanded:"3/5",value:.6},{character:"⅘",ref:"⅘",
expanded:"4/5",value:.8},{character:"⅙",ref:"⅙",expanded:"1/6",value:1/6},{character:"⅚",ref:"⅚",expanded:"5/6",value:5/6},{character:"⅐",
ref:"⅐",expanded:"1/7",value:1/7},{character:"⅛",ref:"⅛",expanded:"1/8",value:1/8},{character:"⅜",ref:"⅜",expanded:"3/8",value:3/8
},{character:"⅝",ref:"⅝",expanded:"5/8",value:5/8},{character:"⅞",ref:"⅞",expanded:"7/8",value:7/8},{character:"⅑",ref:"⅑",expanded:"1/9",
value:1/9},{character:"⅒",ref:"⅒",expanded:"1/10",value:.1}],e=function(a,b){var c=!0,d=!1,e=void 0;try{for(var f=void 0,g=a[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){
var h=f.value;if(b(h))return h}}catch(i){d=!0,e=i}finally{try{c||null==g["return"]||g["return"]()}finally{if(d)throw e}}};return b.EXACT=new b(!0,0,void 0,", "),
b.MINIFIED=new b(!0,0,void 0,","),b.SIMPLIFIED=new b(!0,5e-4,3,", "),b.CONSISTENT=new b(!1,0,2,", "),{get default(){return c}}}),
$traceurRuntime.registerModule("src/base/RestartableRng.js",[],function(){"use strict";var a=((new function(){}).toString(),function(){
function a(){this._cache=[],this._next=0}return $traceurRuntime.createClass(a,{restarted:function(){var b=new a;return b._cache=this._cache,
b},random:function(){var a=this._next++;return a>=this._cache.length&&this._cache.push(Math.random()),this._cache[a]}},{})}()),b=a;
return{get default(){return b}}}),$traceurRuntime.registerModule("src/base/Revision.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Describe.js","src/base/Revision.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Equate.js","src/base/Revision.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/base/Revision.js"))["default"],d=function(){
function d(a,b,d){if(0>b||b>=a.length)throw new c("Bad index",{history:a,index:b,isWorkingOnCommit:d});this.history=a,this.index=b,
this.isWorkingOnCommit=d}return $traceurRuntime.createClass(d,{clear:function(a){this.history=[a],this.index=0,this.isWorkingOnCommit=!1;
},startedWorkingOnCommit:function(){this.isWorkingOnCommit=!0},cancelCommitBeingWorkedOn:function(){return this.isWorkingOnCommit=!1,
this.history[this.index]},commit:function(a){this.isWorkingOnCommit=!1,a!==this.history[this.index]&&(this.index+=1,this.history.splice(this.index,this.history.length-this.index),
this.history.push(a))},undo:function(){if(!this.isWorkingOnCommit){if(0===this.index)return;this.index-=1}return this.isWorkingOnCommit=!1,
this.history[this.index]},redo:function(){return this.index+1!==this.history.length?(this.index+=1,this.isWorkingOnCommit=!1,this.history[this.index]):void 0;
},toString:function(){return"Revision("+a({index:this.index,count:this.history.length,workingOnCommit:this.isWorkingOnCommit,head:this.history[this.index]
})+")"},isEqualTo:function(a){return a instanceof d&&this.index===a.index&&this.isWorkingOnCommit===a.isWorkingOnCommit&&b(this.history,a.history);
}},{startingAt:function(a){return new d([a],0,!1)}})}(),e=d;return{get default(){return e}}}),$traceurRuntime.registerModule("src/base/Seq.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/base/Seq.js"))["default"],b={
if_same_instance_as_this_then_throw:!0},c={not_a_normal_value:!0},d=[Float32Array,Float64Array,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Uint8ClampedArray],e=function(a){
return"function"==typeof Object(a)[Symbol.iterator]},f=function(a,d,e){if(a!==c)return a;if(d===b)throw new Error(e);return d},g=function(){
function g(a){var b,c,d,f=void 0!==arguments[1]?arguments[1]:!1;if(a instanceof g)c=a._iterable,d=a[Symbol.iterator];else if(f)b={},
Object.defineProperty(b,Symbol.iterator,{value:a,configurable:!0,enumerable:!0,writable:!0}),c=b,d=a;else{if(!e(a))throw new Error("Not iterable: "+a);
c=a,d=a[Symbol.iterator].bind(a)}this._iterable=c,this[Symbol.iterator]=d}return $traceurRuntime.createClass(g,{isEqualTo:function(a){
var b=void 0!==arguments[1]?arguments[1]:function(a,b){return a===b};if(!e(a))return!1;if(a===this)return!0;var c=a[Symbol.iterator](),d=!0,f=!1,g=void 0;
try{for(var h=void 0,i=this._iterable[Symbol.iterator]();!(d=(h=i.next()).done);d=!0){var j=h.value,k=c.next();if(k.done||!b(j,k.value))return!1;
}}catch(l){f=!0,g=l}finally{try{d||null==i["return"]||i["return"]()}finally{if(f)throw g}}return c.next().done},toArray:function(){
return Array.from(this._iterable)},toFloat32Array:function(){var a=this.tryPeekCount();if(void 0===a)return new Float32Array(this.toArray());
var b=new Float32Array(a),c=0,d=!0,e=!1,f=void 0;try{for(var g=void 0,h=this._iterable[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){
var i=g.value;b[c++]=i}}catch(j){e=!0,f=j}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return b},toSet:function(){
return new Set(this._iterable)},join:function(a){return this.toArray().join(a)},toString:function(){return"Seq["+this.join(", ")+"]";
},solidify:function(){var a=[Float32Array,Float64Array,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array];if(Array.isArray(this._iterable))return this;
var b=!0,c=!1,d=void 0;try{for(var e=void 0,f=a[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var h=e.value;if(this._iterable instanceof h)return this;
}}catch(i){c=!0,d=i}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return new g(this.toArray())},map:function(a){
var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){var d,e,f,g,h,i,j;return $traceurRuntime.createGeneratorInstance(function(c){
for(;;)switch(c.state){case 0:d=!0,e=!1,f=void 0,c.state=24;break;case 24:c.pushTry(10,11),c.state=13;break;case 13:g=void 0,h=b[Symbol.iterator](),
c.state=9;break;case 9:c.state=(d=(g=h.next()).done)?7:5;break;case 4:d=!0,c.state=9;break;case 5:i=g.value,c.state=6;break;case 6:
return c.state=2,a(i);case 2:c.maybeThrow(),c.state=4;break;case 7:c.popTry(),c.state=11,c.finallyFallThrough=-2;break;case 10:c.popTry(),
c.maybeUncatchable(),j=c.storedException,c.state=16;break;case 16:e=!0,f=j,c.state=11,c.finallyFallThrough=-2;break;case 11:c.popTry(),
c.state=22;break;case 22:try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}c.state=20;break;case 20:c.state=c.finallyFallThrough;
break;default:return c.end()}},c,this)}))},mapWithIndex:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=0,e=!0,f=!1,g=void 0,
c.state=26;break;case 26:c.pushTry(12,13),c.state=15;break;case 15:h=void 0,i=b[Symbol.iterator](),c.state=11;break;case 11:c.state=(e=(h=i.next()).done)?9:7;
break;case 6:e=!0,c.state=11;break;case 7:j=h.value,c.state=8;break;case 8:return c.state=2,a(j,d);case 2:c.maybeThrow(),c.state=4;
break;case 4:d+=1,c.state=6;break;case 9:c.popTry(),c.state=13,c.finallyFallThrough=-2;break;case 12:c.popTry(),c.maybeUncatchable(),
k=c.storedException,c.state=18;break;case 18:f=!0,g=k,c.state=13,c.finallyFallThrough=-2;break;case 13:c.popTry(),c.state=24;break;
case 24:try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}c.state=22;break;case 22:c.state=c.finallyFallThrough;break;default:
return c.end()}},c,this)}))},flatMap:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k,l;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=!0,e=!1,f=void 0,
c.state=32;break;case 32:c.pushTry(18,19),c.state=21;break;case 21:g=void 0,h=b[Symbol.iterator](),c.state=17;break;case 17:c.state=(d=(g=h.next()).done)?15:13;
break;case 10:d=!0,c.state=17;break;case 13:i=g.value,c.state=14;break;case 14:j=c.wrapYieldStar(a(i)[Symbol.iterator]()),c.sent=void 0,
c.action="next",c.state=12;break;case 12:k=j[c.action](c.sentIgnoreThrow),c.state=9;break;case 9:c.state=k.done?3:2;break;case 3:
c.sent=k.value,c.state=10;break;case 2:return c.state=12,k.value;case 15:c.popTry(),c.state=19,c.finallyFallThrough=-2;break;case 18:
c.popTry(),c.maybeUncatchable(),l=c.storedException,c.state=24;break;case 24:e=!0,f=l,c.state=19,c.finallyFallThrough=-2;break;case 19:
c.popTry(),c.state=30;break;case 30:try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}c.state=28;break;case 28:c.state=c.finallyFallThrough;
break;default:return c.end()}},c,this)}))},filter:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=!0,e=!1,f=void 0,c.state=25;
break;case 25:c.pushTry(11,12),c.state=14;break;case 14:g=void 0,h=b[Symbol.iterator](),c.state=10;break;case 10:c.state=(d=(g=h.next()).done)?8:6;
break;case 4:d=!0,c.state=10;break;case 6:i=g.value,c.state=7;break;case 7:c.state=a(i)?1:4;break;case 1:return c.state=2,i;case 2:
c.maybeThrow(),c.state=4;break;case 8:c.popTry(),c.state=12,c.finallyFallThrough=-2;break;case 11:c.popTry(),c.maybeUncatchable(),
j=c.storedException,c.state=17;break;case 17:e=!0,f=j,c.state=12,c.finallyFallThrough=-2;break;case 12:c.popTry(),c.state=23;break;
case 23:try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}c.state=21;break;case 21:c.state=c.finallyFallThrough;break;default:
return c.end()}},c,this)}))},filterWithIndex:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=0,e=!0,f=!1,g=void 0,
c.state=27;break;case 27:c.pushTry(13,14),c.state=16;break;case 16:h=void 0,i=b[Symbol.iterator](),c.state=12;break;case 12:c.state=(e=(h=i.next()).done)?10:8;
break;case 7:e=!0,c.state=12;break;case 8:j=h.value,c.state=9;break;case 9:c.state=a(j,d)?1:4;break;case 1:return c.state=2,j;case 2:
c.maybeThrow(),c.state=4;break;case 4:d++,c.state=7;break;case 10:c.popTry(),c.state=14,c.finallyFallThrough=-2;break;case 13:c.popTry(),
c.maybeUncatchable(),k=c.storedException,c.state=19;break;case 19:f=!0,g=k,c.state=14,c.finallyFallThrough=-2;break;case 14:c.popTry(),
c.state=25;break;case 25:try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}c.state=23;break;case 23:c.state=c.finallyFallThrough;
break;default:return c.end()}},c,this)}))},fold:function(a){var d=void 0!==arguments[1]?arguments[1]:b,e=c,g=!0,h=!1,i=void 0;try{
for(var j=void 0,k=this._iterable[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){var l=j.value;e=e===c?l:a(e,l)}}catch(m){h=!0,i=m;
}finally{try{g||null==k["return"]||k["return"]()}finally{if(h)throw i}}return f(e,d,"Folded empty sequence without providing an alternative result.");
},aggregate:function(a,b){var c=a,d=!0,e=!1,f=void 0;try{for(var g=void 0,h=this._iterable[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){
var i=g.value;c=b(c,i)}}catch(j){e=!0,f=j}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c},zip:function(a,b){
var c=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){var e,f,g,h,i,j,k,l,m;return $traceurRuntime.createGeneratorInstance(function(d){
for(;;)switch(d.state){case 0:e=a[Symbol.iterator](),f=!0,g=!1,h=void 0,d.state=29;break;case 29:d.pushTry(15,16),d.state=18;break;
case 18:i=void 0,j=c[Symbol.iterator](),d.state=14;break;case 14:d.state=(f=(i=j.next()).done)?12:10;break;case 7:f=!0,d.state=14;
break;case 10:k=i.value,d.state=11;break;case 11:l=e.next(),d.state=9;break;case 9:d.state=l.done?12:2;break;case 2:return d.state=5,
b(k,l.value);case 5:d.maybeThrow(),d.state=7;break;case 12:d.popTry(),d.state=16,d.finallyFallThrough=-2;break;case 15:d.popTry(),
d.maybeUncatchable(),m=d.storedException,d.state=21;break;case 21:g=!0,h=m,d.state=16,d.finallyFallThrough=-2;break;case 16:d.popTry(),
d.state=27;break;case 27:try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}d.state=25;break;case 25:d.state=d.finallyFallThrough;
break;default:return d.end()}},d,this)}))},max:function(){var a=void 0!==arguments[0]?arguments[0]:b;return this.fold(function(a,b){
return b>a?b:a},a)},min:function(){var a=void 0!==arguments[0]?arguments[0]:b;return this.fold(function(a,b){return b>a?a:b},a)},
maxBy:function(a){var d=void 0!==arguments[1]?arguments[1]:b,e=void 0!==arguments[2]?arguments[2]:function(a,b){return b>a},g=c,h=c,i=!0,j=!1,k=void 0;
try{for(var l=void 0,m=this._iterable[Symbol.iterator]();!(i=(l=m.next()).done);i=!0){var n=l.value;if(g!==c){h===c&&(h=a(g));var o=a(n);
e(h,o)&&(g=n,h=o)}else g=n}}catch(p){j=!0,k=p}finally{try{i||null==m["return"]||m["return"]()}finally{if(j)throw k}}return f(g,d,"Can't maxBy an empty sequence.");
},minBy:function(a){var c=void 0!==arguments[1]?arguments[1]:b,d=void 0!==arguments[2]?arguments[2]:function(a,b){return b>a};return this.maxBy(a,c,function(a,b){
return d(b,a)})},any:function(a){var b=!0,c=!1,d=void 0;try{for(var e=void 0,f=this._iterable[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){
var g=e.value;if(a(g))return!0}}catch(h){c=!0,d=h}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return!1},
every:function(a){return!this.any(function(b){return!a(b)})},contains:function(a){return this.any(function(b){return b===a})},sum:function(){
return this.fold(function(a,b){return a+b},0)},product:function(){return this.fold(function(a,b){return a*b},1)},scan:function(a,b){
var c=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){var e,f,g,h,i,j,k,l;return $traceurRuntime.createGeneratorInstance(function(d){
for(;;)switch(d.state){case 0:e=a,d.state=30;break;case 30:return d.state=2,e;case 2:d.maybeThrow(),d.state=4;break;case 4:f=!0,g=!1,
h=void 0,d.state=32;break;case 32:d.pushTry(16,17),d.state=19;break;case 19:i=void 0,j=c[Symbol.iterator](),d.state=15;break;case 15:
d.state=(f=(i=j.next()).done)?13:11;break;case 8:f=!0,d.state=15;break;case 11:k=i.value,d.state=12;break;case 12:e=b(e,k),d.state=10;
break;case 10:return d.state=6,e;case 6:d.maybeThrow(),d.state=8;break;case 13:d.popTry(),d.state=17,d.finallyFallThrough=-2;break;
case 16:d.popTry(),d.maybeUncatchable(),l=d.storedException,d.state=22;break;case 22:g=!0,h=l,d.state=17,d.finallyFallThrough=-2;break;
case 17:d.popTry(),d.state=28;break;case 28:try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}d.state=26;break;case 26:
d.state=d.finallyFallThrough;break;default:return d.end()}},d,this)}))},reverse:function(){return new g(this.toArray().reverse());
},flatten:function(){var a=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function b(){var c,d,e,f,g,h,i,j,k;
return $traceurRuntime.createGeneratorInstance(function(b){for(;;)switch(b.state){case 0:c=!0,d=!1,e=void 0,b.state=32;break;case 32:
b.pushTry(18,19),b.state=21;break;case 21:f=void 0,g=a[Symbol.iterator](),b.state=17;break;case 17:b.state=(c=(f=g.next()).done)?15:13;
break;case 10:c=!0,b.state=17;break;case 13:h=f.value,b.state=14;break;case 14:i=b.wrapYieldStar(h[Symbol.iterator]()),b.sent=void 0,
b.action="next",b.state=12;break;case 12:j=i[b.action](b.sentIgnoreThrow),b.state=9;break;case 9:b.state=j.done?3:2;break;case 3:
b.sent=j.value,b.state=10;break;case 2:return b.state=12,j.value;case 15:b.popTry(),b.state=19,b.finallyFallThrough=-2;break;case 18:
b.popTry(),b.maybeUncatchable(),k=b.storedException,b.state=24;break;case 24:d=!0,e=k,b.state=19,b.finallyFallThrough=-2;break;case 19:
b.popTry(),b.state=30;break;case 30:try{c||null==g["return"]||g["return"]()}finally{if(d)throw e}b.state=28;break;case 28:b.state=b.finallyFallThrough;
break;default:return b.end()}},b,this)}))},concat:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=c.wrapYieldStar(b[Symbol.iterator]()),
c.sent=void 0,c.action="next",c.state=12;break;case 12:e=d[c.action](c.sentIgnoreThrow),c.state=9;break;case 9:c.state=e.done?3:2;
break;case 3:c.sent=e.value,c.state=10;break;case 2:return c.state=12,e.value;case 10:f=c.wrapYieldStar(a[Symbol.iterator]()),c.sent=void 0,
c.action="next",c.state=24;break;case 24:g=f[c.action](c.sentIgnoreThrow),c.state=21;break;case 21:c.state=g.done?15:14;break;case 15:
c.sent=g.value,c.state=-2;break;case 14:return c.state=24,g.value;default:return c.end()}},c,this)}))},withOverlayedItem:function(a,b){
if(0>a)throw new Error("needed index >= 0");var c=this;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){
var e,f,g,h,i,j,k,l;return $traceurRuntime.createGeneratorInstance(function(d){for(;;)switch(d.state){case 0:if(void 0!==c.tryPeekCount()&&a>=c.tryPeekCount())throw new Error("needed index <= count");
e=0,f=!0,g=!1,h=void 0,d.state=26;break;case 26:d.pushTry(12,13),d.state=15;break;case 15:i=void 0,j=c._iterable[Symbol.iterator](),
d.state=11;break;case 11:d.state=(f=(i=j.next()).done)?9:7;break;case 6:f=!0,d.state=11;break;case 7:k=i.value,d.state=8;break;case 8:
return d.state=2,e===a?b:k;case 2:d.maybeThrow(),d.state=4;break;case 4:e++,d.state=6;break;case 9:d.popTry(),d.state=13,d.finallyFallThrough=17;
break;case 12:d.popTry(),d.maybeUncatchable(),l=d.storedException,d.state=18;break;case 18:g=!0,h=l,d.state=13,d.finallyFallThrough=17;
break;case 13:d.popTry(),d.state=24;break;case 24:try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}d.state=22;break;case 17:
if(a>=e)throw new Error("sequence ended before overlay [withOverlayedItem(${index}, ${overlayedItem})]");d.state=-2;break;case 22:
d.state=d.finallyFallThrough;break;default:return d.end()}},d,this)}))},withTransformedItem:function(a,b){if(0>a)throw new Error("needed index >= 0");
var c=this;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){var e,f,g,h,i,j,k,l;return $traceurRuntime.createGeneratorInstance(function(d){
for(;;)switch(d.state){case 0:if(void 0!==c.tryPeekCount()&&a>=c.tryPeekCount())throw new Error("needed index <= count");e=0,f=!0,
g=!1,h=void 0,d.state=26;break;case 26:d.pushTry(12,13),d.state=15;break;case 15:i=void 0,j=c._iterable[Symbol.iterator](),d.state=11;
break;case 11:d.state=(f=(i=j.next()).done)?9:7;break;case 6:f=!0,d.state=11;break;case 7:k=i.value,d.state=8;break;case 8:return d.state=2,
e===a?b(k):k;case 2:d.maybeThrow(),d.state=4;break;case 4:e++,d.state=6;break;case 9:d.popTry(),d.state=13,d.finallyFallThrough=17;
break;case 12:d.popTry(),d.maybeUncatchable(),l=d.storedException,d.state=18;break;case 18:g=!0,h=l,d.state=13,d.finallyFallThrough=17;
break;case 13:d.popTry(),d.state=24;break;case 24:try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}d.state=22;break;case 17:
if(a>=e)throw new Error("sequence ended before transformation [withTransformedItem(${index}, ${itemTransformation})]");d.state=-2;
break;case 22:d.state=d.finallyFallThrough;break;default:return d.end()}},d,this)}))},withInsertedItem:function(a,b){if(0>a)throw new Error("needed index >= 0");
var c=this;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){var e,f,g,h,i,j,k,l;return $traceurRuntime.createGeneratorInstance(function(d){
for(;;)switch(d.state){case 0:if(void 0!==c.tryPeekCount()&&a>c.tryPeekCount())throw new Error("needed index <= count");e=0,f=!0,
g=!1,h=void 0,d.state=36;break;case 36:d.pushTry(17,18),d.state=20;break;case 20:i=void 0,j=c._iterable[Symbol.iterator](),d.state=16;
break;case 16:d.state=(f=(i=j.next()).done)?14:12;break;case 9:f=!0,d.state=16;break;case 12:k=i.value,d.state=13;break;case 13:d.state=e===a?1:4;
break;case 1:return d.state=2,b;case 2:d.maybeThrow(),d.state=4;break;case 4:e++,d.state=11;break;case 11:return d.state=7,k;case 7:
d.maybeThrow(),d.state=9;break;case 14:d.popTry(),d.state=18,d.finallyFallThrough=22;break;case 17:d.popTry(),d.maybeUncatchable(),
l=d.storedException,d.state=23;break;case 23:g=!0,h=l,d.state=18,d.finallyFallThrough=22;break;case 18:d.popTry(),d.state=29;break;
case 29:try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}d.state=27;break;case 22:d.state=e===a?30:33;break;case 30:return d.state=31,
b;case 31:d.maybeThrow(),d.state=33;break;case 33:if(a>e)throw new Error("sequence ended before insertion [withInsertedItem(${index}, ${item})]");
d.state=-2;break;case 27:d.state=d.finallyFallThrough;break;default:return d.end()}},d,this)}))},takeWhile:function(a){var b=this._iterable;
return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){var d,e,f,g,h,i,j;return $traceurRuntime.createGeneratorInstance(function(c){
for(;;)switch(c.state){case 0:d=!0,e=!1,f=void 0,c.state=27;break;case 27:c.pushTry(13,14),c.state=16;break;case 16:g=void 0,h=b[Symbol.iterator](),
c.state=12;break;case 12:c.state=(d=(g=h.next()).done)?10:8;break;case 7:d=!0,c.state=12;break;case 8:i=g.value,c.state=9;break;case 9:
c.state=a(i)?2:10;break;case 2:return c.state=5,i;case 5:c.maybeThrow(),c.state=7;break;case 10:c.popTry(),c.state=14,c.finallyFallThrough=-2;
break;case 13:c.popTry(),c.maybeUncatchable(),j=c.storedException,c.state=19;break;case 19:e=!0,f=j,c.state=14,c.finallyFallThrough=-2;
break;case 14:c.popTry(),c.state=25;break;case 25:try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}c.state=23;break;case 23:
c.state=c.finallyFallThrough;break;default:return c.end()}},c,this)}))},skipTailWhile:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k,l,m;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=[],e=!0,f=!1,g=void 0,
c.state=41;break;case 41:c.pushTry(27,28),c.state=30;break;case 30:h=void 0,i=b[Symbol.iterator](),c.state=26;break;case 26:c.state=(e=(h=i.next()).done)?24:22;
break;case 20:e=!0,c.state=26;break;case 22:j=h.value,c.state=23;break;case 23:c.state=a(j)?19:11;break;case 19:d.push(j),c.state=20;
break;case 11:k=c.wrapYieldStar(d[Symbol.iterator]()),c.sent=void 0,c.action="next",c.state=12;break;case 12:l=k[c.action](c.sentIgnoreThrow),
c.state=9;break;case 9:c.state=l.done?3:2;break;case 3:c.sent=l.value,c.state=10;break;case 2:return c.state=12,l.value;case 10:d=[],
c.state=18;break;case 18:return c.state=14,j;case 14:c.maybeThrow(),c.state=20;break;case 24:c.popTry(),c.state=28,c.finallyFallThrough=-2;
break;case 27:c.popTry(),c.maybeUncatchable(),m=c.storedException,c.state=33;break;case 33:f=!0,g=m,c.state=28,c.finallyFallThrough=-2;
break;case 28:c.popTry(),c.state=39;break;case 39:try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}c.state=37;break;case 37:
c.state=c.finallyFallThrough;break;default:return c.end()}},c,this)}))},skipWhile:function(a){var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=!0,e=!0,f=!1,g=void 0,
c.state=27;break;case 27:c.pushTry(13,14),c.state=16;break;case 16:h=void 0,i=b[Symbol.iterator](),c.state=12;break;case 12:c.state=(e=(h=i.next()).done)?10:8;
break;case 4:e=!0,c.state=12;break;case 8:j=h.value,c.state=9;break;case 9:d=d&&a(j),c.state=7;break;case 7:c.state=d?4:1;break;case 1:
return c.state=2,j;case 2:c.maybeThrow(),c.state=4;break;case 10:c.popTry(),c.state=14,c.finallyFallThrough=-2;break;case 13:c.popTry(),
c.maybeUncatchable(),k=c.storedException,c.state=19;break;case 19:f=!0,g=k,c.state=14,c.finallyFallThrough=-2;break;case 14:c.popTry(),
c.state=25;break;case 25:try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}c.state=23;break;case 23:c.state=c.finallyFallThrough;
break;default:return c.end()}},c,this)}))},take:function(a){if(0>a)throw new Error("needed maxTakeCount >= 0");if(0===a)return new g([]);
var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){var d,e,f,g,h,i,j,k;return $traceurRuntime.createGeneratorInstance(function(c){
for(;;)switch(c.state){case 0:d=0,e=!0,f=!1,g=void 0,c.state=29;break;case 29:c.pushTry(15,16),c.state=18;break;case 18:h=void 0,
i=b[Symbol.iterator](),c.state=14;break;case 14:c.state=(e=(h=i.next()).done)?12:10;break;case 6:e=!0,c.state=14;break;case 10:j=h.value,
c.state=11;break;case 11:return c.state=2,j;case 2:c.maybeThrow(),c.state=4;break;case 4:d++,c.state=9;break;case 9:c.state=d>=a?12:6;
break;case 12:c.popTry(),c.state=16,c.finallyFallThrough=-2;break;case 15:c.popTry(),c.maybeUncatchable(),k=c.storedException,c.state=21;
break;case 21:f=!0,g=k,c.state=16,c.finallyFallThrough=-2;break;case 16:c.popTry(),c.state=27;break;case 27:try{e||null==i["return"]||i["return"]();
}finally{if(f)throw g}c.state=25;break;case 25:c.state=c.finallyFallThrough;break;default:return c.end()}},c,this)}))},skip:function(a){
if(0>a)throw new Error("needed maxSkipCount >= 0");if(0===a)return this;var b=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=0,e=!0,f=!1,g=void 0,
c.state=27;break;case 27:c.pushTry(13,14),c.state=16;break;case 16:h=void 0,i=b[Symbol.iterator](),c.state=12;break;case 12:c.state=(e=(h=i.next()).done)?10:8;
break;case 7:e=!0,c.state=12;break;case 8:j=h.value,c.state=9;break;case 9:c.state=d>=a?1:4;break;case 1:return c.state=2,j;case 2:
c.maybeThrow(),c.state=4;break;case 4:d++,c.state=7;break;case 10:c.popTry(),c.state=14,c.finallyFallThrough=-2;break;case 13:c.popTry(),
c.maybeUncatchable(),k=c.storedException,c.state=19;break;case 19:f=!0,g=k,c.state=14,c.finallyFallThrough=-2;break;case 14:c.popTry(),
c.state=25;break;case 25:try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}c.state=23;break;case 23:c.state=c.finallyFallThrough;
break;default:return c.end()}},c,this)}))},distinctBy:function(a){var b=this;return g.fromGenerator(function(){var c=new Set;return b.filter(function(b){
var d=a(b);return c.has(d)?!1:(c.add(d),!0)})[Symbol.iterator]()})},distinct:function(){return this.distinctBy(function(a){return a;
})},single:function(){var a=void 0!==arguments[0]?arguments[0]:b,c=this[Symbol.iterator](),d=c.next();if(!d.done&&c.next().done)return d.value;
if(a===b)throw d.done?new Error("Empty sequence doesn't contain a single item."):new Error("Sequence contains more than a single item.");
return a},first:function(){var a=void 0!==arguments[0]?arguments[0]:b,c=this[Symbol.iterator](),d=c.next();if(!d.done)return d.value;
if(a===b)throw new Error("Empty sequence has no first item.");return a},last:function(){var a=void 0!==arguments[0]?arguments[0]:b,d=c,e=!0,g=!1,h=void 0;
try{for(var i=void 0,j=this._iterable[Symbol.iterator]();!(e=(i=j.next()).done);e=!0){var k=i.value;d=k}}catch(l){g=!0,h=l}finally{
try{e||null==j["return"]||j["return"]()}finally{if(g)throw h}}return f(d,a,"Empty sequence has no last item.")},tryPeekCount:function(){
var a=this;return Array.isArray(this._iterable)||!d.every(function(b){return!(a._iterable instanceof b)})?this._iterable.length:this._iterable instanceof Map||this._iterable instanceof Set?this._iterable.size:void 0;
},count:function(){var a=this.tryPeekCount();if(void 0!==a)return a;var b=0,c=!0,d=!1,e=void 0;try{for(var f=void 0,g=this._iterable[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){
f.value;b++}}catch(h){d=!0,e=h}finally{try{c||null==g["return"]||g["return"]()}finally{if(d)throw e}}return b},padded:function(a){
var b=arguments[1];if(0>a)throw new Error("needed minCount >= 0");var c=this._iterable;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){
var e,f,g,h,i,j,k,l;return $traceurRuntime.createGeneratorInstance(function(d){for(;;)switch(d.state){case 0:e=a,f=!0,g=!1,h=void 0,
d.state=33;break;case 33:d.pushTry(12,13),d.state=15;break;case 15:i=void 0,j=c[Symbol.iterator](),d.state=11;break;case 11:d.state=(f=(i=j.next()).done)?9:7;
break;case 6:f=!0,d.state=11;break;case 7:k=i.value,d.state=8;break;case 8:return d.state=2,k;case 2:d.maybeThrow(),d.state=4;break;
case 4:e-=1,d.state=6;break;case 9:d.popTry(),d.state=13,d.finallyFallThrough=17;break;case 12:d.popTry(),d.maybeUncatchable(),l=d.storedException,
d.state=18;break;case 18:g=!0,h=l,d.state=13,d.finallyFallThrough=17;break;case 13:d.popTry(),d.state=24;break;case 24:try{f||null==j["return"]||j["return"]();
}finally{if(g)throw h}d.state=22;break;case 17:d.state=e>0?25:-2;break;case 25:return d.state=26,b;case 26:d.maybeThrow(),d.state=28;
break;case 28:e-=1,d.state=17;break;case 22:d.state=d.finallyFallThrough;break;default:return d.end()}},d,this)}))},sorted:function(){
return h(this.toArray().sort())},sortedBy:function(a){return h(this.toArray().sort(function(b,c){var d=a(b),e=a(c);return e>d?-1:d>e?1:0;
}))},ifThen:function(a,b){return a?new g(b(this)):this},toMap:function(a,b){var c=new Map,d=!0,e=!1,f=void 0;try{for(var g=void 0,h=this._iterable[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){
var i=g.value,j=a(i),k=b(i);if(c.has(j))throw new Error("Duplicate key <"+j+">. Came from item <"+i+">.");c.set(j,k)}}catch(l){e=!0,
f=l}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c},keyedBy:function(a){return this.toMap(a,function(a){
return a})},groupBy:function(a){var b=new Map,c=!0,d=!1,e=void 0;try{for(var f=void 0,g=this._iterable[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){
var h=f.value,i=a(h);b.has(i)||b.set(i,[]),b.get(i).push(h)}}catch(j){d=!0,e=j}finally{try{c||null==g["return"]||g["return"]()}finally{
if(d)throw e}}return b},partitioned:function(a){if(0>=a)throw new Error("need partitionSize > 0");var b=this;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var d,e,f,g,h,i,j,k;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:d=[],e=!0,f=!1,g=void 0,
c.state=34;break;case 34:c.pushTry(15,16),c.state=18;break;case 18:h=void 0,i=b[Symbol.iterator](),c.state=14;break;case 14:c.state=(e=(h=i.next()).done)?12:10;
break;case 6:e=!0,c.state=14;break;case 10:j=h.value,c.state=11;break;case 11:d.push(j),c.state=9;break;case 9:c.state=d.length>=a?1:6;
break;case 1:return c.state=2,d;case 2:c.maybeThrow(),c.state=4;break;case 4:d=[],c.state=6;break;case 12:c.popTry(),c.state=16,c.finallyFallThrough=20;
break;case 15:c.popTry(),c.maybeUncatchable(),k=c.storedException,c.state=21;break;case 21:f=!0,g=k,c.state=16,c.finallyFallThrough=20;
break;case 16:c.popTry(),c.state=27;break;case 27:try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}c.state=25;break;case 20:
c.state=d.length>0?28:-2;break;case 28:return c.state=29,d;case 29:c.maybeThrow(),c.state=-2;break;case 25:c.state=c.finallyFallThrough;
break;default:return c.end()}},c,this)}))},stride:function(a){return this.filterWithIndex(function(b,c){return c%a===0})},breadthFirstSearch:function(a){
var b=void 0!==arguments[1]?arguments[1]:function(a){return a},c=this;return g.fromGenerator($traceurRuntime.initGeneratorFunction(function d(){
var e,f,g,h,i,j,k,l,m,n,o;return $traceurRuntime.createGeneratorInstance(function(d){for(;;)switch(d.state){case 0:e=new Set,f=c.toArray(),
d.state=16;break;case 16:g=0,d.state=14;break;case 14:d.state=g<f.length?8:-2;break;case 7:g++,d.state=14;break;case 8:h=f[g],i=b(h),
d.state=9;break;case 9:d.state=e.has(i)?7:2;break;case 2:e.add(i),j=!0,k=!1,l=void 0;try{for(m=void 0,n=a(h)[Symbol.iterator]();!(j=(m=n.next()).done);j=!0)o=m.value,
f.push(o)}catch(p){k=!0,l=p}finally{try{j||null==n["return"]||n["return"]()}finally{if(k)throw l}}d.state=11;break;case 11:return d.state=5,
h;case 5:d.maybeThrow(),d.state=7;break;default:return d.end()}},d,this)}))}},{fromGenerator:function(a){return new g(a,!0)},range:function(b){
if(!Number.isInteger(b)||0>b)throw new a("bad count",{count:b});return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){
var a;return $traceurRuntime.createGeneratorInstance(function(c){for(;;)switch(c.state){case 0:a=0,c.state=7;break;case 7:c.state=b>a?1:-2;
break;case 4:a++,c.state=7;break;case 1:return c.state=2,a;case 2:c.maybeThrow(),c.state=4;break;default:return c.end()}},c,this);
}))},naturals:function(){return g.fromGenerator($traceurRuntime.initGeneratorFunction(function a(){var b;return $traceurRuntime.createGeneratorInstance(function(a){
for(;;)switch(a.state){case 0:b=0,a.state=9;break;case 9:a.state=1;break;case 1:return a.state=2,b;case 2:a.maybeThrow(),a.state=4;
break;case 4:b++,a.state=9;break;default:return a.end()}},a,this)}))},repeat:function(a,b){if(0>b)throw new Error("needed repeatCount >= 0");
return g.fromGenerator($traceurRuntime.initGeneratorFunction(function c(){var d;return $traceurRuntime.createGeneratorInstance(function(c){
for(;;)switch(c.state){case 0:d=0,c.state=7;break;case 7:c.state=b>d?1:-2;break;case 4:d++,c.state=7;break;case 1:return c.state=2,
a;case 2:c.maybeThrow(),c.state=4;break;default:return c.end()}},c,this)}))}})}(),h=function(a){return new g(a)},i=g;return{get THROW_IF_EMPTY(){
return b},get default(){return i},get seq(){return h},get Seq(){return g}}}),$traceurRuntime.registerModule("src/base/Util.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/base/Util.js"))["default"],b=function(){
function b(){}return $traceurRuntime.createClass(b,{},{need:function(a,b,c){if(a!==!0){var d=void 0===c?"(not provided)":"["+Array.prototype.slice.call(c).join(", ")+"]",e=void 0===b?"(not provided)":b,f="Precondition failed\n\nMessage: "+e+"\n\nArgs: "+d;
throw new Error(f)}},numberOfSetBits:function(a){if(0>a)throw new Error("i < 0");if(!Number.isInteger(a))throw new Error("!Number.isInteger(i)");
if(a>4294967295)throw new Error("i > 0xFFFFFFFF");return a=(1431655765&a)+(a>>1&1431655765),a=(858993459&a)+(a>>2&858993459),a=a+(a>>4)&252645135,
a+=a>>8,a+=a>>16,255&a},bin:function(a,b){return("0".repeat(b)+a.toString(2)).slice(-b).split("").reverse().join("")},notNull:function(a){
return b.need(null!==a,"notNull"),a},isPowerOf2:function(a){return a>0&&0===(a-1&a)},bitSize:function(a){return b.need(a>=0,"bitSize: n >= 0"),
0===a?0:Math.floor(Math.log2(a)+1e-6)+1},ceilingPowerOf2:function(a){return 1>=a?1:1<<Math.ceil(Math.log2(a))},powerOfTwoness:function(a){
if(0===a)return Math.POSITIVE_INFINITY;if(0>a)return b.powerOfTwoness(-a);var c=a^a-1,d=a&c;return Math.round(Math.log2(d))},reverseGroupMap:function(a){
var b,c,d=void 0!==arguments[1]?arguments[1]:!1,e=new Map;if(d){var f=!0,g=!1,h=void 0;try{for(var i=void 0,j=a.keys()[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){
var k=i.value;e.set(k,[])}}catch(l){g=!0,h=l}finally{try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}}}var m=!0,n=!1,o=void 0;
try{for(var p=void 0,q=a[Symbol.iterator]();!(m=(p=q.next()).done);m=!0){var r=p.value,s=(b=r[Symbol.iterator](),(c=b.next()).done?void 0:c.value),t=(c=b.next()).done?void 0:c.value,u=!0,v=!1,w=void 0;
try{for(var x=void 0,y=t[Symbol.iterator]();!(u=(x=y.next()).done);u=!0){var z=x.value;e.has(z)||e.set(z,[]),e.get(z).push(s)}}catch(A){
v=!0,w=A}finally{try{u||null==y["return"]||y["return"]()}finally{if(v)throw w}}}}catch(B){n=!0,o=B}finally{try{m||null==q["return"]||q["return"]();
}finally{if(n)throw o}}return e},binarySearchForTransitionFromTrueToFalse:function(a,b){for(var c=0;a>c;){var d=c+Math.floor((a-c)/2);
b(d)?c=d+1:a=d}return c},breakLine:function(a,c,d){if(""===a)return[""];for(var e=[],f=0;f<a.length;){var g=b.binarySearchForTransitionFromTrueToFalse(a.length-f+1,function(b){
return d(a.substr(f,b))<=c})-1;g=Math.max(1,g);var h=a.substr(f,g),i=f+g===a.length||null!==a.substr(f+g,1).match(/\s/);if(!i){var j=/^(.*\S)(\s+)\S*$/,k=j.exec(h);
if(null!==k){var l=k[1],m=k[2];e.push(l.trim()),f+=l.length+m.length;continue}}e.push(h.trim()),f+=h.length,f+=a.substr(f).match(/^\s*/)[0].length;
}return e},decomposeObjectValues:function(a){var b,c=[];b=function(a){if(Array.isArray(a)){var d=!0,e=!1,f=void 0;try{for(var g=void 0,h=a[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){
var i=g.value;b(i)}}catch(j){e=!0,f=j}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}}else c.push(a)};var d=!0,e=!1,f=void 0;
try{for(var g=void 0,h=Object.keys(a).sort()[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var i=g.value;b(a[i],c)}}catch(j){e=!0,
f=j}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c},recomposedObjectValues:function(a,c){var d,e={},f=0;
d=function(a){if(Array.isArray(a)){var b=[],e=!0,g=!1,h=void 0;try{for(var i=void 0,j=a[Symbol.iterator]();!(e=(i=j.next()).done);e=!0){
var k=i.value;b.push(d(k))}}catch(l){g=!0,h=l}finally{try{e||null==j["return"]||j["return"]()}finally{if(g)throw h}}return b}return c[f++];
};var g=!0,h=!1,i=void 0;try{for(var j=void 0,k=Object.keys(a).sort()[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){var l=j.value;
e[l]=d(a[l])}}catch(m){h=!0,i=m}finally{try{g||null==k["return"]||k["return"]()}finally{if(h)throw i}}return b.need(f===c.length,"Mismatched field value count."),
e},objectifyArrayFunc:function(a){return function(c){return b.recomposedObjectValues(c,a(b.decomposeObjectValues(c)))}},snappedCosSin:function(a){
var b=Math.PI/4,c=Math.round(a/b);if(c*b===a){var d=Math.sqrt(.5),e=[[1,0],[d,d],[0,1],[-d,d],[-1,0],[-d,-d],[0,-1],[d,-d]];return e[7&c];
}return[Math.cos(a),Math.sin(a)]},properMod:function(b,c){if(0>=c)throw new a("denominator <= 0",{numerator:b,denominator:c});var d=b%c;
return d+(0>d?c:0)}})}(),c=b;return b.STRICT_EQUALITY=function(a,b){return a===b},b.CUSTOM_IS_EQUAL_TO_EQUALITY=function(a,b){return null===a?null===b:void 0===a?void 0===b:a.isEqualTo(b);
},{get default(){return c}}}),$traceurRuntime.registerModule("src/browser/HistoryPusher.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/browser/HistoryPusher.js"))["default"],b=function(){
function b(){this._historyActionsNotWorking=!1,this._currentMemorableStateObj=void 0}return $traceurRuntime.createClass(b,{currentStateIsMemorableButUnknown:function(){
this._currentMemorableStateObj={wont_equal_this:!0}},currentStateIsMemorableAndEqualTo:function(a){this._currentMemorableStateObj=a;
},currentStateIsNotMemorable:function(){this._currentMemorableStateObj=void 0},stateChange:function(b,c){if(!c.startsWith("#"))throw new a("Expected a hash URL.",{
stateObj:b,stateUrlHash:c});if(this._currentMemorableStateObj!==b){if(this._historyActionsNotWorking)return void(document.location.hash=c);
try{void 0===this._currentMemorableStateObj?history.replaceState(b,"",c):(history.pushState(b,"",c),this._currentMemorableStateObj=void 0);
}catch(d){console.warn("Calling 'history.replaceState/pushState' failed. Falling back to setting location.hash.",d),this._historyActionsNotWorking=!0,
document.location.hash=c}}}},{})}(),c=b;return{get default(){return c}}}),$traceurRuntime.registerModule("src/browser/MouseWatcher.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/browser/MouseWatcher.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/browser/MouseWatcher.js"))["default"],
5e3),c="mouse!",d=function(a){return void 0!==window.TouchEvent&&a instanceof TouchEvent||1===a.which},e=function(a){return 2===a.which;
},f=function(b,c){var d=c.getBoundingClientRect();return new a(b.clientX-d.left,b.clientY-d.top)},g=function(a,b,c,d,e){return new i(a,b,c,d,e).addListenersUntilResultInvoked();
},h=function(a,b,c){return a.addEventListener(b,c),function(){return a.removeEventListener(b,c)}},i=function(){function a(a,b,c,d,e){
this._element=a,this._grabHandler=b,this._cancelHandler=c,this._dragHandler=d,this._dropHandler=e,this._grabPointerId=void 0,this._grabActivityTime=window.performance.now(),
this._lastPos=void 0,this._lastEv=void 0}return $traceurRuntime.createClass(a,{addListenersUntilResultInvoked:function(){var a=this,b=this._element,c=[h(b,"mousedown",function(b){
return a.handleMouseEventWith(b,a.onDown)}),h(document,"mousemove",function(b){return a.handleMouseEventWith(b,a.onMove)}),h(document,"mouseup",function(b){
return a.handleMouseEventWith(b,a.onUp)}),h(document,"mouseleave",function(b){return a.handleMouseEventWith(b,a.onLeave)}),h(document,"mouseenter",function(b){
return a.handleMouseEventWith(b,a.onEnter)}),h(b,"touchstart",function(b){return a.handleTouchEventWith(b,a.onDown)}),h(b,"touchmove",function(b){
return a.handleTouchEventWith(b,a.onMove)}),h(b,"touchend",function(b){return a.handleTouchEventWith(b,a.onUp)}),h(b,"touchcancel",function(b){
return a.handleTouchEventWith(b,a.onCancel)})];return function(){var a=!0,b=!1,d=void 0;try{for(var e=void 0,f=c[Symbol.iterator]();!(a=(e=f.next()).done);a=!0){
var g=e.value;g()}}catch(h){b=!0,d=h}finally{try{a||null==f["return"]||f["return"]()}finally{if(b)throw d}}}},canRegrab:function(){
return window.performance.now()>=this._grabActivityTime+b},onDown:function(a,b,c){if(d(c)){if(void 0!==this._grabPointerId){if(!this.canRegrab())return;
this._dropHandler(this._lastPos,this._lastEv)}this._grabPointerId=b,this._grabActivityTime=window.performance.now(),this._lastPos=a,
this._lastEv=c,this._grabHandler(a,c)}},onMove:function(a,b,c){if(this._grabPointerId===b){if(!d(c))return this._lastPos=void 0,this._lastEv=void 0,
this._grabPointerId=void 0,void this._dropHandler(void 0,c);this._grabActivityTime=window.performance.now(),this._lastPos=a,this._lastEv=c,
this._dragHandler(a,c)}},onCancel:function(a,b,c){this._grabPointerId===b&&(this._lastPos=void 0,this._lastEv=void 0,this._grabPointerId=void 0,
this._cancelHandler(c))},onUp:function(a,b,c){d(c)&&this._grabPointerId===b&&(this._lastPos=void 0,this._lastEv=void 0,this._grabPointerId=void 0,
this._dropHandler(a,c))},onLeave:function(a,b,c){d(c)&&this._grabPointerId===b&&(this._grabActivityTime=window.performance.now(),
this._lastPos=void 0,this._lastEv=c,this._dragHandler(void 0,c))},onEnter:function(a,b,c){d(c)||this._grabPointerId!==b||(this._lastPos=void 0,
this._lastEv=void 0,this._grabPointerId=void 0,this._dropHandler(void 0,c))},relativeEventPos:function(a){return f(a,this._element);
},handleTouchEventWith:function(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];b.call(this,this.relativeEventPos(d),d.identifier,a);
}},handleMouseEventWith:function(a,b){b.call(this,this.relativeEventPos(a),c,a)}},{})}();return{get watchDrags(){return g},get isLeftClicking(){
return d},get isMiddleClicking(){return e},get eventPosRelativeTo(){return f}}}),$traceurRuntime.registerModule("src/browser/Polyfills.js",[],function(){
"use strict";Float32Array.prototype.slice=Float32Array.prototype.slice||function(a,b,c){return new Float32Array(Array.from(this).slice(a,b,c));
},Float64Array.prototype.slice=Float64Array.prototype.slice||function(a,b,c){return new Float64Array(Array.from(this).slice(a,b,c));
},Uint32Array.prototype.slice=Float64Array.prototype.slice||function(a,b,c){return new Uint32Array(Array.from(this).slice(a,b,c));
},Uint16Array.prototype.slice=Float64Array.prototype.slice||function(a,b,c){return new Uint16Array(Array.from(this).slice(a,b,c));
},Uint8Array.prototype.slice=Float64Array.prototype.slice||function(a,b,c){return new Uint8Array(Array.from(this).slice(a,b,c))};var a=function(){
var a=this;return $traceurRuntime.initGeneratorFunction(function b(){var c;return $traceurRuntime.createGeneratorInstance(function(b){
for(;;)switch(b.state){case 0:c=0,b.state=7;break;case 7:b.state=c<a.length?1:-2;break;case 4:c++,b.state=7;break;case 1:return b.state=2,
a[c];case 2:b.maybeThrow(),b.state=4;break;default:return b.end()}},b,this)})()};Float32Array.prototype[Symbol.iterator]=Float32Array.prototype[Symbol.iterator]||a,
Float64Array.prototype[Symbol.iterator]=Float64Array.prototype[Symbol.iterator]||a,Uint32Array.prototype[Symbol.iterator]=Uint32Array.prototype[Symbol.iterator]||a,
Uint16Array.prototype[Symbol.iterator]=Uint16Array.prototype[Symbol.iterator]||a,Uint8Array.prototype[Symbol.iterator]=Uint8Array.prototype[Symbol.iterator]||a,
window.performance=window.performance||{},window.performance.now=window.performance.now||function(){return Date.now()};var b=WebGLRenderingContext;
if(void 0!==b&&void 0===b.INVALID_ENUM){var c=["ARRAY_BUFFER","CLAMP_TO_EDGE","COLOR_ATTACHMENT0","COMPILE_STATUS","ELEMENT_ARRAY_BUFFER","FLOAT","FRAGMENT_SHADER","FRAMEBUFFER","FRAMEBUFFER_COMPLETE","HIGH_FLOAT","LINK_STATUS","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MEDIUM_FLOAT","NEAREST","NO_ERROR","RGBA","STATIC_DRAW","TEXTURE_2D","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","TEXTURE0","TRIANGLES","UNSIGNED_SHORT","UNSIGNED_BYTE","VALIDATE_STATUS","VERTEX_SHADER"],d=document.createElement("canvas").getContext("webgl"),e=!0,f=!1,g=void 0;
try{for(var h=void 0,i=c[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){var j=h.value;b[j]=b[j]||d[j]}}catch(k){f=!0,g=k}finally{
try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}}}return{}}),$traceurRuntime.registerModule("src/browser/TouchScrollBlocker.js",[],function(){
"use strict";var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/browser/TouchScrollBlocker.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/browser/TouchScrollBlocker.js"))["default"],
function(){function a(a){this._parentElement=a,this._blockerDivs=[]}return $traceurRuntime.createClass(a,{setBlockers:function(a,b){
for(var c,d,e;this._blockerDivs.length<a.length;){var f=document.createElement("div");f.style.touchAction="none",f.style.position="absolute",
f.style.opacity=0,this._parentElement.appendChild(f),this._blockerDivs.push(f)}for(var g=0;g<a.length;g++){var h=this._blockerDivs[g].style,i=a[g].rect;
c=[i.x,i.y,i.w,i.h].map(function(a){return a+"px"}),h.left=(d=c[Symbol.iterator](),(e=d.next()).done?void 0:e.value),h.top=(e=d.next()).done?void 0:e.value,
h.width=(e=d.next()).done?void 0:e.value,h.height=(e=d.next()).done?void 0:e.value,c,h.cursor=b||a[g].cursor||"auto",h.display="inline";
}for(var j=a.length;j<this._blockerDivs.length;j++)this._blockerDivs[j].style.display="none"}},{})}()),b=a;return{get default(){return b;
}}}),$traceurRuntime.registerModule("src/circuit/CircuitDefinition.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitShaders.js","src/circuit/CircuitDefinition.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/circuit/CircuitDefinition.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/CircuitDefinition.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateColumn.js","src/circuit/CircuitDefinition.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/circuit/CircuitDefinition.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AllGates.js","src/circuit/CircuitDefinition.js"))["default"],g=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/CircuitDefinition.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/circuit/CircuitDefinition.js"))["default"]),h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/CircuitDefinition.js")),i=h.seq,j=h.Seq,k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/CircuitDefinition.js"))["default"],l=function(){
function h(a,b){if(0>a)throw new c("Bad numWires",{numWires:a});if(!Array.isArray(b))throw new c("Bad columns",{numWires:a,columns:b
});if(!b.every(function(a){return a instanceof d}))throw new c("Not a GateColumn",{columns:b});if(!b.every(function(b){return b.gates.length===a;
}))throw new c("Wrong gate count in a column",{numWires:a,columns:b});this.numWires=a,this.columns=b,this._disabledReasons=[],this._measureMasks=[0];
var e=0,f=!0,g=!1,h=void 0;try{for(var i=void 0,j=b[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value,l=k.disabledReasons(e);
e=k.nextMeasureMask(e,l),this._disabledReasons.push(l),this._measureMasks.push(e)}}catch(m){g=!0,h=m}finally{try{f||null==j["return"]||j["return"]();
}finally{if(g)throw h}}this._gateSlotCoverMap=this._computeGateSlotCoverMap()}return $traceurRuntime.createClass(h,{_computeGateSlotCoverMap:function(){
for(var a=new Map,b=0;b<this.columns.length;b++)for(var c=0;c<this.numWires;c++){var d=this.columns[b].gates[c];if(null!==d)for(var e=0;e<d.width;e++)for(var f=0;f<d.height;f++)a.set(b+e+":"+(c+f),{
col:b,row:c,gate:d})}return a},isEqualTo:function(a){return this===a?!0:a instanceof h&&this.numWires===a.numWires&&i(this.columns).isEqualTo(i(a.columns),k.CUSTOM_IS_EQUAL_TO_EQUALITY);
},toString:function(){var a=this,b=function(a){return"─".repeat(a)},c=function(a,c){return b(Math.floor(a-c.length)/2)+c+b(Math.ceil(a-c.length)/2);
},d=j.range(this.columns.length).map(function(b){return i(a.columns[b].gates).map(function(a){return null===a?0:a.serializedId.length;
}).max()}).toArray();return"CircuitDefinition ("+this.numWires+" wires, "+this.columns.length+" cols):\n	"+j.range(this.numWires).map(function(e){
return b(1)+j.range(a.columns.length).map(function(b){var f=a.columns[b].gates[e],g=null===f?"":f.serializedId;return c(d[b],g)}).join(b(1))+b(1);
}).join("\n	")},stableDuration:function(){return i(this.columns).flatMap(function(a){return a.gates}).filter(function(a){return null!==a;
}).map(function(a){return a.stableDuration()}).min(1/0)},readableHash:function(){var a=i(this.columns).flatMap(function(a){return a.gates;
}).filter(function(a){return null!==a}).map(function(a){return a.symbol}).toArray();if(0===a.length)return b.EMPTY_CIRCUIT_TITLE;var c=this.numWires+" wires, "+a.length+" ops, "+a.join("").split("^").join("");
return c.length<=40?c:c.substring(0,40)+"…"},withColumns:function(a){return new h(this.numWires,a)},_usedColumns:function(){for(var a=new Set,b=0;b<this.columns.length;b++)for(var c=0;c<this.columns[b].maximumGateWidth();c++)a.add(b+c);
return a},_findWidthWiseOverlapInRect:function(a,b,c,d){for(var e=1;c>e&&a+e<this.columns.length;e++)for(var f=0;d>f;f++){var g=this.findGateCoveringSlot(a+e,b+f);
if(void 0!==g&&g.col!==a)return{col:g.col,row:g.row}}},withWidthOverlapsFixed:function(){for(var a=this,b=[],c=this,e=function(e){
var f=j.range(c.numWires).map(function(b){var c=a.columns[e].gates[b];if(null===c)return 0;var d=a._findWidthWiseOverlapInRect(e,b,c.width,c.height);
return void 0===d?0:c.width-(d.col-e)}).max(0);b.push(c.columns[e]);for(var g=0;f>g;g++)b.push(d.empty(c.numWires))},f=0;f<this.columns.length;f++)e(f);
return this.withColumns(b)},_findHeightWiseOverlapsInCol:function(a){for(var b=new Set,c=0,d=0;d<this.numWires;d++){c-=1;var e=this.gateInSlot(a,d);
void 0!==e&&(c>0&&b.add(d),c=Math.max(c,e.height))}return b},withHeightOverlapsFixed:function(){var a,b=void 0!==arguments[0]?arguments[0]:5,c=[],e=this,g=function(a){
var b=e._findHeightWiseOverlapsInCol(a);if(0===b.size)return c.push(e.columns[a]),0;var g=function(a){return a===f.Special.Control||a===f.Special.AntiControl;
},h=i(e.columns[a].gates).mapWithIndex(function(a,c){return b.has(c)?null:a}).toArray(),j=i(e.columns[a].gates).mapWithIndex(function(a,c){
return g(a)||b.has(c)?a:null}).toArray();c.push(new d(h)),c.push(new d(j))};a:for(var h=0;h<this.columns.length;h++)switch(a=g(h)){
case 0:continue a}var j=this.withColumns(c);return c.length>this.columns.length&&b>0&&(j=j.withHeightOverlapsFixed(b-1)),j},withTrailingSpacersIncluded:function(){
return this.withColumns(i(this.columns).padded(this.minimumRequiredColCount(),d.empty(this.numWires)).toArray())},withUncoveredColumnsRemoved:function(){
var a=this._usedColumns();return new h(this.numWires,i(this.columns).filterWithIndex(function(b,c){return a.has(c)}).toArray())},
withWireCount:function(a){return a===this.numWires?this:new h(a,this.columns.map(function(b){return new d(i(b.gates).take(a).padded(a,null).toArray());
}))},minimumRequiredWireCount:function(){var a=0,b=!0,c=!1,d=void 0;try{for(var e=void 0,f=this.columns[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){
var g=e.value;a=Math.max(a,g.minimumRequiredWireCount())}}catch(h){c=!0,d=h}finally{try{b||null==f["return"]||f["return"]()}finally{
if(c)throw d}}return a},minimumRequiredColCount:function(){return Math.max(0,i(this.columns).mapWithIndex(function(a,b){return a.maximumGateWidth()+b;
}).max(-(1/0)))},colIsMeasuredMask:function(a){return 0>a?0:this._measureMasks[Math.min(a,this.columns.length)]},colHasSingleQubitDisplayMask:function(a){
var b=this;if(0>a||a>=this.columns.length)return 0;var c=this.columns[a];return j.range(c.gates.length).filter(function(a){return c.gates[a]===f.Displays.ChanceDisplay||c.gates[a]===f.Displays.BlochSphereDisplay||c.gates[a]===f.Displays.DensityMatrixDisplay;
}).filter(function(c){return void 0===b.gateAtLocIsDisabledReason(new g(a,c))}).aggregate(0,function(a,b){return a|1<<b})},colHasDoubleQubitDisplayMask:function(a){
var b=this;if(0>a||a>=this.columns.length)return 0;var c=this.columns[a];return j.range(c.gates.length).filter(function(a){return c.gates[a]===f.Displays.DensityMatrixDisplay2;
}).filter(function(c){return void 0===b.gateAtLocIsDisabledReason(new g(a,c))}).aggregate(0,function(a,b){return a|1<<b})},locIsMeasured:function(a){
var b=a.y;return 0>b||b>=this.numWires?!1:0!==(this.colIsMeasuredMask(a.x)&1<<b)},gateInSlot:function(a,b){if(!(0>a||a>=this.columns.length||0>b||b>=this.numWires)){
var c=this.columns[a].gates[b];return null===c?void 0:c}},findGateCoveringSlot:function(a,b){var c=a+":"+b;if(this._gateSlotCoverMap.has(c))return this._gateSlotCoverMap.get(c);
},locIsControl:function(a){var b=this.gateInSlot(a.x,a.y);return b===f.Special.Control||b===f.Special.AntiControl},locStartsSingleControlWire:function(a){
return this.locIsControl(a)&&!this.locIsMeasured(a)},locStartsDoubleControlWire:function(a){return this.locIsControl(a)&&this.locIsMeasured(a);
},colHasEnabledSwapGate:function(a){var b=this,c=j.range(this.numWires).map(function(b){return new g(a,b)}).filter(function(a){return b.gateInSlot(a.x,a.y)===f.Special.SwapHalf;
});return!c.any(function(a){return void 0!==b.gateAtLocIsDisabledReason(a)})&&2===c.count()},locHasControllableGate:function(a){var b=this.gateInSlot(a.x,a.y);
return void 0!==b&&b!==f.Special.Control&&b!==f.Special.AntiControl&&b!==f.SpacerGate&&(b!==f.Special.SwapHalf||this.colHasEnabledSwapGate(a.x));
},colHasControls:function(a){return 0>a||a>=this.columns.length?!1:this.columns[a].hasControl()},colHasSingleWireControl:function(a){
return 0>a||a>=this.columns.length?!1:this.columns[a].hasCoherentControl(this._measureMasks[a])},colHasDoubleWireControl:function(a){
return 0>a||a>=this.columns.length?!1:this.columns[a].hasMeasuredControl(this._measureMasks[a])},gateAtLocIsDisabledReason:function(a){
return a.x<0||a.y<0||a.x>=this._disabledReasons.length||a.y>=this.numWires?void 0:this._disabledReasons[a.x][a.y]},operationShadersInColAt:function(b,d){
var h=this;if(0>b||b>=this.columns.length)return[];var j=this.columns[b],k=i(j.gates).mapWithIndex(function(a,i){var j=new g(b,i);
if(null===a||a.definitelyHasNoEffect()||a===f.Special.SwapHalf||void 0!==h.gateAtLocIsDisabledReason(j))return[];if(void 0!==a.customShaders)return a.customShaders.map(function(a){
return function(b,c){return a(b,c,i,d)}});var k=a.knownMatrixAt(d);if(void 0===k)throw new c("Bad gate",{gate:a});return[function(a,b){
return e.qubitOperation(a,k,i,b)}]}).flatten(),l=j.swapPairs().map(function(b){var c,d,e=b,f=(c=e[Symbol.iterator](),(d=c.next()).done?void 0:d.value),g=(d=c.next()).done?void 0:d.value;
return function(b,c){return a.swap(b,f,g,c)}});return k.concat(l).toArray()},customStatRowsInCol:function(a){var b=this;if(0>a||a>=this.columns.length)return[];
var c=this.columns[a];return j.range(c.gates.length).filter(function(d){return null!==c.gates[d]&&void 0!==c.gates[d].customStatPostProcesser&&void 0===b.gateAtLocIsDisabledReason(new g(a,d));
}).toArray()},isSlotRectCoveredByGateInSameColumn:function(a,b,c){for(var d=0;c>d;d++){var e=this.findGateCoveringSlot(a,b+d);if(void 0!==e&&e.col===a)return!0;
}return!1}},{fromTextDiagram:function(a,b){var e=i(b.split("\n")).map(function(a){return a.trim()}).filter(function(a){return""!==a;
}).toArray(),f=i(e).map(function(a){return a.length}).max(0),g=e.length;return new h(g,j.range(f).map(function(f){return new d(e.map(function(d){
if(f>=d.length)throw new c("Uneven diagram",{diagram:b});var e=d[f];if(!a.has(e))throw new c("Unspecified gate",{"char":e});return a.get(e);
}))}).toArray())}})}();l.EMPTY=new l(0,[]);var m=l;return{get default(){return m}}}),$traceurRuntime.registerModule("src/circuit/CircuitShaders.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Controls.js","src/circuit/CircuitShaders.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/CircuitShaders.js"))["default"],c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/CircuitShaders.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/CircuitShaders.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/circuit/CircuitShaders.js"))["default"]),d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/CircuitShaders.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/circuit/CircuitShaders.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/CircuitShaders.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/CircuitShaders.js")).WglConfiguredShader,h=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglContext.js","src/circuit/CircuitShaders.js")).initializedWglContext,
10),i=function(){function a(){}return $traceurRuntime.createClass(a,{},{})}(),j=i,k={filterBit:"\n        float filterBit(float value, float bit) {\n            value += 0.5;\n            return mod(value, bit * 2.0) - mod(value, bit);\n        }",
toggleBit:"\n        float toggleBit(float value, float bit) {\n            float hasBit = filterBit(value, bit);\n            return value + bit - 2.0 * hasBit;\n        }",
bitMaskToPixelDeltaUv:"\n        vec2 bitMaskToPixelDeltaUv(float bitMask) {\n            float r = mod(bitMask, inputSize.x);\n            float d = floor(bitMask / inputSize.x);\n            return vec2(r, d) / inputSize.xy;\n        }"
};i.classicalState=function(a){return new g(function(b){var c=a%b.width,d=(a-c)/b.width;l.withArgs(e.vec2("pixel",c,d)).renderTo(b);
})};var l=new f("\n    /** The location of the single pixel to set. */\n    uniform vec2 pixel;\n\n    void main() {\n        vec2 d = gl_FragCoord.xy - vec2(0.5, 0.5) - pixel;\n        float f = float(d == vec2(0.0, 0.0));\n        gl_FragColor = vec4(f, 0.0, 0.0, 0.0);\n    }");
i.linearOverlay=function(a,b,c){return m.withArgs(e.vec2("backgroundTextureSize",c.width,c.height),e.vec2("foregroundTextureSize",b.width,b.height),e.texture("backgroundTexture",c,0),e.texture("foregroundTexture",b,1),e["int"]("offset",a));
};var m=new f("\n    uniform vec2 backgroundTextureSize;\n    uniform vec2 foregroundTextureSize;\n\n    uniform sampler2D backgroundTexture;\n    uniform sampler2D foregroundTexture;\n\n    /** The starting index of the range where the foreground data should be copied. */\n    uniform int offset;\n\n    void main() {\n        vec2 pixelXy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float i = pixelXy.x + pixelXy.y * backgroundTextureSize.x - float(offset);\n        if (i >= 0.0 && i < foregroundTextureSize.x * foregroundTextureSize.y) {\n            float x = mod(i, foregroundTextureSize.x);\n            float y = (i - x) / foregroundTextureSize.x;\n            vec2 fore_uv = vec2(x + 0.5, y + 0.5) / foregroundTextureSize.xy;\n            gl_FragColor = texture2D(foregroundTexture, fore_uv);\n        } else {\n            vec2 back_uv = gl_FragCoord.xy / backgroundTextureSize;\n            gl_FragColor = texture2D(backgroundTexture, back_uv);\n        }\n    }");
i.controlMask=function(b){return b.isEqualTo(a.NONE)?c.color(1,0,0,0):new g(function(a){if(a.width*a.height>1<<2*h)throw new Error("CircuitShaders.controlMask needs to be updated to allow more qubits.");
var c=a.width-1,d=Math.floor(Math.log2(a.width));n.withArgs(e["float"]("usedX",b.inclusionMask&c),e["float"]("desiredX",b.desiredValueMask&c),e["float"]("usedY",b.inclusionMask>>d),e["float"]("desiredY",b.desiredValueMask>>d)).renderTo(a);
})};var n=new f("\n    uniform float usedX;\n    uniform float desiredX;\n\n    uniform float usedY;\n    uniform float desiredY;\n\n    /**\n     * Returns 1 if (val & used == desired & used), else returns 0.\n     * Note: ignores bits past the first 10.\n     */\n    float check(float val, float used, float desired) {\n        float pass = 1.0;\n        float bit = 1.0;\n        for (int i = 0; i < "+h+"; i++) {\n            float v = mod(floor(val/bit), 2.0);\n            float u = mod(floor(used/bit), 2.0);\n            float d = mod(floor(desired/bit), 2.0);\n            pass *= 1.0 - abs(v-d)*u;\n            bit *= 2.0;\n        }\n        return pass;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float pass = check(xy.x, usedX, desiredX) * check(xy.y, usedY, desiredY);\n        gl_FragColor = vec4(pass, 0.0, 0.0, 0.0);\n    }");
i.controlSelect=function(b,d){return b.isEqualTo(a.NONE)?c.passthrough(d):new g(function(a){if(d.width*d.height>1<<2*h)throw new Error("CircuitShaders.controlSelect needs to be updated to allow more qubits.");
o.withArgs(e.texture("inputTexture",d,0),e.vec2("inputSize",d.width,d.height),e["float"]("outputWidth",a.width),e["float"]("used",b.inclusionMask),e["float"]("desired",b.desiredValueMask)).renderTo(a);
})};var o=new f("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n\n    uniform float used;\n    uniform float desired;\n\n    /**\n     * Inserts bits from the given value into the holes between used bits in the desired mask.\n     */\n    float scatter(float val, float used, float desired) {\n        float maskPos = 1.0;\n        float coordPos = 1.0;\n        float result = 0.0;\n        for (int i = 0; i < "+2*h+"; i++) {\n            float v = mod(floor(val/coordPos), 2.0);\n            float u = mod(floor(used/maskPos), 2.0);\n            float d = mod(floor(desired/maskPos), 2.0);\n            result += (v + u*(d-v)) * maskPos;\n            coordPos *= 2.0-u;\n            maskPos *= 2.0;\n        }\n        return result;\n    }\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float scatteredInputState = scatter(state, used, desired);\n        gl_FragColor = texture2D(inputTexture, toUv(scatteredInputState));\n    }");
i.swap=function(a,b,c,d){return new g(function(f){if(f.width!==a.width||f.height!==a.height)throw new Error("Texture sizes must match.");
p.withArgs(e.vec2("inputSize",f.width,f.height),e.texture("inputTexture",a,0),e["float"]("qubitIndexMask1",1<<b),e["float"]("qubitIndexMask2",1<<c),e.texture("controlTexture",d,1)).renderTo(f);
})};var p=new f("\n    /**\n     * A texture holding the complex coefficients of the superposition to operate on.\n     * The real components are in the red component, and the imaginary components are in the green component.\n     */\n    uniform sampler2D inputTexture;\n\n    /**\n     * A texture with flags that determine which states get affected by the operation.\n     * The red component is 1 for states that should participate, and 0 otherwise.\n     */\n    uniform sampler2D controlTexture;\n\n    /**\n     * The width and height of the textures being operated on.\n     */\n    uniform vec2 inputSize;\n\n    /**\n     * A power of two (2^n) with the exponent n determined by the index of one of the qubits to swap.\n     */\n    uniform float qubitIndexMask1;\n\n    /**\n     * A power of two (2^n) with the exponent n determined by the index of the other qubit to swap.\n     */\n    uniform float qubitIndexMask2;\n\n    "+k.filterBit+"\n    "+k.toggleBit+"\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        vec2 pixelXy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = pixelXy.y * inputSize.x + pixelXy.x;\n        vec2 pixelUv = gl_FragCoord.xy / inputSize;\n\n        float opposingState1 = toggleBit(state, qubitIndexMask1);\n        float opposingState2 = toggleBit(state, qubitIndexMask2);\n        bool qubitIsOn1 = state >= opposingState1;\n        bool qubitIsOn2 = state >= opposingState2;\n        bool blockedByControls = texture2D(controlTexture, pixelUv).x == 0.0;\n\n        vec2 srcPixelUv;\n        if (!blockedByControls && qubitIsOn1 != qubitIsOn2) {\n            float swapState = opposingState1 + opposingState2 - state;\n            vec2 swapPixelUv = toUv(swapState);\n            srcPixelUv = swapPixelUv;\n        } else {\n            srcPixelUv = pixelUv;\n        }\n        gl_FragColor = texture2D(inputTexture, srcPixelUv);\n    }");
i.qubitDensities=function(a){var c=arguments[1];void 0===c&&(c=a.width*a.height-1);var f=d.ceilingPowerOf2(d.numberOfSetBits(c));return new g(function(d){
var g=f*a.width*a.height/2;if(d.width*d.height!==g)throw new b("Wrong destination size.",{inputTexture:a,keptBitMask:c,destinationTexture:d
});q.withArgs(e.texture("inputTexture",a,0),e.vec2("inputSize",a.width,a.height),e["float"]("outputWidth",d.width),e["float"]("keptCount",f),e["float"]("keptBitMask",c)).renderTo(d);
})};var q=new f("\n    uniform float keptCount;\n    uniform float outputWidth;\n    uniform float keptBitMask;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n\n    float scatter(float val, float used) {\n        float result = 0.0;\n        float posUsed = 1.0;\n        float posVal = 1.0;\n        for (int i = 0; i < "+2*h+"; i++) {\n            float u = mod(floor(used/posUsed), 2.0);\n            float v = mod(floor(val/posVal), 2.0);\n            result += u * v * posUsed;\n            posVal *= 1.0+u;\n            posUsed *= 2.0;\n        }\n        return result;\n    }\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        float outIndex = (gl_FragCoord.y - 0.5) * outputWidth + (gl_FragCoord.x - 0.5);\n\n        float bitIndex = mod(outIndex, keptCount);\n        float otherBits = floor(outIndex / keptCount);\n        float bit = scatter(pow(2.0, bitIndex), keptBitMask);\n\n        // Indices of the two complex values making up the current conditional ket.\n        float srcIndex0 = mod(otherBits, bit) + floor(otherBits / bit) * bit * 2.0;\n        float srcIndex1 = srcIndex0 + bit;\n\n        // Grab the two complex values.\n        vec2 w1 = texture2D(inputTexture, toUv(srcIndex0)).xy;\n        vec2 w2 = texture2D(inputTexture, toUv(srcIndex1)).xy;\n\n        // Compute density matrix components.\n        float a = dot(w1, w1);\n        float br = dot(w1, w2);\n        float bi = dot(vec2(-w1.y, w1.x), w2);\n        float d = dot(w2, w2);\n\n        gl_FragColor = vec4(a, br, bi, d);\n    }");
i.qubitPairDensities=function(a){var c=arguments[1];void 0===c&&(c=a.width*a.height-1);var f=d.ceilingPowerOf2(d.numberOfSetBits(c));
return new g(function(d){var g=f*a.width*a.height;if(d.width*d.height!==g)throw new b("Wrong destination size.",{inputTexture:a,keptBitMask:c,
destinationTexture:d});r.withArgs(e.texture("inputTexture",a,0),e.vec2("inputSize",a.width,a.height),e["float"]("outputWidth",d.width),e["float"]("keptCount",f),e["float"]("keptBitMask",c)).renderTo(d);
})};var r=new f("\n    uniform float keptCount;\n    uniform float keptBitMask;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n\n    float scatter(float val, float used) {\n        float result = 0.0;\n        float posUsed = 1.0;\n        float posVal = 1.0;\n        for (int i = 0; i < "+2*h+"; i++) {\n            float u = mod(floor(used/posUsed), 2.0);\n            float v = mod(floor(val/posVal), 2.0);\n            result += u * v * posUsed;\n            posVal *= 1.0+u;\n            posUsed *= 2.0;\n        }\n        return result;\n    }\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        float outIndex = (gl_FragCoord.y - 0.5) * outputWidth + (gl_FragCoord.x - 0.5);\n\n        float componentIndex = mod(outIndex, 4.0);\n        float bitIndex = mod(floor(outIndex / 4.0), keptCount);\n        float otherBits = floor(outIndex / (keptCount * 4.0));\n        float bit = scatter(pow(2.0, bitIndex), keptBitMask);\n\n        // Indices of the complex values making up the conditional ket.\n        float srcIndex00 = mod(otherBits, bit) + floor(otherBits / bit) * bit * 4.0;\n        float srcIndex01 = srcIndex00 + bit;\n        float srcIndex10 = srcIndex00 + bit * 2.0;\n        float srcIndex11 = srcIndex00 + bit * 3.0;\n\n        // Grab the complex values.\n        vec2 w00 = texture2D(inputTexture, toUv(srcIndex00)).xy;\n        vec2 w01 = texture2D(inputTexture, toUv(srcIndex01)).xy;\n        vec2 w10 = texture2D(inputTexture, toUv(srcIndex10)).xy;\n        vec2 w11 = texture2D(inputTexture, toUv(srcIndex11)).xy;\n\n        // Compute density matrix components.\n        if (componentIndex == 0.0) {\n            float r00 = dot(w00, w00);\n            float r01 = dot(w01, w01);\n            float r10 = dot(w10, w10);\n            float r11 = dot(w11, w11);\n            gl_FragColor = vec4(r00, r01, r10, r11);\n        } else if (componentIndex == 1.0) {\n            float cr_00_01 = dot(w00, w01);\n            float cr_00_10 = dot(w00, w10);\n            float cr_00_11 = dot(w00, w11);\n            float cr_10_11 = dot(w10, w11);\n            gl_FragColor = vec4(cr_00_01, cr_00_10, cr_00_11, cr_10_11);\n        } else if (componentIndex == 2.0) {\n            float ci_00_01 = dot(vec2(-w00.y, w00.x), w01);\n            float ci_00_10 = dot(vec2(-w00.y, w00.x), w10);\n            float ci_00_11 = dot(vec2(-w00.y, w00.x), w11);\n            float ci_10_11 = dot(vec2(-w10.y, w10.x), w11);\n            gl_FragColor = vec4(ci_00_01, ci_00_10, ci_00_11, ci_10_11);\n        } else if (componentIndex == 3.0) {\n            float cr_01_10 = dot(w01, w10);\n            float cr_01_11 = dot(w01, w11);\n            float ci_01_10 = dot(vec2(-w01.y, w01.x), w10);\n            float ci_01_11 = dot(vec2(-w01.y, w01.x), w11);\n            gl_FragColor = vec4(cr_01_10, cr_01_11, ci_01_10, ci_01_11);\n        }\n    }");
return{get default(){return j}}}),$traceurRuntime.registerModule("src/circuit/CircuitStats.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/CircuitStats.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AllGates.js","src/circuit/CircuitStats.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/circuit/CircuitStats.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitDefinition.js","src/circuit/CircuitStats.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/circuit/CircuitStats.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Controls.js","src/circuit/CircuitStats.js"))["default"]),c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/circuit/CircuitStats.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitShaders.js","src/circuit/CircuitStats.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/circuit/CircuitStats.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/CircuitStats.js"))),d=c.seq,e=c.Seq,f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitTextures.js","src/circuit/CircuitStats.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/CircuitStats.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/CircuitStats.js"))["default"],i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Serializer.js","src/circuit/CircuitStats.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/fallback.js","src/circuit/CircuitStats.js")).notifyAboutRecoveryFromUnexpectedError,k=function(){
function c(a,b,c,d,e,f){this.circuitDefinition=a,this.time=b,this._qubitDensities=c,this._qubitPairDensities=d,this.finalState=e,
this._customStatsProcessed=f}return $traceurRuntime.createClass(c,{qubitDensityMatrix:function(b,c){if(0>b)throw new a("Bad wireIndex",{
wireIndex:b,colIndex:c});if(0>c||b>=this.circuitDefinition.numWires){var d=new Float32Array(8);return d[0]=1,new h(2,2,d)}var e=Math.min(c,this._qubitDensities.length-1);
return 0>e||b>=this._qubitDensities[e].length?h.zero(2,2).times(NaN):this._qubitDensities[e][b]},customStatsForSlot:function(a,b){
var c=a+":"+b;return this._customStatsProcessed.has(c)?this._customStatsProcessed.get(c):void 0},qubitPairDensityMatrix:function(b,c){
if(0>b)throw new a("Bad wireIndex",{wireIndex:b,colIndex:c});if(0>c||b>=this.circuitDefinition.numWires){var d=new Float32Array(32);
return d[0]=1,new h(4,4,d)}var e=Math.min(c,this._qubitPairDensities.length-1);return 0>e||b>=this._qubitPairDensities[e].length?h.zero(4,4).times(NaN):this._qubitPairDensities[e][b];
},controlledWireProbabilityJustAfter:function(a,b){return this.qubitDensityMatrix(a,b).rawBuffer()[6]},withTime:function(a){return new c(this.circuitDefinition,a,this._qubitDensities,this._qubitPairDensities,this.finalState,this._customStatsProcessed);
}},{fromCircuitAtTime:function(a,b){try{return c._fromCircuitAtTime_noFallback(a,b)}catch(d){return j("Defaulted to NaN results. Computing circuit values failed.",{
circuitDefinition:i.toJson(a)},d),new c(a,b,[],[],h.zero(1,1<<a.numWires).times(NaN),new Map)}},decohereMeasuredBitsInDensityMatrix:function(a,b){
if(0===b)return a;for(var c=new Float32Array(a.rawBuffer()),d=a.width(),e=0;d>e;e++)for(var f=0;d>f;f++)if(0!==((e^f)&b)){var g=2*(e*d+f);
c[g]=0,c[g+1]=0}return new h(d,d,c)},scatterAndDecohereDensities:function(a,b,d,f,g){var i=h.zero(1<<d,1<<d).times(NaN),j=0;return e.range(b-d+1).map(function(b){
return 0===(g&1<<b)?i:c.decohereMeasuredBitsInDensityMatrix(a[j++],f>>b&(1<<d)-1)}).toArray()},_fromCircuitAtTime_noFallback:function(a,h){
var i=a.numWires,j=a.columns.length,k=(1<<i)-1,l=[],m=[],n=[],o=[],p=f.aggregateWithReuse(f.zero(i),e.range(j),function(b,c){var d=a.columns[c],e=d.controls(),g=f.control(i,e);
b=f.aggregateReusingIntermediates(b,a.operationShadersInColAt(c,h),function(a,b){return f.applyCustomShader(b,a,g,h)});var j=!0,k=!1,p=void 0;
try{for(var q=void 0,r=a.customStatRowsInCol(c)[Symbol.iterator]();!(j=(q=r.next()).done);j=!0){var s=q.value,t=d.gates[s].customStatPipelineMaker(b,g,s,e);
o.push({col:c,row:s,out:n.length}),n.push(f.evaluatePipelineWithIntermediateCleanup(b,t))}}catch(u){k=!0,p=u}finally{try{j||null==r["return"]||r["return"]();
}finally{if(k)throw p}}return l.push(f.superpositionToQubitDensities(b,e,a.colHasSingleQubitDisplayMask(c))),m.push(f.superpositionToQubitPairDensities(b,e,a.colHasDoubleQubitDisplayMask(c))),
f.doneWithTexture(g,"controlTex in fromCircuitAtTime"),b});l.push(f.superpositionToQubitDensities(p,b.NONE,k));var q=g.objectifyArrayFunc(f.mergedReadFloats)({
outputTex:p,qubitDensityTexes:l,qubitPairDensityTexes:m,customStats:n}),r=q.qubitDensityTexes[q.qubitDensityTexes.length-1],s=r[0]+r[3],t=f.pixelsToAmplitudes(q.outputTex,s),u=d(q.qubitDensityTexes).mapWithIndex(function(b,d){
return c.scatterAndDecohereDensities(f.pixelsToQubitDensityMatrices(b),i,1,a.colIsMeasuredMask(d),d===j?-1:a.colHasSingleQubitDisplayMask(d));
}).toArray(),v=d(q.qubitPairDensityTexes).mapWithIndex(function(b,d){return c.scatterAndDecohereDensities(f.pixelsToQubitPairDensityMatrices(b),i,2,a.colIsMeasuredMask(d),a.colHasDoubleQubitDisplayMask(d));
}).toArray(),w=new Map,x=!0,y=!1,z=void 0;try{for(var A=void 0,B=o[Symbol.iterator]();!(x=(A=B.next()).done);x=!0){var C=A.value,D=C.col,E=C.row,F=C.out,G=a.gateInSlot(D,E).customStatPostProcesser||function(a){
return a};w.set(D+":"+E,G(q.customStats[F],a,D,E))}}catch(H){y=!0,z=H}finally{try{x||null==B["return"]||B["return"]()}finally{if(y)throw z;
}}return new c(a,h,u,v,t,w)}})}(),l=k;return{get default(){return l}}}),$traceurRuntime.registerModule("src/circuit/CircuitTextures.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitShaders.js","src/circuit/CircuitTextures.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/circuit/CircuitTextures.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Controls.js","src/circuit/CircuitTextures.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/CircuitTextures.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/circuit/CircuitTextures.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/CircuitTextures.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/circuit/CircuitTextures.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/CircuitTextures.js"))["default"],i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglTexture.js","src/circuit/CircuitTextures.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/CircuitTextures.js")),k=j.seq,l=j.Seq,m=function(){
function a(){}return $traceurRuntime.createClass(a,{},{})}(),n=m,o=new Map,p=0,q=function(a,b){var c=void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.FLOAT;
if(0===a||0===b)return new i(0,0,c);var d=a+":"+b+":"+c;o.has(d)||o.set(d,[]);var e=o.get(d);return e.length>0?e.pop():(p++,p>1e3&&console.warn("Allocated yet another texture ("+d+"). Failing to reuse textures?"),
new i(a,b,c))},r=function(a){return q(a.width,a.height)},s=function(a){var b=1<<Math.ceil(a/2),c=1<<Math.floor(a/2);return q(b,c);
};return m.allocQubitTexture=s,m.doneWithTexture=function(a){var b=void 0!==arguments[1]?arguments[1]:"?";if(0!==a.width){var c=o.get(a.width+":"+a.height+":"+a.pixelType);
c.push(a.invalidateButMoveToNewInstance(b))}},m.zero=function(b){var c=s(b);return a.classicalState(0).renderTo(c),c},m.control=function(b,c){
var d=s(b);return a.controlMask(c).renderTo(d),d},m.mergedReadFloats=function(c){var d=c.map(function(a){return a.width*a.height}),e=k(d).scan(0,function(a,b){
return a+b}).toArray(),f=Math.round(Math.log2(h.ceilingPowerOf2(e[e.length-1]))),i=s(f);g.color(0,0,0,0).renderTo(i),i=m.aggregateWithReuse(i,l.range(c.length).filter(function(a){
return c[a].width>0}),function(b,d){var g=c[d],h=s(f);return a.linearOverlay(e[d],g,b).renderTo(h),m.doneWithTexture(g,"inputTex in mergedReadFloats"),
h});var j;if(b.ENCODE_FLOATS_AS_BYTES_WHEN_READING_PIXELS){var n=q(2*i.width,2*i.height,WebGLRenderingContext.UNSIGNED_BYTE);g.encodeFloatsIntoBytes(i).renderTo(n);
var o=n.readPixels();j=g.decodeByteBufferToFloatBuffer(o),m.doneWithTexture(n,"combinedTexBytes in mergedReadFloats")}else j=i.readPixels();
return m.doneWithTexture(i,"combinedTex in mergedReadFloats"),l.range(c.length).map(function(a){var b=4*e[a],c=4*d[a];return j.subarray(b,b+c);
}).toArray()},m.applyCustomShader=function(a,b,c,d){var e=r(b);return a(b,c,d).renderTo(e),e},m.qubitOperation=function(a,b,c,d){
var f=r(a);return e.qubitOperation(a,d,c,b).renderTo(f),f},m.aggregateReusingIntermediates=function(a,b,c){var d=k(b).aggregate(a,function(b,d){
var e=c(b,d);return b!==a&&m.doneWithTexture(b,"prevTex in aggregateReusingIntermediates"),e});return d===a&&(d=r(a),g.passthrough(a).renderTo(d)),
d},m.aggregateWithReuse=function(a,b,c){return k(b).aggregate(a,function(a,b){var d=c(a,b);return m.doneWithTexture(a,"prevTex in aggregateWithReuse"),
d})},m.pixelsToAmplitudes=function(a,b){1e-6>b&&(b=NaN);for(var c=Math.sqrt(b),d=a.length/4,e=new Float32Array(2*d),g=0;d>g;g++)e[2*g]=a[4*g]/c,
e[2*g+1]=a[4*g+1]/c;return new f(1,d,e)},m.qubitCount=function(a){return Math.round(Math.log2(a.width*a.height))},m.superpositionToQubitDensities=function(b,d,e){
if(0===e)return new i(0,0);var f=!d.isEqualTo(c.NONE),g=b;f&&(g=s(m.qubitCount(b)-d.includedBitCount()),a.controlSelect(d,b).renderTo(g));
for(var j=1,k=1;k<=d.inclusionMask;k<<=1)0===(d.inclusionMask&k)?j<<=1:e=e&j-1|(e&~(j-1))>>1;var l=m._superpositionTexToUnsummedQubitDensitiesTex(g,e);
f&&m.doneWithTexture(g,"reducedTex in superpositionToQubitDensities");var n=h.numberOfSetBits(e),o=m._sumDown(l,n);return m.doneWithTexture(l,"unsummedTex in superpositionToQubitDensities"),
o},m.superpositionToQubitPairDensities=function(b,d,e){if(0===e)return new i(0,0);var f=!d.isEqualTo(c.NONE),g=b;f&&(g=s(m.qubitCount(b)-d.includedBitCount()),
a.controlSelect(d,b).renderTo(g));for(var j=1,k=1;k<=d.inclusionMask;k<<=1)0===(d.inclusionMask&k)?j<<=1:e=e&j-1|(e&~(j-1))>>1;var l=m._superpositionTexToUnsummedQubitPairDensitiesTex(g,e);
f&&m.doneWithTexture(g,"reducedTex in superpositionToQubitDensities");var n=h.numberOfSetBits(e),o=m._sumDown(l,4*n);return m.doneWithTexture(l,"unsummedTex in superpositionToQubitDensities"),
o},m._superpositionTexToUnsummedQubitDensitiesTex=function(b,c){if(0===c)throw new d("keptBitMask === 0",{superpositionTex:b,keptBitMask:c
});var e=m.qubitCount(b),f=h.numberOfSetBits(c),g=s(e-1+Math.ceil(Math.log2(f)));return a.qubitDensities(b,c).renderTo(g),g},m._superpositionTexToUnsummedQubitPairDensitiesTex=function(b,c){
if(0===c)throw new d("keptBitMask === 0",{superpositionTex:b,keptBitMask:c});var e=m.qubitCount(b),f=h.numberOfSetBits(c),g=s(e+Math.ceil(Math.log2(f)));
return a.qubitPairDensities(b,c).renderTo(g),g},m._sumDown=function(a,b){var c=h.ceilingPowerOf2(b),d=Math.min(a.width,c);return m.aggregateReusingIntermediates(a,l.range(Math.round(Math.log2(a.width*a.height/c))),function(a){
var b,c,e=a.width>Math.max(d,a.height)?[a.width/2,0]:[0,a.height/2],f=(b=e[Symbol.iterator](),(c=b.next()).done?void 0:c.value),h=(c=b.next()).done?void 0:c.value,i=q(a.width-f,a.height-h);
return g.sumFold(a,f,h).renderTo(i),i})},m.pixelsToQubitDensityMatrices=function(a){var b=a.length/4;return l.range(b).map(function(b){
var c=a[4*b],d=a[4*b+3],e=c+d;if(1e-7>e||isNaN(e))return new f(2,2,new Float32Array([NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN]));var g=a[4*b+1]/e,h=a[4*b+2]/e;
return new f(2,2,new Float32Array([c/e,0,g,h,g,-h,d/e,0]))}).toArray()},m.evaluatePipelineWithIntermediateCleanup=function(a,b){var c=!0,d=[],e=k(b.steps).aggregate(a,function(a,b){
var e=b,f=e.w,g=e.h,h=e.shaderFunc,i=e.keepResult,j=q(f,g);return h(a).renderTo(j),c||m.doneWithTexture(a,"evaluatePipelineWithIntermediateCleanup"),
c=i,i&&d.push(j),j});return e===a&&(e=r(a),g.passthrough(a).renderTo(e)),0===d.length?e:(d.push(e),d)},m.pixelsToQubitPairDensityMatrices=function(a){
if(a.length%16!==0)throw new d("Expected a multiple of 16 sized buffer.",{len:a.length,buffer:a});var b=a.length/16;return l.range(b).map(function(b){
var c=16*b,d=a[c],e=a[c+1],g=a[c+2],h=a[c+3],i=d+e+g+h;if(1e-7>i||isNaN(i))return f.zero(4,4).times(NaN);d/=i,e/=i,g/=i,h/=i;var j=a[c+4]/i,k=a[c+5]/i,l=a[c+6]/i,m=a[c+7]/i,n=a[c+8]/i,o=a[c+9]/i,p=a[c+10]/i,q=a[c+11]/i,r=a[c+12]/i,s=a[c+13]/i,t=a[c+14]/i,u=a[c+15]/i;
return new f(4,4,new Float32Array([d,0,j,n,k,o,l,p,j,-n,e,0,r,t,s,u,k,-o,r,-t,g,0,m,q,l,-p,s,-u,m,-q,h,0]))}).toArray()},m.swap=function(b,c,d,e){
var f=r(b);return a.swap(b,d,e,c).renderTo(f),f},{get default(){return n}}}),$traceurRuntime.registerModule("src/circuit/Controls.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/Controls.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/Controls.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/Controls.js"))["default"],d=function(){
function d(b,c){if(0!==(c&~b))throw new a("Desired un-included bits",{inclusionMask:b,desiredValueMask:c});this.inclusionMask=b,this.desiredValueMask=c;
}return $traceurRuntime.createClass(d,{isEqualTo:function(a){return a instanceof d&&this.inclusionMask===a.inclusionMask&&this.desiredValueMask===a.desiredValueMask;
},toString:function(){var a=this;return 0===this.inclusionMask?"No Controls":"Controls: ...__"+b.naturals().takeWhile(function(b){
return 1<<b<=a.inclusionMask}).map(this.desiredValueFor.bind(this)).map(function(a){return null===a?"_":a?"1":"0"}).reverse().join("");
},allowsState:function(a){return(this.inclusionMask&a)===this.desiredValueMask},desiredValueFor:function(a){return 0===(this.inclusionMask&1<<a)?null:0!==(this.desiredValueMask&1<<a);
},includedBitCount:function(){return this.inclusionMask<0?1/0:c.numberOfSetBits(this.inclusionMask)},and:function(b){if((b.desiredValueMask&this.inclusionMask)!==(this.desiredValueMask&b.inclusionMask))throw new a("Contradictory controls.",{
"this":this,other:b});return new d(this.inclusionMask|b.inclusionMask,this.desiredValueMask|b.desiredValueMask)}},{bit:function(b,c){
if(0>b)throw new a("Out of range",{bitIndex:b});return new d(1<<b,c?1<<b:0)}})}();d.NONE=new d(0,0);var e=d;return{get default(){
return e}}}),$traceurRuntime.registerModule("src/circuit/CycleCircuitStats.js",[],function(){"use strict";var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitDefinition.js","src/circuit/CycleCircuitStats.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitStats.js","src/circuit/CycleCircuitStats.js"))["default"]),b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/CycleCircuitStats.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/CycleCircuitStats.js"))["default"],d=function(){
function d(a,c){this.circuitDefinition=a,this._divisions=Math.min(c,Math.max(1,1/a.stableDuration())),this._cachedCircuitStatsByTime=b.repeat(void 0,this._divisions).toArray();
}return $traceurRuntime.createClass(d,{_computeStateForBucket:function(b){var c=(b+.5)/this._divisions;return a.fromCircuitAtTime(this.circuitDefinition,c);
},statsAtApproximateTime:function(a){var b=c.properMod(Math.round(a*this._divisions-.5),this._divisions);return void 0===this._cachedCircuitStatsByTime[b]&&(this._cachedCircuitStatsByTime[b]=this._computeStateForBucket(b)),
this._cachedCircuitStatsByTime[b].withTime(a)}},{})}(),e=d;return{get default(){return e}}}),$traceurRuntime.registerModule("src/circuit/DisplayShaders.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/DisplayShaders.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/circuit/DisplayShaders.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/circuit/DisplayShaders.js"))["default"]),c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/DisplayShaders.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/DisplayShaders.js")).WglConfiguredShader,e=function(){
function a(){}return $traceurRuntime.createClass(a,{},{})}(),f=e;e.amplitudesToProbabilities=function(a,c){return new d(function(d){
return g.withArgs(b.texture("inputTexture",a,0),b.texture("controlTexture",c,1),b.vec2("inputSize",a.width,a.height),b["float"]("outputWidth",d.width)).renderTo(d);
})};var g=new c("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        vec2 uv = toUv(state);\n        vec4 amp = texture2D(inputTexture, uv);\n        float con = texture2D(controlTexture, uv).x;\n        float p = con * dot(amp, amp);\n        gl_FragColor = vec4(p, 0.0, 0.0, 0.0);\n    }");
e.amplitudesToDensities=function(c,e){return new d(function(d){var f=d.width*d.height,g=c.width*c.height;if(f!==g<<e)throw new a("Wrong destination size.",{
inputTexture:c,qubitSpan:e,destinationTexture:d});h.withArgs(b.texture("inputTexture",c,0),b.vec2("inputSize",c.width,c.height),b["float"]("outputWidth",d.width),b["float"]("qubitSpan",1<<e)).renderTo(d);
})};var h=new c("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform float qubitSpan;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n\n        float stateKet = mod(state, qubitSpan);\n        float stateBra = mod(floor(state / qubitSpan), qubitSpan);\n        float stateOther = floor(state / qubitSpan / qubitSpan);\n\n        vec2 uvKet = toUv(stateKet + stateOther*qubitSpan);\n        vec2 uvBra = toUv(stateBra + stateOther*qubitSpan);\n\n        vec2 ampKet = texture2D(inputTexture, uvKet).xy;\n        vec2 ampBra = texture2D(inputTexture, uvBra).xy;\n        float r = dot(ampKet, ampBra);\n        float i = dot(ampKet, vec2(-ampBra.y, ampBra.x));\n\n        gl_FragColor = vec4(r, i, 0.0, 0.0);\n    }");
return{get default(){return f}}}),$traceurRuntime.registerModule("src/circuit/Gate.js",[],function(){"use strict";var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/circuit/Gate.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/Gate.js"))["default"]),b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GateDrawParams.js","src/circuit/Gate.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/circuit/Gate.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/Gate.js"))["default"]),c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/circuit/Gate.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/circuit/Gate.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/Gate.js"))["default"]),d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/Gate.js")),e=d.seq,f=d.Seq,g=function(){
function d(a,b,c){this.symbol=a,this.serializedId=a,this.name=b,this.blurb=c,this.width=1,this.height=1,this.customDrawer=void 0,
this.tag=void 0,this.customShaders=void 0,this.customStatPipelineMaker=void 0,this.customStatPostProcesser=void 0,this.gateFamily=[this],
this._stableDuration=void 0,this._knownMatrix=void 0,this._knownMatrixFunc=void 0,this._hasNoEffect=void 0,this._effectPermutesStates=void 0,
this._effectCreatesSuperpositions=void 0}return $traceurRuntime.createClass(d,{withKnownMatrix:function(a){var b=this._copy();return b._knownMatrix=a,
b},withKnownMatrixFunc:function(a){var b=this._copy();return b._knownMatrixFunc=a,b},markedAsOnlyPermutingAndPhasing:function(){var a=this._copy();
return a._hasNoEffect=!1,a._effectPermutesStates=!0,a._effectCreatesSuperpositions=!1,a},markedAsOnlyPhasing:function(){var a=this._copy();
return a._hasNoEffect=!1,a._effectPermutesStates=!1,a._effectCreatesSuperpositions=!1,a},markedAsStable:function(){var a=this._copy();
return a._stableDuration=1/0,a},_copy:function(){var a=new d(this.symbol,this.name,this.blurb);return a.serializedId=this.serializedId,
a.tag=this.tag,a.customDrawer=this.customDrawer,a.customShaders=this.customShaders,a.customStatPipelineMaker=this.customStatPipelineMaker,
a.customStatPostProcesser=this.customStatPostProcesser,a.width=this.width,a.height=this.height,a.gateFamily=this.gateFamily,a._knownMatrix=this._knownMatrix,
a._knownMatrixFunc=this._knownMatrixFunc,a._stableDuration=this._stableDuration,a._hasNoEffect=this._hasNoEffect,a._effectPermutesStates=this._effectPermutesStates,
a._effectCreatesSuperpositions=this._effectCreatesSuperpositions,a},withStableDuration:function(a){var b=this._copy();return b._stableDuration=a,
b},withWidth:function(a){var b=this._copy();return b.width=a,b},withHeight:function(a){var b=this._copy();return b.height=a,b},withCustomDrawer:function(a){
var b=this._copy();return b.customDrawer=a,b},withSerializedId:function(a){var b=this._copy();return b.serializedId=a,b},withCustomShaders:function(a){
var b=this._copy();return b.customShaders=a,b},withCustomStatPipelineMaker:function(a){var b=this._copy();return b.customStatPipelineMaker=a,
b},withCustomStatPostProcessor:function(a){var b=this._copy();return b.customStatPostProcesser=a,b},withCustomShader:function(a){
return this.withCustomShaders([a])},canChangeInSize:function(){return this.gateFamily.length>1},canIncreaseInSize:function(){var a=this;
return!this.gateFamily.every(function(b){return b.height!==a.height+1})},canDecreaseInSize:function(){var a=this;return!this.gateFamily.every(function(b){
return b.height!==a.height-1})},withTag:function(a){var b=this._copy();return b.tag=a,b},knownMatrixAt:function(a){return void 0!==this._knownMatrix?this._knownMatrix:void 0!==this._knownMatrixFunc?this._knownMatrixFunc(a):void 0;
},effectMightPermutesStates:function(){return void 0!==this._effectPermutesStates?this._effectPermutesStates:void 0!==this._knownMatrix?!this._knownMatrix.isDiagonal():!0;
},effectMightCreateSuperpositions:function(){return void 0!==this._effectCreatesSuperpositions?this._effectCreatesSuperpositions:void 0!==this._knownMatrix?!this._knownMatrix.isPhasedPermutation():!0;
},definitelyHasNoEffect:function(){return void 0!==this._hasNoEffect?this._hasNoEffect:void 0!==this._knownMatrix?this._knownMatrix.isIdentity():!1;
},stableDuration:function(){return void 0!==this._stableDuration?this._stableDuration:void 0!==this._knownMatrix||this._hasNoEffect?1/0:0;
},isEqualTo:function(a){return this===a?!0:a instanceof d&&this.symbol===a.symbol&&this.serializedId===a.serializedId&&c.CUSTOM_IS_EQUAL_TO_EQUALITY(this._knownMatrix,a._knownMatrix)&&this._knownMatrixFunc===a._knownMatrixFunc&&this._effectCreatesSuperpositions===a._effectCreatesSuperpositions&&this._effectPermutesStates===a._effectPermutesStates&&this._hasNoEffect===a._hasNoEffect&&this.name===a.name&&this.blurb===a.blurb&&this.symbol===a.symbol&&this.tag===a.tag&&this._stableDuration===a._stableDuration&&this.customShaders===a.customShaders&&this.customStatPipelineMaker===a.customStatPipelineMaker&&this.customStatPostProcesser===a.customStatPostProcesser&&this.customDrawer===a.customDrawer;
},toString:function(){return"Gate("+this.symbol+")"}},{fromKnownMatrix:function(c,e,f,g){if(!(e instanceof b))throw new a("Bad matrix.",{
symbol:c,matrix:e,name:f,blurb:g});var h=new d(c,f,g);return h._knownMatrix=e,h._stableDuration=1/0,h},fromVaryingMatrix:function(a,b,c,e){
var f=void 0!==arguments[4]?arguments[4]:!0,g=void 0!==arguments[5]?arguments[5]:!0,h=new d(a,c,e);return h._knownMatrixFunc=b,h._hasNoEffect=!1,
h._effectPermutesStates=f,h._effectCreatesSuperpositions=g,h},fromIdentity:function(a,b,c){var e=new d(a,b,c);return e._stableDuration=1/0,
e._hasNoEffect=!0,e._effectPermutesStates=!1,e._effectCreatesSuperpositions=!1,e},withoutKnownMatrix:function(a,b,c){return new d(a,b,c);
},generateFamily:function(a,b,c){var d=f.range(b+1).skip(a).map(function(a){return c(a)._copy()}).toArray(),g=!0,h=!1,i=void 0;try{
for(var j=void 0,k=d[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){var l=j.value;l.gateFamily=d}}catch(m){h=!0,i=m}finally{try{
g||null==k["return"]||k["return"]()}finally{if(h)throw i}}return{all:d,ofSize:function(a){return e(d).filter(function(b){return void 0===b||b.height===a;
}).first()}}}})}(),h=g;return{get default(){return h}}}),$traceurRuntime.registerModule("src/circuit/GateColumn.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/GateColumn.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/circuit/GateColumn.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AllGates.js","src/circuit/GateColumn.js"))["default"]),c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/GateColumn.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Controls.js","src/circuit/GateColumn.js"))["default"]),d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/GateColumn.js")),e=d.seq,f=d.Seq,g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/GateColumn.js"))["default"],h=function(){
function d(a){this.gates=a}return $traceurRuntime.createClass(d,{isEqualTo:function(a){return this===a?!0:a instanceof d&&e(this.gates).isEqualTo(e(a.gates),g.STRICT_EQUALITY);
},isEmpty:function(){return this.gates.every(function(a){return null===a})},swapPairs:function(){var a=this,c=f.range(this.gates.length).filter(function(c){
return a.gates[c]===b.Special.SwapHalf}).toArray();return 2!==c.length?[]:[c]},controls:function(){var a=this;return f.range(this.gates.length).map(function(d){
return a.gates[d]===b.Special.Control?c.bit(d,!0):a.gates[d]===b.Special.AntiControl?c.bit(d,!1):c.NONE}).aggregate(c.NONE,function(a,b){
return a.and(b)})},hasControl:function(){return e(this.gates).any(function(a){return a===b.Special.Control||a===b.Special.AntiControl;
})},hasCoherentControl:function(a){var c=this;return f.range(this.gates.length).any(function(d){return 0===(a&1<<d)&&(c.gates[d]===b.Special.Control||c.gates[d]===b.Special.AntiControl);
})},hasMeasuredControl:function(a){var c=this;return f.range(this.gates.length).any(function(d){return 0!==(a&1<<d)&&(c.gates[d]===b.Special.Control||c.gates[d]===b.Special.AntiControl);
})},_disabledReason:function(a,c){var d=this,e=this.gates[c];if(null!==e){if("Parse Error"===e.name)return"parse\nerror";if(e===b.Special.Measurement&&this.hasControl()&&0===(a&1<<c))return"can't\ncontrol\n(sorry)";
if(e===b.Special.SwapHalf){var g=f.range(this.gates.length).filter(function(a){return d.gates[a]===b.Special.SwapHalf}),h=g.count();
if(1===h)return"need\nother\nswap";if(h>2)return"too\nmany\nswap";var i=g.any(function(b){return 0!==(a&1<<b)}),j=g.any(function(b){
return 0===(a&1<<b)});if(i&&this.hasCoherentControl(a))return"no\nremix\n(sorry)";if(i&&j&&this.hasControl())return"no\nremix\n(sorry)";
}for(var k=1;k<e.height;k++)if(this.gates[c+k]===b.Special.Control||this.gates[c+k]===b.Special.AntiControl)return"control\ninside";
var l=(1<<e.height)-1<<c,m=l&a;if(0!==m){if(e.effectMightCreateSuperpositions())return"no\nremix\n(sorry)";if(e.effectMightPermutesStates()&&(m!==l||this.hasCoherentControl(a)))return"no\nremix\n(sorry)";
}}},minimumRequiredWireCount:function(){for(var a=0,b=0;b<this.gates.length;b++)null!==this.gates[b]&&(a=Math.max(a,this.gates[b].height+b));
return a},maximumGateWidth:function(){return e(this.gates).filter(function(a){return null!==a}).map(function(a){return a.width}).max(-(1/0));
},disabledReasons:function(a){var b=this;return f.range(this.gates.length).map(function(c){return b._disabledReason(a,c)}).toArray();
},nextMeasureMask:function(a,c){var d=this;return f.range(this.gates.length).aggregate([a,void 0],function(a,e){var f,g,h=a,i=(f=h[Symbol.iterator](),
(g=f.next()).done?void 0:g.value),j=(g=f.next()).done?void 0:g.value;if(void 0!==c[e])return[i,j];var k=d.gates[e],l=1<<e;if(k===b.Special.Measurement)return[i|l,j];
var m=k===b.PostSelectionGates.PostSelectOn||k===b.PostSelectionGates.PostSelectOff;if(!d.hasControl()&&m)return[i&~l,j];if(k===b.Special.SwapHalf){
if(void 0===j)return[i,e];var n=1<<j,o=e-j;return[i&~(n|l)|(i&n)<<o|(i&l)>>o,void 0]}return[i,j]})[0]},withGatesAdded:function(b,c){
if(!Number.isInteger(b)||0>b||b>this.gates.length-c.gates.length)throw new a("Bad start index",{baseCol:this,startIndex:b,insertedCol:c
});for(var e=this.gates.map(function(a){return a}),f=0;f<c.gates.length;f++)e[b+f]=c.gates[f];return new d(e)}},{empty:function(a){
return new d(f.repeat(null,a).toArray())}})}(),i=h;return{get default(){return i}}}),$traceurRuntime.registerModule("src/circuit/GateShaders.js",[],function(){
"use strict";var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Controls.js","src/circuit/GateShaders.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/GateShaders.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/GateShaders.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/GateShaders.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/circuit/GateShaders.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/GateShaders.js"))["default"]),b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/circuit/GateShaders.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/GateShaders.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/GateShaders.js")).WglConfiguredShader,e=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglContext.js","src/circuit/GateShaders.js")).initializedWglContext,
function(){function a(){}return $traceurRuntime.createClass(a,{},{})}()),f=e;e.qubitOperation=function(c,e,f,h){return new d(function(d){
var i,j;a.need(2===e.width()&&2===e.height());var k=e.rawBuffer(),l=(i=k[Symbol.iterator](),(j=i.next()).done?void 0:j.value),m=(j=i.next()).done?void 0:j.value,n=(j=i.next()).done?void 0:j.value,o=(j=i.next()).done?void 0:j.value,p=(j=i.next()).done?void 0:j.value,q=(j=i.next()).done?void 0:j.value,r=(j=i.next()).done?void 0:j.value,s=(j=i.next()).done?void 0:j.value;
g.withArgs(b.vec2("inputSize",d.width,d.height),b.texture("inputTexture",c,0),b["float"]("qubitIndexMask",1<<f),b.texture("controlTexture",h,1),b.vec2("matrix_a",l,m),b.vec2("matrix_b",n,o),b.vec2("matrix_c",p,q),b.vec2("matrix_d",r,s)).renderTo(d);
})};var g=new c("\n    /**\n     * A texture holding the complex coefficients of the superposition to operate on.\n     * The real components are in the red component, and the imaginary components are in the green component.\n     */\n    uniform sampler2D inputTexture;\n\n    /**\n     * A texture with flags that determine which states get affected by the operation.\n     * The red component is 1 for states that should participate, and 0 otherwise.\n     */\n    uniform sampler2D controlTexture;\n\n    /**\n     * The width and height of the textures being operated on.\n     */\n    uniform vec2 inputSize;\n\n    /**\n     * A power of two (2^n) with the exponent n determined by the index of the qubit to operate on.\n     */\n    uniform float qubitIndexMask;\n\n    /**\n     * The row-wise complex coefficients of the matrix to apply. Laid out normally, they would be:\n     * M = |a b|\n     *     |c d|\n     */\n    uniform vec2 matrix_a, matrix_b, matrix_c, matrix_d;\n\n    float filterBit(float value, float bit) {\n        value += 0.5;\n        return mod(value, bit * 2.0) - mod(value, bit);\n    }\n    float toggleBit(float value, float bit) {\n        float hasBit = filterBit(value, bit);\n        return value + bit - 2.0 * hasBit;\n    }\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n\n        // Which part of the multiplication are we doing?\n        vec2 pixelXy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        vec2 pixelUv = gl_FragCoord.xy / inputSize;\n        float state = pixelXy.y * inputSize.x + pixelXy.x;\n        float opposingState = toggleBit(state, qubitIndexMask);\n        vec2 opposingPixelUv = toUv(opposingState);\n        bool targetBitIsOff = state < opposingState;\n\n        // Does this part of the superposition match the controls?\n        bool blockedByControls = texture2D(controlTexture, pixelUv).x == 0.0;\n        if (blockedByControls) {\n            gl_FragColor = texture2D(inputTexture, pixelUv);\n            return;\n        }\n\n        // The row we operate against is determined by the output pixel's operated-on-bit's value\n        vec2 c1, c2;\n        if (targetBitIsOff) {\n            c1 = matrix_a;\n            c2 = matrix_b;\n        } else {\n            c1 = matrix_d;\n            c2 = matrix_c;\n        }\n\n        // Do (our part of) the matrix multiplication\n        vec4 amplitudeCombo = vec4(texture2D(inputTexture, pixelUv).xy,\n                                   texture2D(inputTexture, opposingPixelUv).xy);\n        vec4 dotReal = vec4(c1.x, -c1.y,\n                            c2.x, -c2.y);\n        vec4 dotImag = vec4(c1.y, c1.x,\n                            c2.y, c2.x);\n        vec2 outputAmplitude = vec2(dot(amplitudeCombo, dotReal),\n                                    dot(amplitudeCombo, dotImag));\n\n        gl_FragColor = vec4(outputAmplitude, 0.0, 0.0);\n    }");
e.increment=function(a,c,e,f,g){return new d(function(d){h.withArgs(b.texture("inputTexture",a,0),b.texture("controlTexture",c,1),b["float"]("outputWidth",d.width),b.vec2("inputSize",a.width,a.height),b["float"]("qubitIndex",1<<e),b["float"]("qubitSpan",1<<f),b["float"]("incrementAmount",g)).renderTo(d);
})};var h=new c("\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float incrementAmount;\n    uniform float qubitIndex;\n    uniform float qubitSpan;\n\n    vec2 uvFor(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float oldState = xy.y * outputWidth + xy.x;\n        float oldStateTarget = mod(floor(oldState / qubitIndex), qubitSpan);\n        float newStateTarget = mod(oldStateTarget - incrementAmount + qubitSpan, qubitSpan);\n        float newState = oldState + (newStateTarget - oldStateTarget) * qubitIndex;\n\n        vec2 oldUv = uvFor(oldState);\n        float control = texture2D(controlTexture, oldUv).x;\n\n        vec2 newUv = uvFor(newState);\n        vec2 usedUv = control*newUv + (1.0-control)*oldUv;\n\n        gl_FragColor = texture2D(inputTexture, usedUv);\n    }");
e.addition=function(a,c,e,f,g,h){return new d(function(d){i.withArgs(b.texture("inputTexture",a,0),b.texture("controlTexture",c,1),b["float"]("outputWidth",d.width),b.vec2("inputSize",a.width,a.height),b["float"]("qubitIndex",1<<e),b["float"]("qubitSrcSpan",1<<f),b["float"]("qubitDstSpan",1<<g),b["float"]("scaleFactor",h)).renderTo(d);
})};var i=new c("\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float scaleFactor;\n    uniform float qubitIndex;\n    uniform float qubitSrcSpan;\n    uniform float qubitDstSpan;\n\n    vec2 uvFor(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float stateSrc = mod(floor(state / qubitIndex), qubitSrcSpan);\n        float stateDst = mod(floor((state / qubitIndex) / qubitSrcSpan), qubitDstSpan);\n        float newDst = mod(stateDst + (qubitDstSpan - stateSrc) * scaleFactor, qubitDstSpan);\n        float newState = state + (newDst - stateDst) * qubitIndex * qubitSrcSpan;\n\n        vec2 oldUv = uvFor(state);\n        float control = texture2D(controlTexture, oldUv).x;\n\n        vec2 newUv = uvFor(newState);\n        vec2 usedUv = control*newUv + (1.0-control)*oldUv;\n\n        gl_FragColor = texture2D(inputTexture, usedUv);\n    }");
e.cycleAllBits=function(c,e){var f=Math.floor(Math.log2(c.width*c.height));return new d(function(d){j.withArgs(b.texture("inputTexture",c,0),b["float"]("outputWidth",d.width),b.vec2("inputSize",c.width,c.height),b["float"]("shiftAmount",1<<a.properMod(-e,f))).renderTo(d);
})};var j=new c("\n    uniform sampler2D inputTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float shiftAmount;\n\n    vec2 uvFor(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float span = inputSize.x * inputSize.y;\n        float state = xy.y * outputWidth + xy.x;\n        float shiftedState = state * shiftAmount;\n        float cycledState = mod(shiftedState, span) + floor(shiftedState / span);\n        vec2 uv = uvFor(cycledState);\n        gl_FragColor = texture2D(inputTexture, uv);\n    }");
return{get default(){return f}}}),$traceurRuntime.registerModule("src/circuit/Serializer.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitDefinition.js","src/circuit/Serializer.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/circuit/Serializer.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/circuit/Serializer.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Describe.js","src/circuit/Serializer.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/Serializer.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/circuit/Serializer.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/circuit/Serializer.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateColumn.js","src/circuit/Serializer.js"))["default"],i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/circuit/Serializer.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AllGates.js","src/circuit/Serializer.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/circuit/Serializer.js"))["default"],l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/circuit/Serializer.js"))["default"],m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/fallback.js","src/circuit/Serializer.js")).notifyAboutRecoveryFromUnexpectedError,n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/Joke_MysteryGate.js","src/circuit/Serializer.js")),o=n.MysteryGateSymbol,p=n.MysteryGateMakerWithMatrix,q=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/circuit/Serializer.js")),r=q.seq,s=(q.Seq,
function(){function a(){}return $traceurRuntime.createClass(a,{},{toJson:function(a){var b,c,e=!0,f=!1,g=void 0;try{for(var h=void 0,i=E[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){
var j=h.value,k=(b=j[Symbol.iterator](),(c=b.next()).done?void 0:c.value),l=(c=b.next()).done?void 0:c.value;(c=b.next()).done?void 0:c.value;
if(a instanceof k)return l(a)}}catch(m){f=!0,g=m}finally{try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}}throw new Error("Don't know how to convert "+d(a)+" to JSON.");
},fromJson:function(a,b){var c,e,f=!0,g=!1,h=void 0;try{for(var i=void 0,j=E[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value,l=(c=k[Symbol.iterator](),
(e=c.next()).done?void 0:e.value),m=((e=c.next()).done?void 0:e.value,(e=c.next()).done?void 0:e.value);if(l===a)return m(b)}}catch(n){
g=!0,h=n}finally{try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}}throw new Error("Don't know how to deserialize JSON "+d(value)+" into an instance of "+a+".");
}})}()),t=s,u=function(a){return a.toString(f.MINIFIED)},v=function(a){if("string"==typeof a)return b.parse(a);throw new Error("Not a packed complex string: "+a);
},w=function(a){return a.toString(f.MINIFIED)},x=function(a){if("string"!=typeof a)throw new Error("Not a packed matrix string: "+a);
return k.parse(a)},y=function(a){if(r(j.KnownToSerializer).contains(a))return a.serializedId;if("Parse Error"===a.name)return a.tag;
if(a.stableDuration()!==1/0||void 0===a.knownMatrixAt(0))throw new e("Can't serialize unknown gate with non-trivial operation.",{
gate:a});var b=a.knownMatrixAt(.25);return""===a.serializedId?{matrix:w(b)}:{id:a.serializedId,matrix:w(b)}},z=function(a){var b="string"==typeof a?a:a.id;
void 0===b&&(b=""),"string"!=typeof b&&(b=d(b));var c=a.matrix;if(void 0===c){var e=r(j.KnownToSerializer).filter(function(a){return a.serializedId===b;
}).first(null);if(null!==e)return e}var f,h=""===b?i.MATRIX_DRAWER:i.DEFAULT_DRAWER;try{if(void 0===c)throw new Error("Unrecognized gate id, but no matrix specified.");
if(f=x(c),f.width()!==f.height())throw new Error("Gate matrix must be square.");if(f.width()<2||!l.isPowerOf2(f.width()))throw new Error("Gate matrix size must be at least 2, and a power of 2.");
}catch(k){return m("Defaulted to a do-nothing 'parse error' gate. Failed to understand the json defining a gate.",{gate_json:a},k),
g.fromIdentity(b,"Parse Error",d(k)).withCustomDrawer(h).withTag(a)}return b===o&&void 0!==f?p(f):g.fromKnownMatrix(b,f,b,"").withCustomDrawer(h);
},A=function(a){return a.gates.map(function(a){return null===a?1:y(a)})},B=function(a){if(!Array.isArray(a))throw new Error("GateColumn json should be an array. Json: "+d(a));
return new h(a.map(function(a){return 1===a||null===a?null:z(a)}))},C=function(a){return{cols:a.columns.map(s.toJson).map(function(a){
return r(a).skipTailWhile(function(a){return 1===a}).toArray()})}},D=function(b){var e=b.cols;if(!Array.isArray(e))throw new Error("CircuitDefinition json should contain an array of cols. Json: "+d(b));
var f=e.map(function(a){return s.fromJson(h,a)}),g=r(f).map(function(a){return a.minimumRequiredWireCount()}).max(0);return g=Math.max(c.MIN_WIRE_COUNT,Math.min(g,c.MAX_WIRE_COUNT)),
f=f.map(function(a){return new h(r(a.gates).padded(g,null).toArray().slice(0,g))}),new a(g,f)},E=[[b,u,v],[g,y,z],[k,w,x],[h,A,B],[a,C,D]];
return{get default(){return t}}}),$traceurRuntime.registerModule("src/circuit/ShaderPipeline.js",[],function(){"use strict";var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/circuit/ShaderPipeline.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/circuit/ShaderPipeline.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/circuit/ShaderPipeline.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/ShaderPipeline.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/circuit/ShaderPipeline.js")).WglConfiguredShader,
function(){function a(){this.steps=[]}return $traceurRuntime.createClass(a,{addSizedStep:function(a,b,c){var d=void 0!==arguments[3]?arguments[3]:!1;
this.steps.push({w:a,h:b,shaderFunc:c,keepResult:d})},addPowerSizedStep:function(a,b){var c=void 0!==arguments[2]?arguments[2]:!1;
this.addSizedStep(1<<Math.ceil(a/2),1<<Math.floor(a/2),b,c)},addPipelineSteps:function(a){for(var b=void 0!==arguments[1]?arguments[1]:!1,c=0;c<a.steps.length;c++){
var d=a.steps[c],e=d.w,f=d.h,g=d.shaderFunc;this.addSizedStep(e,f,g,c===a.steps.length-1&&b)}}},{})}()),b=a;return{get default(){
return b}}}),$traceurRuntime.registerModule("src/Config.js",[],function(){"use strict";var a=function(){function a(){}return $traceurRuntime.createClass(a,{},{});
}(),b=a;return a.EMPTY_CIRCUIT_TITLE="Toy Quantum Circuit Simulator",a.MAX_WIRE_COUNT=16,a.SIMPLE_SUPERPOSITION_DRAWING_WIRE_THRESHOLD=14,
a.NO_SUPERPOSITION_DRAWING_WIRE_THRESHOLD=17,a.MIN_WIRE_COUNT=2,a.MIN_COL_COUNT=5,a.URL_CIRCUIT_PARAM_KEY="circuit",a.GATE_FILL_COLOR="white",
a.HIGHLIGHTED_GATE_FILL_COLOR="#FB7",a.DISPLAY_GATE_IN_TOOLBOX_FILL_COLOR="#4F4",a.DISPLAY_GATE_BACK_COLOR="#EFE",a.DISPLAY_GATE_FORE_COLOR="#3F3",
a.OPERATION_BACK_COLOR="#FFE",a.OPERATION_FORE_COLOR="#FF0",a.SUPERPOSITION_BACK_COLOR="#EFF",a.SUPERPOSITION_MID_COLOR="#8FF",a.SUPERPOSITION_FORE_COLOR="#0BB",
a.CYCLE_DURATION_MS=8e3,a.TIME_CACHE_GRANULARITY=196,a.REDRAW_COOLDOWN_MILLIS=1e3/60,a.GATE_RADIUS=20,a.WIRE_SPACING=50,a.BACKGROUND_COLOR="white",
a.BACKGROUND_COLOR_CIRCUIT="white",a.BACKGROUND_COLOR_TOOLBOX="#CCC",a.TOOLBOX_GATE_SPACING=2,a.TOOLBOX_GROUP_SPACING=24-a.TOOLBOX_GATE_SPACING,
a.TOOLBOX_GATE_SPAN=2*a.GATE_RADIUS+a.TOOLBOX_GATE_SPACING,a.TOOLBOX_GROUP_SPAN=2*a.TOOLBOX_GATE_SPAN+a.TOOLBOX_GROUP_SPACING,a.TOOLBOX_MARGIN_X=35,
a.TOOLBOX_MARGIN_Y=18,a.MINIMUM_CANVAS_HEIGHT=400,a.SUPPRESSED_GLSL_WARNING_PATTERNS=[/^\s*([^\) ]+\): warning X3595: gradient instruction used in a loop with varying iteration; partial derivatives may have undefined value\b)+\s*$/,/^\s*([^\) ]+\): warning X4008: floating point division by zero\b)+\s*$/],
a.DEFAULT_FILL_COLOR="white",a.DEFAULT_STROKE_COLOR="black",a.DEFAULT_TEXT_COLOR="black",a.DEFAULT_FONT_SIZE=12,a.DEFAULT_FONT_FAMILY="Helvetica",
a.DEFAULT_STROKE_THICKNESS=1,a.CHECK_WEB_GL_ERRORS_EVEN_ON_HOT_PATHS=!1,a.ENCODE_FLOATS_AS_BYTES_WHEN_READING_PIXELS=!0,a.SEMI_STABLE_RANDOM_VALUE_LIFETIME_MILLIS=300,
a.PHASE_CANCEL_FIRST_ENTRY_OF_AMPLITUDE_DISPLAYS=!0,{get default(){return b}}}),$traceurRuntime.registerModule("src/fallback.js",[],function(){
"use strict";function a(a,b){if(void 0===b){var c=!0,e=!1,f=void 0;try{for(var g=void 0,h=d[Symbol.iterator]();!(c=(g=h.next()).done);c=!0){
var i=g.value,j=i.regex,k=i.handler;if(j.test(a))return k}}catch(l){e=!0,f=l}finally{try{c||null==h["return"]||h["return"]()}finally{
if(e)throw f}}}}function b(a,b,c,d,e){try{var f=k((e instanceof Object?e.stack:void 0)||b+":"+c+":"+d),g=["URL",document.location,"","BROWSER",window.navigator.userAgent,window.navigator.appName,window.navigator.appVersion,"","ERROR OBJECT",e instanceof Object&&void 0!==e.toString?e.toString():String(e),"","ERROR LOCATION",k(f)].join("\n");
h("An error happened. :(",a,g,"(Unexpected) "+a+" @ "+f.substr(0,200)+"[...]"),m(["An error is happening. :(","",a,"","Scroll down for more information"].join("\n"));
}catch(i){console.error("Caused an exception when handling unexpected error.",i)}return!1}var c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Describe.js","src/fallback.js"))["default"],d=[],e=function(a,b,c,d){
document.getElementById("error-happened-div").innerText=a,document.getElementById("error-message-div").innerText=b,document.getElementById("error-description-div").innerText=c,
document.getElementById("error-mailto-anchor").innerText="Email the issue to craig.gidney@gmail.com",document.getElementById("error-mailto-anchor").href=["mailto:craig.gidney@gmail.com?subject=",encodeURIComponent("Quirk had an error: "+b),"&body=",encodeURIComponent("\n\n\n"+c)].join(""),
document.getElementById("error-github-anchor").href=["https://github.com/Strilanc/Quirk/issues/new?title=",encodeURIComponent("Encountered error: "+b),"&body=",encodeURIComponent("\n\n\n"+c)].join(""),
document.getElementById("error-image-pre").src=i(),setTimeout(function(){document.getElementById("error-image-post").src=i()},0),
void 0===d?(document.getElementById("error-report-div").style.display="block",document.getElementById("error-known-div").style.display="none"):(document.getElementById("error-report-div").style.display="none",
document.getElementById("error-known-div").style.display="block",document.getElementById("error-known-issue-anchor").href=d)},f=[],g=[],h=function(b,c,d,h){
var i=arguments[4],j=document.getElementById("error-div").style;if(j.opacity<.7&&(f=[],g=[]),j.backgroundColor="#FFA",j.opacity=1,
j.display="block",-1===f.indexOf(d)){f.push(d),g.length>0&&(d+="\n\nCOVERED\n"+g.join("\n-------------\n")),-1===g.indexOf(h)&&g.push(h);
var k=a(c,i);return void 0!==k?void k():void e(b,c,d,i)}},i=function(){var a=document.getElementById("drawCanvas");return void 0===a?"#":a.toDataURL("image/png");
},j=function(a,b,d){console.error("Recovered from unexpected error",{recovery:a,context:b,error:d});var e=d.stack||"unknown",f=[a,"","URL",document.location,"","BROWSER",window.navigator.userAgent,window.navigator.appName,window.navigator.appVersion,"","RECOVERY DETAILS",c(b),"","ERROR OBJECT",c(d),"","ERROR LOCATION",k(e)].join("\n");
h("Recovered from an error. :(",a+" ("+(d.message||"")+")",f,"(Recovered) "+a+" @ "+e.substr(0,200)+"[...]")},k=function(a){return a.replace(/http.+?\/src\.min\.js/g,"src.min.js");
},l=function(a,b,c){var e=function(){return h("A known problem is happening. :(",a,"",a,b)},f=!0,g=!1,i=void 0;try{for(var j=void 0,k=c[Symbol.iterator]();!(f=(j=k.next()).done);f=!0){
var l=j.value;d.push({regex:l,handler:e})}}catch(m){g=!0,i=m}finally{try{f||null==k["return"]||k["return"]()}finally{if(g)throw i;
}}e()},m=function(a){var b=document.getElementById("drawCanvas");if(void 0!==b){var c=b.getContext("2d");c.font="12px monospace";var d=a.split("\n"),e=0,f=!0,g=!1,h=void 0;
try{for(var i=void 0,j=d[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value;e=Math.max(e,c.measureText(k).width)}}catch(l){
g=!0,h=l}finally{try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}}var m=12*d.length,n=(b.clientWidth-e)/2,o=(b.clientHeight-m)/2;
c.fillStyle="white",c.globalAlpha=.9,c.fillRect(n-10,o-10,e+20,m+20),c.globalAlpha=1,c.strokeStyle="red",c.strokeRect(n-10,o-10,e+20,m+20),
c.fillStyle="red";for(var p=0,q=0;q<d.length;q++)p+=3,c.fillText(d[q],n,o+p),p+=9}};return window.onerror=b,{get notifyAboutRecoveryFromUnexpectedError(){
return j},get onErrorHandler(){return b},get notifyAboutKnownIssue(){return l}}}),$traceurRuntime.registerModule("src/gates/AllGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/ArithmeticGates.js","src/gates/AllGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AmplitudeDisplayFamily.js","src/gates/AllGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/BlochSphereDisplay.js","src/gates/AllGates.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/Controls.js","src/gates/AllGates.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/CountingGates.js","src/gates/AllGates.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/CycleBitsGates.js","src/gates/AllGates.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/DensityMatrixDisplayFamily.js","src/gates/AllGates.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/Debug_ErrorInjectionGate.js","src/gates/AllGates.js"))["default"],i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/ExponentiatingGates.js","src/gates/AllGates.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/FourierTransformGates.js","src/gates/AllGates.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/HalfTurnGates.js","src/gates/AllGates.js"))["default"],l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/MeasurementGate.js","src/gates/AllGates.js"))["default"],m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/PhaseGradientGates.js","src/gates/AllGates.js"))["default"],n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/PostSelectionGates.js","src/gates/AllGates.js"))["default"],o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/PoweringGates.js","src/gates/AllGates.js"))["default"],p=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/ProbabilityDisplayFamily.js","src/gates/AllGates.js"))["default"],q=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/QuarterTurnGates.js","src/gates/AllGates.js"))["default"],r=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/SampleDisplayFamily.js","src/gates/AllGates.js"))["default"],s=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/SpacerGate.js","src/gates/AllGates.js"))["default"],t=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/SwapGateHalf.js","src/gates/AllGates.js"))["default"],u=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/Impossible_UniversalNotGate.js","src/gates/AllGates.js"))["default"],v=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/VariousXGates.js","src/gates/AllGates.js"))["default"],w=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/VariousYGates.js","src/gates/AllGates.js"))["default"],x=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/VariousZGates.js","src/gates/AllGates.js"))["default"],y=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/Joke_MysteryGate.js","src/gates/AllGates.js")).MysteryGateMaker,z={},A=z;
return z.Special={Control:d.Control,AntiControl:d.AntiControl,Measurement:l,SwapHalf:t},z.Displays={AmplitudeDisplayFamily:b,ProbabilityDisplayFamily:p,
SampleDisplayFamily:r,DensityMatrixDisplayFamily:g,BlochSphereDisplay:c},z.Arithmetic=a,z.CountingGates=e,z.CycleBitsGates=f,z.Displays.DensityMatrixDisplay=g.ofSize(1),
z.Displays.DensityMatrixDisplay2=g.ofSize(2),z.Displays.ChanceDisplay=z.Displays.ProbabilityDisplayFamily.ofSize(1),z.ErrorInjection=h,
z.Exponentiating=i,z.FourierTransformGates=j,z.HalfTurns=k,z.OtherX=v,z.OtherY=w,z.OtherZ=x,z.PhaseGradientGates=m,z.PostSelectionGates=n,
z.Powering=o,z.QuarterTurns=q,z.SpacerGate=s,z.UniversalNot=u,z.KnownToSerializer=$traceurRuntime.spread(d.all,[l,t,s,u,h],b.all,p.all,r.all,g.all,[c],a.all,e.all,f.all,i.all,j.all,k.all,q.all,m.all,n.all,o.all,v.all,w.all,x.all),
z.ToolboxGroups=[{hint:"Probes",gates:[l,void 0,n.PostSelectOff,n.PostSelectOn,d.AntiControl,d.Control]},{hint:"Displays",gates:[r.ofSize(3),void 0,g.ofSize(1),c,p.ofSize(1),b.ofSize(2)]
},{hint:"Half Turns",gates:[k.Z,t,k.Y,void 0,k.X,k.H]},{hint:"Quarter Turns",gates:[q.SqrtZForward,q.SqrtZBackward,q.SqrtYForward,q.SqrtYBackward,q.SqrtXForward,q.SqrtXBackward]
},{hint:"Eighth Turns",gates:[x.Z4,x.Z4i,w.Y4,w.Y4i,v.X4,v.X4i]},{hint:"Misc",gates:[m.PhaseGradientFamily.ofSize(2),m.PhaseDegradientFamily.ofSize(2),void 0,y(),j.FourierTransformFamily.ofSize(2),s]
},{hint:"Arithmetic",gates:[e.CountingFamily.ofSize(2),e.UncountingFamily.ofSize(2),a.AdditionFamily.ofSize(4),a.SubtractionFamily.ofSize(4),a.IncrementFamily.ofSize(2),a.DecrementFamily.ofSize(2)]
},{hint:"Raising",gates:[o.ZForward,o.ZBackward,o.YForward,o.YBackward,o.XForward,o.XBackward]},{hint:"Exponentiating",gates:[i.ZForward,i.ZBackward,i.YForward,i.YBackward,i.XForward,i.XBackward]
},{hint:"Other X",gates:[v.X16,v.X16i,v.X8,v.X8i,v.X3,v.X3i]},{hint:"Other Y",gates:[w.Y16,w.Y16i,w.Y8,w.Y8i,w.Y3,w.Y3i]},{hint:"Other Z",
gates:[x.Z16,x.Z16i,x.Z8,x.Z8i,x.Z3,x.Z3i]}],{get default(){return A}}}),$traceurRuntime.registerModule("src/gates/AmplitudeDisplayFamily.js",[],function(){
"use strict";function a(a,b,j,k){var l,o,p=[a.width,a.height],r=(l=p[Symbol.iterator](),(o=l.next()).done?void 0:o.value),s=(o=l.next()).done?void 0:o.value,t=new v,u=x.numberOfSetBits(b.inclusionMask),y=Math.round(Math.log2(r*s))-u;
t.addPowerSizedStep(y,function(a){return m.controlSelect(b,a)});var z=x.numberOfSetBits(b.inclusionMask&(1<<j)-1),B=n.allocQubitTexture(y);
t.addPowerSizedStep(y,function(a){return new A(function(b){q.cycleAllBits(a,z-j).renderTo(b),w.passthrough(b).renderTo(B)})}),t.addPowerSizedStep(y,c),
t.addPipelineSteps(d(k,y)),t.addPipelineSteps(e(k,y)),t.addPowerSizedStep(k,f,!0),t.addPowerSizedStep(y,function(a){return new A(function(b){
g(B)(a).renderTo(b),n.doneWithTexture(B)})}),t.addPipelineSteps(h(k,y));var C=y-k;return t.addPipelineSteps(i(1<<Math.ceil(C/2),1<<Math.floor(C/2))),
t}function b(a){var b,c,d=a,e=(b=d[Symbol.iterator](),(c=b.next()).done?void 0:c.value),f=(c=b.next()).done?void 0:c.value,g=e.length>>2,h=2===g?2:1<<Math.floor(Math.round(Math.log2(g))/2),i=g/h,j=!isNaN(f[0]),k=e[2];
if(!j){for(var m=new Float32Array(2*g),n=0;g>n;n++){var o=e[4*n],p=e[4*n+1];m[2*n]=Math.sqrt((o*o+p*p)/k)}return{probabilities:new t(h,i,m),
superposition:void 0}}for(var q=l.PHASE_CANCEL_FIRST_ENTRY_OF_AMPLITUDE_DISPLAYS?Math.atan2(e[1],e[0]):0,r=Math.cos(q),s=-Math.sin(q),u=new Float32Array(2*g),v=Math.sqrt(k),w=0;g>w;w++){
var x=e[4*w]/v,y=e[4*w+1]/v;u[2*w]=x*r+y*-s,u[2*w+1]=x*s+y*r}return{probabilities:void 0,superposition:new t(h,i,u)}}function c(a){
return new A(function(b){return B.withArgs(y.vec2("inputSize",a.width,a.height),y["float"]("outputWidth",b.width),y.texture("inputTexture",a,0)).renderTo(b);
})}function d(a,b){for(var c=new v,d=function(a){c.addPowerSizedStep(b,function(b){return new A(function(c){return C.withArgs(y.vec2("inputSize",b.width,b.height),y["float"]("outputWidth",c.width),y.texture("inputTexture",b,0),y["float"]("bit",1<<a)).renderTo(c);
})})},e=0;a>e;e++)d(e);return c}function e(a,b){for(var c=new v,d=function(a){c.addPowerSizedStep(b-a-1,function(c){return new A(function(d){
return D.withArgs(y.vec2("inputSize",c.width,c.height),y["float"]("outputWidth",d.width),y.texture("inputTexture",c,0),y["float"]("offset",1<<b-a-1)).renderTo(d);
})})},e=0;b-a>e;e++)d(e);return c}function f(a){return new A(function(b){return E.withArgs(y.vec2("inputSize",a.width,a.height),y["float"]("outputWidth",b.width),y.texture("inputTexture",a,0)).renderTo(b);
})}function g(a){return function(b){return new A(function(c){return F.withArgs(y.vec2("inputSize",a.width,a.height),y.vec2("repSize",b.width,b.height),y["float"]("outputWidth",c.width),y.texture("inputTexture",a,0),y.texture("repTexture",b,1)).renderTo(c);
})}}function h(a,b){for(var c=new v,d=function(d){c.addPowerSizedStep(b-d-1,function(b){return new A(function(c){return G.withArgs(y.vec2("inputSize",b.width,b.height),y["float"]("outputWidth",c.width),y.texture("inputTexture",b,0),y["float"]("bit",1<<a-d-1)).renderTo(c);
})})},e=0;a>e;e++)d(e);return c}function i(a,b){for(var c=new v;a>1||b>1;)a>b?(a>>=1,c.addSizedStep(a,b,function(a){return function(b){
return w.sumFold(b,a,0)}}(a))):(b>>=1,c.addSizedStep(a,b,function(a){return function(b){return w.sumFold(b,0,a)}}(b)));return c}function j(a,b){
var c=void 0,d=a.positionInCircuit,e=d.col,f=d.row,g=0!==(a.stats.circuitDefinition.colIsMeasuredMask(e)>>f&(1<<a.gate.height)-1);
b?c="incoherent":g&&(c=a.gate.width<=2?"(w/ measure defer)":"(assuming measurement deferred)"),void 0!==c&&a.painter.print(c,a.rect.x+a.rect.w/2,a.rect.y+a.rect.h,"center","hanging","red","12px Helvetica",a.rect.w,a.rect.h,void 0);
}function k(c){return o.fromIdentity("Amps","Amplitude Display","Shows the amplitudes of some wires, if separable.\nUse controls to see conditional amplitudes.").withHeight(c).withWidth(1===c?2:c%2===0?c:Math.ceil(c/2)).withSerializedId("Amps"+c).withCustomStatPipelineMaker(function(b,d,e,f){
return a(b,f,e,c)}).withCustomStatPostProcessor(b).withCustomDrawer(H)}var l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/AmplitudeDisplayFamily.js"))["default"],m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitShaders.js","src/gates/AmplitudeDisplayFamily.js"))["default"],n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitTextures.js","src/gates/AmplitudeDisplayFamily.js"))["default"],o=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/gates/AmplitudeDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/DisplayShaders.js","src/gates/AmplitudeDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/AmplitudeDisplayFamily.js"))["default"]),p=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/AmplitudeDisplayFamily.js"))["default"],q=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/AmplitudeDisplayFamily.js"))["default"],r=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/gates/AmplitudeDisplayFamily.js"))["default"],s=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/gates/AmplitudeDisplayFamily.js"))["default"],t=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/AmplitudeDisplayFamily.js"))["default"],u=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/AmplitudeDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/gates/AmplitudeDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/gates/AmplitudeDisplayFamily.js"))),v=(u.seq,
u.Seq,$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/ShaderPipeline.js","src/gates/AmplitudeDisplayFamily.js"))["default"]),w=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/gates/AmplitudeDisplayFamily.js"))["default"],x=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/gates/AmplitudeDisplayFamily.js"))["default"],y=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/gates/AmplitudeDisplayFamily.js"))["default"],z=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/gates/AmplitudeDisplayFamily.js"))["default"],A=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/gates/AmplitudeDisplayFamily.js")).WglConfiguredShader,B=new z("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        vec2 ri = texture2D(inputTexture, toUv(state)).xy;\n        float mag = dot(ri, ri);\n        float phase = atan(ri.y, ri.x);\n        gl_FragColor = vec4(mag, phase, mag, 0.0);\n    }"),C=new z("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform float bit;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n    float xorBit(float v) {\n        float b = mod(floor(v/bit), 2.0);\n        float d = 1.0 - 2.0*b;\n        return v + bit*d;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float partner = xorBit(state);\n        vec4 v = texture2D(inputTexture, toUv(state));\n        vec4 p = texture2D(inputTexture, toUv(partner));\n        gl_FragColor = vec4(v.x, v.y, v.z + p.z, 0.0);\n    }"),D=new z("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform float offset;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        vec4 p1 = texture2D(inputTexture, toUv(state));\n        vec4 p2 = texture2D(inputTexture, toUv(state + offset));\n        gl_FragColor = vec4(\n            p1.x + p2.x,\n            // Bias towards p1 is to keep the choice stable in the face of uniform superpositions and noise.\n            p1.z*1.001 >= p2.z ? p1.y : p2.y,\n            p1.z + p2.z,\n            0.0);\n    }"),E=new z("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        vec4 polar = texture2D(inputTexture, toUv(state));\n        float mag = sqrt(polar.x);\n        gl_FragColor = vec4(mag * cos(polar.y), mag * sin(polar.y), polar.z, 0.0);\n    }"),F=new z("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform vec2 repSize;\n    uniform sampler2D inputTexture;\n    uniform sampler2D repTexture;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n    vec2 toUvRep(float state) {\n        state = mod(state, repSize.x*repSize.y);\n        return vec2(mod(state, repSize.x) + 0.5, floor(state / repSize.x) + 0.5) / repSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        vec2 val = texture2D(inputTexture, toUv(state)).xy;\n        vec2 rep = texture2D(repTexture, toUvRep(state)).xy;\n        gl_FragColor = vec4(val.x, val.y, rep.x, rep.y);\n    }"),G=new z("\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform float bit;\n\n    bool isNaN(float val) {\n        return val < 0.0 || 0.0 < val || val == 0.0 ? false : true;\n    }\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n    vec2 mul(vec2 c1, vec2 c2) {\n        return vec2(c1.x*c2.x - c1.y*c2.y, c1.x*c2.y + c1.y*c2.x);\n    }\n    vec4 mergeRatios(vec4 a, vec4 b) {\n        vec2 c1 = mul(a.xy, b.zw);\n        vec2 c2 = mul(a.zw, b.xy);\n        vec2 d = c1 - c2;\n        float nan = 0.0*d.x/0.0;\n        float err = dot(d, d);\n        // The max up-scaling controls a tricky tradeoff between noisy false positives and blurry false negatives.\n        err /= max(0.00000000001, min(abs(dot(c1, c1)), abs(dot(c2,c2))));\n        float m1 = dot(a,a);\n        float m2 = dot(b,b);\n        return isNaN(err) || err > 0.001 ? vec4(nan, nan, nan, nan)\n            : m1 >= m2 ? a\n            : b;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float s1 = mod(state, bit) + floor(state/bit)*2.0*bit;\n        float s2 = s1 + bit;\n        vec4 v1 = texture2D(inputTexture, toUv(s1));\n        vec4 v2 = texture2D(inputTexture, toUv(s2));\n\n        gl_FragColor = mergeRatios(v1, v2);\n    }"),H=p.makeDisplayDrawer(function(a){
var b=a.gate.height,c=a.customStats||{probabilities:void 0,superposition:t.zero(1<<b,1<<b).times(NaN)},d=c.probabilities,e=c.superposition,f=d||e,g=void 0===e,h=a.rect.w-a.rect.h*f.width()/f.height(),i=a.rect.skipLeft(h/2).skipRight(h/2);
s.paintMatrix(a.painter,f,i,l.SUPERPOSITION_MID_COLOR,"black",l.SUPERPOSITION_FORE_COLOR,l.SUPERPOSITION_BACK_COLOR,g?"transparent":"black");
var k=function(a){return(a>=0?"+":"")+a.toFixed(2)};g?s.paintMatrixTooltip(a.painter,f,i,a.focusPoints,function(b,c){return"Chance of |"+x.bin(c*f.width()+b,a.gate.height)+"⟩ [amplitude not defined]";
},function(a,b,c){return"raw: "+(100*c.norm2()).toFixed(4)+"%, log: "+(10*Math.log10(c.norm2())).toFixed(1)+" dB"},function(a,b,c){
return"[entangled with other qubits]"}):s.paintMatrixTooltip(a.painter,f,i,a.focusPoints,function(b,c){return"Amplitude of |"+x.bin(c*f.width()+b,a.gate.height)+"⟩";
},function(a,b,c){return"val:"+c.toString(new r(!1,0,5,", "))},function(a,b,c){return"mag²:"+(100*c.norm2()).toFixed(4)+"%, phase:"+k(180*c.phase()/Math.PI)+"°";
}),j(a,g)}),I=o.generateFamily(1,8,k),J=I;return{get default(){return J},get AmplitudeDisplayFamily(){return I},get amplitudesToPolarKets(){
return c},get pipelineToSpreadLengthAcrossPolarKets(){return d},get pipelineToAggregateRepresentativePolarKet(){return e},get convertAwayFromPolar(){
return f},get toRatiosVsRepresentative(){return g},get pipelineToFoldConsistentRatios(){return h},get pipelineToSumAll(){return i;
}}}),$traceurRuntime.registerModule("src/gates/ArithmeticGates.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/ArithmeticGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/ArithmeticGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/ArithmeticGates.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/ArithmeticGates.js"))["default"],e={},f=e,g=function(a){
return d.generate(1<<a,1<<a,function(b,c){return(b-1&(1<<a)-1)===c?1:0})},h=function(a){return d.generate(1<<a,1<<a,function(b,c){
return(b+1&(1<<a)-1)===c?1:0})},i=function(a){return d.generate(1<<a,1<<a,function(b,c){var d=b,e=c,f=Math.floor(a/2),g=Math.ceil(a/2),h=e&(1<<f)-1,i=e>>f;
i+=h,i&=(1<<g)-1;var j=h+(i<<f);return d===j?1:0})},j=function(a){return d.generate(1<<a,1<<a,function(b,c){var d=b,e=c,f=Math.floor(a/2),g=Math.ceil(a/2),h=e&(1<<f)-1,i=e>>f;
i-=h,i&=(1<<g)-1;var j=h+(i<<f);return d===j?1:0})};return e.IncrementFamily=a.generateFamily(1,16,function(b){return a.withoutKnownMatrix("+1","Increment Gate","Adds 1 to the little-endian number represented by a block of qubits.").markedAsOnlyPermutingAndPhasing().markedAsStable().withKnownMatrix(b>=4?void 0:g(b)).withSerializedId("inc"+b).withHeight(b).withCustomShader(function(a,d,e){
return c.increment(a,d,e,b,1)})}),e.DecrementFamily=a.generateFamily(1,16,function(b){return a.withoutKnownMatrix("-1","Decrement Gate","Subtracts 1 from the little-endian number represented by a block of qubits.").markedAsOnlyPermutingAndPhasing().markedAsStable().withKnownMatrix(b>=4?void 0:h(b)).withSerializedId("dec"+b).withHeight(b).withCustomShader(function(a,d,e){
return c.increment(a,d,e,b,-1)})}),e.AdditionFamily=a.generateFamily(2,16,function(d){return a.withoutKnownMatrix("b+=a","Addition Gate","Adds a little-endian number into another.").markedAsOnlyPermutingAndPhasing().markedAsStable().withKnownMatrix(d>=5?void 0:i(d)).withSerializedId("add"+d).withCustomDrawer(b.SECTIONED_DRAWER_MAKER(["a","b+=a"],[Math.floor(d/2)/d])).withHeight(d).withCustomShader(function(a,b,e){
return c.addition(a,b,e,Math.floor(d/2),Math.ceil(d/2),1)})}),e.SubtractionFamily=a.generateFamily(2,16,function(d){return a.withoutKnownMatrix("b-=a","Subtraction Gate","Subtracts a little-endian number from another.").markedAsOnlyPermutingAndPhasing().markedAsStable().withKnownMatrix(d>=5?void 0:j(d)).withSerializedId("sub"+d).withCustomDrawer(b.SECTIONED_DRAWER_MAKER(["a","b-=a"],[Math.floor(d/2)/d])).withHeight(d).withCustomShader(function(a,b,e){
return c.addition(a,b,e,Math.floor(d/2),Math.ceil(d/2),-1)})}),e.all=$traceurRuntime.spread(e.IncrementFamily.all,e.DecrementFamily.all,e.AdditionFamily.all,e.SubtractionFamily.all),
{get default(){return f}}}),$traceurRuntime.registerModule("src/gates/BlochSphereDisplay.js",[],function(){"use strict";function a(a,b,c,d,e,f){
var h=b.center(),i=Math.min(b.w,b.h)/2;if(!f.every(function(a){return a.distanceTo(h)>=i})){var j=2*Math.PI,k=function(a){return(a>=0?"+":"")+(360*a/j).toFixed(2)+"°";
},l=function(a){return(a>=0?"+":"")+a.toFixed(4)},m=Math.sqrt(c*c+d*d+e*e),n=Math.atan2(d,-c),o=Math.atan2(-e,Math.sqrt(d*d+c*c));
a.strokeCircle(h,i,"orange",2),g.paintDeferredValueTooltip(a,h.x+i*Math.sqrt(.5),h.y-i*Math.sqrt(.5),"Bloch sphere representation of local state","r:"+l(m)+", ϕ:"+k(n)+", θ:"+k(o),"x:"+l(-c)+", y:"+l(d)+", z:"+l(-e));
}}function b(a,b,c,d,e,f){var g,i,j=e.center(),k=Math.min(e.w,e.h)/2,l=[new h(-k,0),new h(k/3,-k/3),new h(0,k)],m=(g=l[Symbol.iterator](),
(i=g.next()).done?void 0:i.value),n=(i=g.next()).done?void 0:i.value,o=(i=g.next()).done?void 0:i.value,p=j.plus(m.times(b)).plus(n.times(c)),q=p.plus(o.times(d)),r=4/(1+c/8),s=j.plus(o.times(d));
a.strokePolygon([s,j,p,q],"#666"),a.strokeLine(j,q,"black",2),a.fillCircle(q,r,f),a.ctx.save(),a.ctx.globalAlpha*=Math.min(1,Math.max(0,1-b*b-c*c-d*d)),
a.fillCircle(q,r,"yellow"),a.ctx.restore(),a.strokeCircle(q,r,"black"),a.ctx.save(),a.ctx.globalAlpha*=Math.min(1,Math.max(0,.5+5*c)),
a.strokeLine(j,q,"black",2),a.ctx.restore()}function c(c,e,f){var g,i,j,k,l,m,n,o=void 0!==arguments[3]?arguments[3]:[],p=void 0!==arguments[4]?arguments[4]:d.DISPLAY_GATE_BACK_COLOR,q=void 0!==arguments[5]?arguments[5]:d.DISPLAY_GATE_FORE_COLOR,r=f.center(),s=Math.min(f.w,f.h)/2,t=[new h(-s,0),new h(s/3,-s/3),new h(0,s)],u=(g=t[Symbol.iterator](),
(i=g.next()).done?void 0:i.value),v=(i=g.next()).done?void 0:i.value,w=(i=g.next()).done?void 0:i.value;c.fillCircle(r,s,p),c.trace(function(a){
a.circle(r.x,r.y,s),a.ellipse(r.x,r.y,u.x,v.y),a.ellipse(r.x,r.y,v.x,w.y);var b=!0,c=!1,d=void 0;try{for(var e=void 0,f=[u,v,w][Symbol.iterator]();!(b=(e=f.next()).done);b=!0){
var g=e.value;a.line(r.x-g.x,r.y-g.y,r.x+g.x,r.y+g.y)}}catch(h){c=!0,d=h}finally{try{b||null==f["return"]||f["return"]()}finally{
if(c)throw d}}}).thenStroke("#BBB");var x=[NaN,NaN,NaN],y=(j=x[Symbol.iterator](),(k=j.next()).done?void 0:k.value),z=(k=j.next()).done?void 0:k.value,A=(k=j.next()).done?void 0:k.value;
e.hasNaN()?c.printParagraph("NaN",f,new h(.5,.5),"red"):(l=e.qubitDensityMatrixToBlochVector(),m=l[Symbol.iterator](),y=(n=m.next()).done?void 0:n.value,
z=(n=m.next()).done?void 0:n.value,A=(n=m.next()).done?void 0:n.value,l,b(c,y,z,A,f,q)),a(c,f,y,z,A,o)}var d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/BlochSphereDisplay.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/BlochSphereDisplay.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/BlochSphereDisplay.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/gates/BlochSphereDisplay.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/BlochSphereDisplay.js"))["default"],i=e.fromIdentity("Bloch","Bloch Sphere Display","Shows a wire's local state as a point on the Bloch Sphere.\nUse controls to see conditional states.").withCustomDrawer(f.makeDisplayDrawer(function(a){
var b=a.positionInCircuit,d=b.row,e=b.col,f=a.stats.qubitDensityMatrix(d,e);c(a.painter,f,a.rect,a.focusPoints)})),j=i;return{get default(){
return j},get paintBlochSphereDisplay(){return c},get BlochSphereDisplay(){return i}}}),$traceurRuntime.registerModule("src/gates/Controls.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/Controls.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/Controls.js"))["default"],c={},d=c;
return c.Control=a.fromIdentity("•","Control","Conditions on a qubit being ON.\nGates in the same column will only apply to states meeting the condition.").withCustomDrawer(function(a){
(a.isInToolbox||a.isHighlighted)&&b.DEFAULT_DRAWER(a),a.painter.fillCircle(a.rect.center(),5,"black")}),c.AntiControl=a.fromIdentity("◦","Anti-Control","Conditions on a qubit being OFF.\nGates in the same column will only apply to states meeting the condition.").withCustomDrawer(function(a){
(a.isInToolbox||a.isHighlighted)&&b.DEFAULT_DRAWER(a);var c=a.rect.center();a.painter.fillCircle(c,5),a.painter.strokeCircle(c,5);
}),c.all=[c.Control,c.AntiControl],{get default(){return d}}}),$traceurRuntime.registerModule("src/gates/CountingGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/CountingGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/CountingGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/CountingGates.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/CountingGates.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/CountingGates.js"))["default"],f={},g=f,h=function(a){
for(var b=[],c=0;a>c;c++){var d=c/a,f=c/(a-1);b.push(new e(d,f)),b.push(new e(d+1/a,f))}return b},i=function(a,c){var d=void 0!==arguments[2]?arguments[2]:!1;
return function(f){var g,i,j,k,l;if(b.DEFAULT_DRAWER(f),!f.isInToolbox||f.isHighlighted){var m=(f.stats.time+a)%1,n=f.rect.y+3,o=f.rect.bottom(),p=f.rect.bottom()-3;
d&&(j=[p,n],k=j[Symbol.iterator](),n=(l=k.next()).done?void 0:l.value,p=(l=k.next()).done?void 0:l.value,j,o=f.rect.y);var q=f.rect.x,r=f.rect.right(),s=function(a){
return Math.min(Math.max(q+(r-q)*a,q),r)},t=function(a){return p+(n-p)*a},u=[];u.push(new e(q,o)),(g=u).push.apply(g,$traceurRuntime.spread(h(c).map(function(a){
return new e(s(a.x-m),t(a.y))}))),(i=u).push.apply(i,$traceurRuntime.spread(h(c).map(function(a){return new e(s(a.x+1-m),t(a.y))}))),
u.push(new e(r,o)),f.painter.ctx.save(),f.painter.ctx.globalAlpha*=.3,f.painter.fillPolygon(u,"yellow");for(var v=1;v<u.length-2;v++)f.painter.strokeLine(u[v],u[v+1],"black");
2===c&&.5>m&&(f.painter.fillRect(f.rect,"white"),f.painter.fillRect(f.rect,"white"),f.painter.fillRect(f.rect,"white")),f.painter.ctx.restore();
}}},j=function(a){return function(b){return d.generate(1<<a,1<<a,function(c,d){return(c-Math.floor(b*(1<<a))&(1<<a)-1)===d?1:0})};
},k=function(a){return function(b){return d.generate(1<<a,1<<a,function(c,d){return(c+Math.floor(b*(1<<a))&(1<<a)-1)===d?1:0})}};return f.ClockPulseGate=a.fromVaryingMatrix("X^⌈t⌉",function(a){
return.5>a%1?d.identity(2):d.PAULI_X},"Clock Pulse Gate","Xors a square wave into the target wire.").withCustomDrawer(i(0,2)).withStableDuration(.5),
f.QuarterPhaseClockPulseGate=a.fromVaryingMatrix("X^⌈t-¼⌉",function(a){return.5>(a+.75)%1?d.identity(2):d.PAULI_X},"Clock Pulse Gate (Quarter Phase)","Xors a quarter-phased square wave into the target wire.").withCustomDrawer(i(.75,2)).withStableDuration(.25),
f.CountingFamily=a.generateFamily(1,8,function(b){return a.withoutKnownMatrix("(+1)^⌈t⌉","Counting Gate","Adds an increasing little-endian count into a block of qubits.").markedAsOnlyPermutingAndPhasing().markedAsStable().withKnownMatrixFunc(b>=4?void 0:j(b)).withSerializedId("Counting"+b).withCustomDrawer(i(0,1<<b)).withHeight(b).withStableDuration(1/(1<<b)).withCustomShader(function(a,d,e,f){
return c.increment(a,d,e,b,Math.floor(f*(1<<b)))})}),f.UncountingFamily=a.generateFamily(1,8,function(b){return a.withoutKnownMatrix("(-1)^⌈t⌉","Down Counting Gate","Subtracts an increasing little-endian count from a block of qubits.").markedAsOnlyPermutingAndPhasing().markedAsStable().withKnownMatrixFunc(k(b)).withSerializedId("Uncounting"+b).withCustomDrawer(i(0,1<<b,!0)).withHeight(b).withStableDuration(1/(1<<b)).withCustomShader(function(a,d,e,f){
return c.increment(a,d,e,b,-Math.floor(f*(1<<b)))})}),f.all=$traceurRuntime.spread([f.ClockPulseGate,f.QuarterPhaseClockPulseGate],f.CountingFamily.all,f.UncountingFamily.all),
{get default(){return g}}}),$traceurRuntime.registerModule("src/gates/CycleBitsGates.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/CycleBitsGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/CycleBitsGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/gates/CycleBitsGates.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/gates/CycleBitsGates.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/gates/CycleBitsGates.js")),f=e.WglConfiguredShader,g=e.WglShader,h={},i=function(a,b,e,g,h){
return new f(function(f){j.withArgs(d.texture("inputTexture",a,0),d.texture("controlTexture",b,1),d["float"]("outputWidth",f.width),d.vec2("inputSize",a.width,a.height),d["float"]("qubitIndex",1<<e),d["float"]("qubitSpan",1<<g),d["float"]("shiftAmount",1<<c.properMod(-h,g))).renderTo(f);
})},j=new g("\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float shiftAmount;\n    uniform float qubitIndex;\n    uniform float qubitSpan;\n\n    vec2 uvFor(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float val = mod(floor(state / qubitIndex), qubitSpan);\n        float newVal = val * shiftAmount;\n        newVal = mod(newVal, qubitSpan) + floor(newVal / qubitSpan);\n        float newState = state + (newVal - val) * qubitIndex;\n\n        vec2 oldUv = uvFor(state);\n        float control = texture2D(controlTexture, oldUv).x;\n\n        vec2 newUv = uvFor(newState);\n        vec2 usedUv = control*newUv + (1.0-control)*oldUv;\n\n        gl_FragColor = texture2D(inputTexture, usedUv);\n    }"),k=function(a,d){
return b.generate(1<<d,1<<d,function(b,e){a=c.properMod(a,d);var f=b,g=e,h=g<<a;return h=h&(1<<d)-1|h>>d,f===h?1:0})};h.CycleBitsFamily=a.generateFamily(2,16,function(b){
return a.withoutKnownMatrix("<<1","Bit Cycle Gate","Swaps bits in a cycle.").markedAsStable().markedAsOnlyPermutingAndPhasing().withKnownMatrix(b>=4?void 0:k(1,b)).withSerializedId("__unstable__<<1_"+b).withHeight(b).withCustomShader(function(a,c,d){
return i(a,c,d,b,1)})}),h.ReverseCycleBitsFamily=a.generateFamily(2,16,function(b){return a.withoutKnownMatrix(">>1","Bit Cycle Gate","Swaps bits in a cycle.").markedAsStable().markedAsOnlyPermutingAndPhasing().withKnownMatrix(b>=4?void 0:k(-1,b)).withSerializedId("__unstable__>>1_"+b).withHeight(b).withCustomShader(function(a,c,d){
return i(a,c,d,b,-1)})}),h.all=$traceurRuntime.spread(h.CycleBitsFamily.all,h.ReverseCycleBitsFamily.all);var l=h;return{get default(){
return l},get CycleBitsGates(){return h},get cycleBits(){return i}}}),$traceurRuntime.registerModule("src/gates/Debug_ErrorInjectionGate.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/gates/Debug_ErrorInjectionGate.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/Debug_ErrorInjectionGate.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/Debug_ErrorInjectionGate.js"))["default"],d=b.withoutKnownMatrix("ERR!","Error Injection Gate","Throws an exception during circuit stat computations, for testing error paths.").markedAsStable().withCustomShader(function(b,c,d){
throw new a("Applied an Error Injection Gate",{qubit:d})}).withSerializedId("__error__").withCustomDrawer(c.MAKE_HIGHLIGHTED_DRAWER("red","red")),e=d;
return{get default(){return e}}}),$traceurRuntime.registerModule("src/gates/DensityMatrixDisplayFamily.js",[],function(){"use strict";
function a(a,b,c,d,g){var h=new m,j=o.numberOfSetBits(c.inclusionMask),k=o.numberOfSetBits(c.inclusionMask&(1<<d)-1);a>>=Math.floor(j/2),
b>>=Math.ceil(j/2),h.addSizedStep(a,b,function(a){return e.controlSelect(c,a)}),h.addSizedStep(a,b,function(a){return i.cycleAllBits(a,k-d);
}),a<<=Math.floor(g/2),b<<=Math.ceil(g/2),b>a&&(a<<=1,b>>=1),h.addSizedStep(a,b,function(a){return f.amplitudesToDensities(a,g)});
for(var l=Math.round(Math.log2(a*b)),p=Math.round(Math.log2(a*b));p>2*g;p--)b>1?(b>>=1,h.addSizedStep(a,b,function(a){return function(b){
return n.sumFold(b,0,a)}}(b))):(a>>=1,h.addSizedStep(a,b,function(a){return function(b){return n.sumFold(b,a,0)}}(a))),l-=1;return h;
}function b(a,b){if(0===b)return a;for(var c=new Float32Array(a.rawBuffer()),d=a.width(),e=0;d>e;e++)for(var f=0;d>f;f++)if(0!==((e^f)&b)){
var g=2*(e*d+f);c[g]=0,c[g+1]=0}return new k(d,d,c)}function c(a,c,d,e){for(var f=a.length/4,g=Math.round(Math.sqrt(f)),h=0,i=0;g>i;i++)h+=a[4*i*(g+1)];
if(isNaN(h)||1e-6>h)return k.zero(g,g).times(NaN);for(var j=new Float32Array(g*g*2),l=0;l<j.length;l++)j[2*l]=a[4*l]/h,j[2*l+1]=a[4*l+1]/h;
var m=c.colIsMeasuredMask(d)>>e;return b(new k(g,g,j),m)}function d(b){return g.fromIdentity("Density","Density Matrix Display","Shows the density matrix of the local mixed state of some wires.\nUse controls to see conditional states.").withSerializedId("Density"+b).withWidth(b).withHeight(b).withCustomDrawer(p).withCustomStatPipelineMaker(function(c,d,e,f){
return a(d.width,d.height,f,e,b)}).withCustomStatPostProcessor(c)}var e=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitShaders.js","src/gates/DensityMatrixDisplayFamily.js"))["default"]),f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/DisplayShaders.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],l=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/gates/DensityMatrixDisplayFamily.js"))),m=(l.seq,
l.Seq,$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/ShaderPipeline.js","src/gates/DensityMatrixDisplayFamily.js"))["default"]),n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/gates/DensityMatrixDisplayFamily.js"))["default"],p=h.makeDisplayDrawer(function(a){
var b=a.gate.height,c=a.customStats||k.zero(1<<b,1<<b).times(NaN);j.paintDensityMatrix(a.painter,c,a.rect,a.focusPoints)}),q=g.fromIdentity("Density","Density Matrix Display","Shows the density matrix of the local mixed state of some wires.\nUse controls to see conditional states.").withSerializedId("Density").withCustomDrawer(h.makeDisplayDrawer(function(a){
var b=a.positionInCircuit,c=b.row,d=b.col,e=a.stats.qubitDensityMatrix(c,d);j.paintDensityMatrix(a.painter,e,a.rect,a.focusPoints);
})),r=g.fromIdentity("Density","Density Matrix Display","Shows the density matrix of the local mixed state of some wires.\nUse controls to see conditional states.").withSerializedId("Density2").withWidth(2).withHeight(2).withCustomDrawer(h.makeDisplayDrawer(function(a){
var b=a.positionInCircuit,c=b.row,d=b.col,e=a.stats.qubitPairDensityMatrix(c,d);j.paintDensityMatrix(a.painter,e,a.rect,a.focusPoints);
})),s=g.generateFamily(1,5,function(a){return 1===a?q:2===a?r:d(a)}),t=s;return{get default(){return t}}}),$traceurRuntime.registerModule("src/gates/ExponentiatingGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/ExponentiatingGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/ExponentiatingGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/ExponentiatingGates.js"))["default"],d={},e=d,f=2*Math.PI,g=function(a){
var b=Math.cos(f*a),d=Math.sin(f*a);return new c(2,2,new Float32Array([b,0,0,-d,0,-d,b,0]))},h=function(a){var b=Math.cos(f*a),d=Math.sin(f*a);
return new c(2,2,new Float32Array([b,0,-d,0,d,0,b,0]))},i=function(a){var b=Math.cos(f*a),d=Math.sin(f*a);return new c(2,2,new Float32Array([b,-d,0,0,0,0,b,d]));
};return d.XForward=a.fromVaryingMatrix("e^-iXt",g,"X-Exponentiating Gate (forward)","A continuous right-handed rotation around the X axis.\nPasses through ±iX instead of X.").withCustomDrawer(b.makeCycleDrawer(.5,1,2)),
d.XBackward=a.fromVaryingMatrix("e^iXt",function(a){return g(-a)},"X-Exponentiating Gate (backward)","A continuous left-handed rotation around the X axis.\nPasses through ±iX instead of X.").withCustomDrawer(b.makeCycleDrawer(-.5,1,2)),
d.YForward=a.fromVaryingMatrix("e^-iYt",h,"Y-Exponentiating Gate (forward)","A continuous right-handed rotation around the Y axis.\nPasses through ±iY instead of Y.").withCustomDrawer(b.makeCycleDrawer(-1,1,2)),
d.YBackward=a.fromVaryingMatrix("e^iYt",function(a){return h(-a)},"Y-Exponentiating Gate (backward)","A continuous left-handed rotation around the Y axis.\nPasses through ±iY instead of Y.").withCustomDrawer(b.makeCycleDrawer(1,1,2)),
d.ZForward=a.fromVaryingMatrix("e^-iZt",i,"Z-Exponentiating Gate (forward)","A continuous right-handed rotation around the Z axis.\nPasses through ±iZ instead of Z.").markedAsOnlyPhasing().withCustomDrawer(b.makeCycleDrawer(1,.5,2)),
d.ZBackward=a.fromVaryingMatrix("e^iZt",function(a){return i(-a)},"Z-Exponentiating Gate (backward)","A continuous left-handed rotation around the Z axis.\nPasses through ±iZ instead of Z.").markedAsOnlyPhasing().withCustomDrawer(b.makeCycleDrawer(-1,.5,2)),
d.all=[d.XBackward,d.YBackward,d.ZBackward,d.XForward,d.YForward,d.ZForward],{get default(){return e}}}),$traceurRuntime.registerModule("src/gates/FourierTransformGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitShaders.js","src/gates/FourierTransformGates.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/FourierTransformGates.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/gates/FourierTransformGates.js"))["default"]),c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/FourierTransformGates.js"))["default"],d=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/FourierTransformGates.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/FourierTransformGates.js"))["default"]),e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/gates/FourierTransformGates.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/gates/FourierTransformGates.js")),g=(f.seq,
f.Seq),h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/gates/FourierTransformGates.js")),i=h.WglConfiguredShader,j=h.WglShader,k=function(a,b,c,d){
return new i(function(f){l.withArgs(e.texture("inputTexture",a,0),e.texture("controlTexture",b,1),e["float"]("outputWidth",f.width),e.vec2("inputSize",a.width,a.height),e["float"]("qubitIndex",1<<c),e["float"]("stepIndex",1<<d)).renderTo(f);
})},l=new j("\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float qubitIndex;\n    uniform float stepIndex;\n\n    vec2 toUv(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float targetIndex = qubitIndex * stepIndex;\n        float bit = mod(floor(state / targetIndex), 2.0);\n        float state0 = state - bit*targetIndex;\n        float state1 = state0 + targetIndex;\n\n        float control = texture2D(controlTexture, toUv(state)).x;\n        vec2 amp0 = texture2D(inputTexture, toUv(state0)).xy;\n        vec2 amp1 = texture2D(inputTexture, toUv(state1)).xy;\n\n        float phase1 = -mod(floor(state / qubitIndex), stepIndex) * 3.141592653589793 / stepIndex;\n        float c = cos(phase1);\n        float s = sin(phase1);\n        mat2 rot = mat2(c,-s,\n                        s, c);\n        vec2 phasedAmp1 = rot*amp1;\n\n        vec2 outAmp = (amp0 + phasedAmp1*(1.0-bit*2.0))*sqrt(0.5);\n        vec2 inAmp = bit*amp1 + (1.0-bit)*amp0;\n        vec2 amp = control*outAmp + (1.0-control)*inAmp;\n        gl_FragColor = vec4(amp.x, amp.y, 0.0, 0.0);\n    }"),m=2*Math.PI,n=function(a){
return d.generate(1<<a,1<<a,function(c,d){return b.polar(Math.pow(.5,a/2),m*c*d/(1<<a))})},o={};o.FourierTransformFamily=c.generateFamily(1,16,function(b){
return c.withoutKnownMatrix("QFT","Fourier Transform Gate","Transforms to/from phase frequency space.").markedAsStable().withKnownMatrix(b>=4?void 0:n(b)).withSerializedId("QFT"+b).withHeight(b).withCustomShaders(g.range(Math.floor(b/2)).map(function(c){
return function(d,e,f){return a.swap(d,f+c,f+b-c-1,e)}}).concat(g.range(b).map(function(a){return function(b,c,d){return k(b,c,d,a);
}})).toArray())}),o.all=$traceurRuntime.spread(o.FourierTransformFamily.all);var p=o;return{get default(){return p},get fourierTransformStep(){
return k},get FourierTransformGates(){return o}}}),$traceurRuntime.registerModule("src/gates/HalfTurnGates.js",[],function(){"use strict";
function a(a){var b=void 0!==a.positionInCircuit&&a.stats.circuitDefinition.colHasSingleWireControl(a.positionInCircuit.col),d=void 0!==a.positionInCircuit&&a.stats.circuitDefinition.colHasDoubleWireControl(a.positionInCircuit.col);
if(!b&&!d||a.isHighlighted)return void c.DEFAULT_DRAWER(a);var f=a.rect.scaledOutwardBy(.6);a.painter.fillCircle(f.center(),f.w/2),
a.painter.strokeCircle(f.center(),f.w/2),b&&a.painter.strokeLine(f.topCenter(),f.bottomCenter()),d&&(a.painter.strokeLine(f.topCenter().offsetBy(-1,0),f.bottomCenter().offsetBy(-1,0)),
a.painter.strokeLine(f.topCenter().offsetBy(1,0),f.bottomCenter().offsetBy(1,0)));var g=a.stats.circuitDefinition.locIsMeasured(new e(a.positionInCircuit.col,a.positionInCircuit.row));
g?(a.painter.strokeLine(f.centerLeft().offsetBy(0,-1),f.centerRight().offsetBy(0,-1)),a.painter.strokeLine(f.centerLeft().offsetBy(0,1),f.centerRight().offsetBy(0,1))):a.painter.strokeLine(f.centerLeft(),f.centerRight());
}var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/HalfTurnGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/HalfTurnGates.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/HalfTurnGates.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/HalfTurnGates.js"))["default"],f={},g=f;
return f.X=b.fromKnownMatrix("X",d.PAULI_X,"Pauli X Gate","The NOT gate.\nToggles between ON and OFF.").withCustomDrawer(a),f.Y=b.fromKnownMatrix("Y",d.PAULI_Y,"Pauli Y Gate","A combination of the X and Z gates."),
f.Z=b.fromKnownMatrix("Z",d.PAULI_Z,"Pauli Z Gate","The phase flip gate.\nNegates phases when the qubit is ON."),f.H=b.fromKnownMatrix("H",d.HADAMARD,"Hadamard Gate","Creates simple superpositions.\nMaps ON to ON + OFF.\nMaps OFF to ON - OFF."),
f.all=[f.X,f.Y,f.Z,f.H],{get default(){return g}}}),$traceurRuntime.registerModule("src/gates/Impossible_UniversalNotGate.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/Impossible_UniversalNotGate.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/Impossible_UniversalNotGate.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/gates/Impossible_UniversalNotGate.js"))["default"]),c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/gates/Impossible_UniversalNotGate.js")),d=c.WglConfiguredShader,e=c.WglShader,f=function(a,c,e){
return new d(function(d){g.withArgs(b.texture("inputTexture",a,0),b.texture("controlTexture",c,1),b["float"]("outputWidth",d.width),b.vec2("inputSize",a.width,a.height),b["float"]("bit",1<<e)).renderTo(d);
})},g=new e("\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float bit;\n\n    vec2 uvFor(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float hasBit = mod(floor(state / bit), 2.0);\n        float partnerState = state + bit * (1.0 - 2.0 * hasBit);\n        vec2 uv = uvFor(state);\n        vec2 partnerUv = uvFor(partnerState);\n\n        float control = texture2D(controlTexture, uv).x;\n        vec2 val = vec4(texture2D(inputTexture, uv)).xy;\n        vec2 partnerVal = vec4(texture2D(inputTexture, partnerUv)).xy;\n        vec2 outUncontrolled = vec2(partnerVal.x, -partnerVal.y) * (1.0 - 2.0 * hasBit);\n        vec2 outVal = (1.0 - control) * val + control * outUncontrolled;\n        gl_FragColor = vec4(outVal.x, outVal.y, 0.0, 0.0);\n    }"),h=a.withoutKnownMatrix("UniNot","Universal Not Gate","Mirrors a qubit's state through the origin of the Bloch sphere.\nImpossible in practice.").markedAsStable().withCustomShader(f).withSerializedId("__unstable__UniversalNot"),i=h;
return{get default(){return i},get universalNot(){return f},get UniversalNotGate(){return h}}}),$traceurRuntime.registerModule("src/gates/Joke_MysteryGate.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/gates/Joke_MysteryGate.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/Joke_MysteryGate.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/Joke_MysteryGate.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/Joke_MysteryGate.js"))["default"],e="?",f=function(a){
return b.fromKnownMatrix(e,a,"Mystery Gate","Every time you grab this gate out of the toolbox, it changes.\nDuplicate gates in the circuit by holding shift before dragging.").withCustomDrawer(c.MATRIX_SYMBOL_DRAWER_EXCEPT_IN_TOOLBOX);
},g=function(){return f(d.square(new a(Math.random()-.5,Math.random()-.5),new a(Math.random()-.5,Math.random()-.5),new a(Math.random()-.5,Math.random()-.5),new a(Math.random()-.5,Math.random()-.5)).closestUnitary());
};return{get MysteryGateSymbol(){return e},get MysteryGateMaker(){return g},get MysteryGateMakerWithMatrix(){return f}}}),$traceurRuntime.registerModule("src/gates/MeasurementGate.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/MeasurementGate.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/MeasurementGate.js"))["default"],c=b.fromIdentity("Measure","Measurement Gate","Measures a wire's qubit, along the Z axis.").withCustomDrawer(function(b){
var c,d,e,f,g=a.GATE_FILL_COLOR;b.isHighlighted&&(g=a.HIGHLIGHTED_GATE_FILL_COLOR),b.painter.fillRect(b.rect,g),b.painter.strokeRect(b.rect);
var h=2*Math.PI,i=.4*b.rect.w,j=b.rect.center(),k=j.x,l=j.y;l+=.6*i;var m=-h/6,n=[Math.cos(m)*i*1.5,Math.sin(m)*i*1.5],o=(c=n[Symbol.iterator](),
(d=c.next()).done?void 0:d.value),p=(d=c.next()).done?void 0:d.value,q=[k+o,l+p],r=(e=q[Symbol.iterator](),(f=e.next()).done?void 0:f.value),s=(f=e.next()).done?void 0:f.value;
b.painter.trace(function(a){a.ctx.arc(k,l,i,h/2,h),a.line(k,l,r,s)}).thenStroke("black"),b.painter.trace(function(a){return a.arrowHead(r,s,.3*i,m,h/4);
}).thenFill("black")}),d=c;return{get default(){return d}}}),$traceurRuntime.registerModule("src/gates/PhaseGradientGates.js",[],function(){
"use strict";function a(a,b,c,d){var f=void 0!==arguments[4]?arguments[4]:1;return new g(function(g){l.withArgs(e.texture("inputTexture",a,0),e.texture("controlTexture",b,1),e["float"]("outputWidth",g.width),e.vec2("inputSize",a.width,a.height),e["float"]("qubitIndex",1<<c),e["float"]("qubitSpan",1<<d),e["float"]("factor",f)).renderTo(g);
})}var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/gates/PhaseGradientGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/PhaseGradientGates.js"))["default"],d=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/PhaseGradientGates.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/PhaseGradientGates.js"))["default"]),e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/gates/PhaseGradientGates.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/gates/PhaseGradientGates.js")),g=f.WglConfiguredShader,h=f.WglShader,i=2*Math.PI,j=function(a){
return d.generate(1<<a,1<<a,function(c,d){return c===d?b.polar(1,i*c/(2<<a)):0})},k=function(a){return d.generate(1<<a,1<<a,function(c,d){
return c===d?b.polar(1,-i*c/(2<<a)):0})},l=new h("\n    uniform sampler2D inputTexture;\n    uniform sampler2D controlTexture;\n    uniform float outputWidth;\n    uniform vec2 inputSize;\n    uniform float qubitIndex;\n    uniform float qubitSpan;\n    uniform float factor;\n\n    vec2 toUv(float state) {\n        return (vec2(mod(state, inputSize.x), floor(state / inputSize.x)) + vec2(0.5, 0.5)) / inputSize;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float step = mod(floor(state / qubitIndex), qubitSpan);\n        float angle = step * factor * 3.141592653589793 / qubitSpan;\n        float c = cos(angle);\n        float s = sin(angle);\n        mat2 rot = mat2(c, s, -s, c);\n\n        vec2 uv = toUv(state);\n        float control = texture2D(controlTexture, uv).x;\n        vec2 inAmp = texture2D(inputTexture, uv).xy;\n        vec2 outAmp = control*(rot*inAmp) + (1.0-control)*inAmp;\n        gl_FragColor = vec4(outAmp.x, outAmp.y, 0.0, 0.0);\n    }"),m={};
m.PhaseGradientFamily=c.generateFamily(1,16,function(b){return c.withoutKnownMatrix("Z^#","Phase Gradient Gate","Phases by an amount proportional to the little endian number represented by a block of qubits.").markedAsOnlyPhasing().markedAsStable().withKnownMatrix(b>=4?void 0:j(b)).withSerializedId("PhaseGradient"+b).withHeight(b).withCustomShader(function(c,d,e){
return a(c,d,e,b)})}),m.PhaseDegradientFamily=c.generateFamily(1,16,function(b){return c.withoutKnownMatrix("Z^-#","Inverse Phase Gradient Gate","Phases by a negative amount proportional to the little endian number represented by a block of qubits.").markedAsOnlyPhasing().markedAsStable().withKnownMatrix(b>=4?void 0:k(b)).withSerializedId("PhaseUngradient"+b).withHeight(b).withCustomShader(function(c,d,e){
return a(c,d,e,b,-1)})}),m.all=$traceurRuntime.spread(m.PhaseGradientFamily.all,m.PhaseDegradientFamily.all);var n=m;return{get default(){
return n},get PhaseGradientGates(){return m},get phaseGradient(){return a}}}),$traceurRuntime.registerModule("src/gates/PostSelectionGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/PostSelectionGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/PostSelectionGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/PostSelectionGates.js"))["default"],d={},e=d,f=function(a){
if(a.isInToolbox||a.isHighlighted?b.DEFAULT_DRAWER(a):(a.painter.fillRect(a.rect,"white"),b.paintGateSymbol(a)),!a.isInToolbox){var c=a.rect,d=c.x,e=c.y,f=c.w,g=c.h;
a.painter.print("post-",d+f/2,e,"center","hanging","red","10px Helvetica",f,g/2),a.painter.print("select",d+f/2,e+g,"center","bottom","red","10px Helvetica",f,g/2);
}};return d.PostSelectOff=a.fromKnownMatrix("|0⟩⟨0|",c.square(1,0,0,0),"Post-selection Gate [Off]","Keeps OFF states, discards ON states, and renormalizes\n(Corresponds to restarting until the right answer happens.)").withCustomDrawer(f),
d.PostSelectOn=a.fromKnownMatrix("|1⟩⟨1|",c.square(0,0,0,1),"Post-selection Gate [On]","Keeps ON states, discards OFF states, and renormalizes.\n(Corresponds to restarting until the right answer happens.)").withCustomDrawer(f),
d.PostSelectPlus=a.fromKnownMatrix("|+⟩⟨+|",c.square(1,1,1,1).times(Math.sqrt(.5)),"Post-selection Gate [+]","Keeps ON+OFF states, discards ON-OFF states, and renormalizes\n(Corresponds to restarting until the right answer happens.)").withCustomDrawer(f),
d.PostSelectMinus=a.fromKnownMatrix("|-⟩⟨-|",c.square(1,-1,-1,1).times(Math.sqrt(.5)),"Post-selection Gate [-]","Keeps ON-OFF states, discards ON+OFF states, and renormalizes\n(Corresponds to restarting until the right answer happens.)").withCustomDrawer(f),
d.all=[d.PostSelectOff,d.PostSelectOn,d.PostSelectPlus,d.PostSelectMinus],{get default(){return e}}}),$traceurRuntime.registerModule("src/gates/PoweringGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/PoweringGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/PoweringGates.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/PoweringGates.js"))["default"],d={},e=d,f=2*Math.PI,g=function(a){
var b=Math.cos(f*a)/2,d=Math.sin(f*a)/2;return new c(2,2,new Float32Array([.5+b,d,.5-b,-d,.5-b,-d,.5+b,d]))},h=function(a){var b=Math.cos(f*a)/2,d=Math.sin(f*a)/2;
return new c(2,2,new Float32Array([.5+b,d,-d,b-.5,d,.5-b,.5+b,d]))},i=function(a){var b=Math.cos(f*a),d=Math.sin(f*a);return new c(2,2,new Float32Array([1,0,0,0,0,0,b,d]));
};return d.XForward=a.fromVaryingMatrix("X^t",g,"X-Raising Gate (forward)","A continuous right-handed cycle between the X gate and no-op.").withCustomDrawer(b.makeCycleDrawer(.5,1)),
d.XBackward=a.fromVaryingMatrix("X^-t",function(a){return g(-a)},"X-Raising Gate (backward)","A continuous left-handed cycle between the X gate and no-op.").withCustomDrawer(b.makeCycleDrawer(-.5,1)),
d.YForward=a.fromVaryingMatrix("Y^t",h,"Y-Raising Gate (forward)","A continuous right-handed cycle between the Y gate and no-op.").withCustomDrawer(b.makeCycleDrawer(-1,1)),
d.YBackward=a.fromVaryingMatrix("Y^-t",function(a){return h(-a)},"Y-Raising Gate (backward)","A continuous left-handed cycle between the Y gate and no-op.").withCustomDrawer(b.makeCycleDrawer(1,1)),
d.ZForward=a.fromVaryingMatrix("Z^t",i,"Z-Raising Gate (forward)","A continuous right-handed cycle between the Z gate and no-op.").markedAsOnlyPhasing().withCustomDrawer(b.makeCycleDrawer(1,.5)),
d.ZBackward=a.fromVaryingMatrix("Z^-t",function(a){return i(-a)},"Z-Raising Gate (backward)","A continuous left-handed cycle between the Z gate and no-op.").markedAsOnlyPhasing().withCustomDrawer(b.makeCycleDrawer(-1,.5)),
d.all=[d.XForward,d.YForward,d.ZForward,d.XBackward,d.YBackward,d.ZBackward],{get default(){return e}}}),$traceurRuntime.registerModule("src/gates/ProbabilityDisplayFamily.js",[],function(){
"use strict";function a(a,b,c){var d,e,f=[a.width,a.height],g=(d=f[Symbol.iterator](),(e=d.next()).done?void 0:e.value),h=(e=d.next()).done?void 0:e.value,i=new t;
i.addSizedStep(g,h,function(b){return k.amplitudesToProbabilities(b,a)}),i.addSizedStep(g,h,function(a){return n.cycleAllBits(a,-b);
});for(var j=Math.round(Math.log2(g*h));j>c;)h>1?(h>>=1,i.addSizedStep(g,h,function(a){return function(b){return u.sumFold(b,0,a);
}}(h))):(g>>=1,i.addSizedStep(g,h,function(a){return function(b){return u.sumFold(b,a,0)}}(g))),j-=1;return i}function b(a){var b=0,c=!0,d=!1,e=void 0;
try{for(var f=void 0,g=a[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;b+=h}}catch(i){d=!0,e=i}finally{try{c||null==g["return"]||g["return"]();
}finally{if(d)throw e}}if(isNaN(b)||1e-6>b)return p.zero(1,a.length>>2).times(NaN);for(var j=new Float32Array(a.length>>1),k=0;k<j.length;k++)j[2*k]=a[4*k]/b;
return new p(1,a.length>>2,j)}function c(a){var b=a,c=b.painter,d=b.rect,e=d.x,f=d.y,g=d.w,h=d.h,i=1<<a.gate.height,k=h/i;c.fillRect(a.rect,j.DISPLAY_GATE_BACK_COLOR);
var l=a.gate.height-5;c.trace(function(a){for(var b=1;i>b;b++)a.line(e,f+k*b,e+g,f+k*b)}).thenStroke("lightgray",0>=l?1:1/l),c.strokeRect(a.rect,"lightgray");
}function d(a){var b=a,c=b.painter,d=b.rect,e=d.x,f=d.y,g=d.w,h=d.h,i=b.customStats,k=1<<a.gate.height,l=h/k;c.ctx.beginPath(),c.ctx.moveTo(e,f);
for(var m=0;k>m;m++){var n=i.rawBuffer()[2*m],o=e+g*n,p=f+l*m;c.ctx.lineTo(o,p),c.ctx.lineTo(o,p+l)}c.ctx.lineTo(e,f+h),c.ctx.lineTo(e,f),
c.ctx.strokeStyle="gray",c.ctx.stroke(),c.ctx.fillStyle=j.DISPLAY_GATE_FORE_COLOR,c.ctx.fill()}function e(a){var b=a,c=b.painter,d=b.rect,e=d.x,f=d.y,g=d.w,h=d.h,i=b.customStats,j=1<<a.gate.height,k=h/j;
c.ctx.beginPath(),c.ctx.moveTo(e,f);for(var l=0;j>l;l++){var m=i.rawBuffer()[2*l],n=e+g*Math.min(1,Math.max(0,1+Math.log(m)/12)),o=f+k*l;
c.ctx.lineTo(n,o),c.ctx.lineTo(n,o+k)}c.ctx.lineTo(e,f+h),c.ctx.strokeStyle="#CCC",c.ctx.stroke()}function f(a){var b=a,c=b.painter,d=b.rect,e=d.x,f=d.y,g=d.w,h=d.h,i=b.customStats,j=1<<a.gate.height,k=h/j,l=!0,m=!1,n=void 0;
try{for(var p=void 0,q=a.focusPoints[Symbol.iterator]();!(l=(p=q.next()).done);l=!0){var s=p.value,t=Math.floor((s.y-f)/k);if(a.rect.containsPoint(s)&&t>=0&&j>t){
var u=void 0===i?NaN:i.rawBuffer()[2*t];c.strokeRect(new r(e,f+t*k,g,k),"orange",2),o.paintDeferredValueTooltip(c,e+g,f+t*k,"Chance of |"+v.bin(t,a.gate.height)+"⟩ if measured","raw: "+(100*u).toFixed(4)+"%","log: "+(10*Math.log10(u)).toFixed(1)+" dB");
}}}catch(w){m=!0,n=w}finally{try{l||null==q["return"]||q["return"]()}finally{if(m)throw n}}}function g(a){for(var b=a,c=b.painter,d=b.rect,e=d.x,f=d.y,g=d.w,h=d.h,i=b.customStats,j=h/i.height(),k=0;k<i.height();k++){
var l=i.rawBuffer()[2*k];c.print((100*l).toFixed(1)+"%",e+g-2,f+j*(k+.5),"right","middle","black","8pt monospace",g-4,j)}}function h(a){
c(a);var b=a.customStats,h=void 0===b||b.hasNaN();if(h)a.painter.printParagraph("NaN",a.rect,new q(.5,.5),"red");else{var i=a.rect.h/b.height()>8;
i||e(a),d(a),i&&g(a)}f(a)}function i(c){return l.fromIdentity("Chance","Probability Display","Shows chances of outcomes if a measurement was performed.\nUse controls to see conditional probabilities.").withHeight(c).withSerializedId("Chance"+c).withCustomStatPipelineMaker(function(b,d,e){
return a(d,e,c)}).withCustomStatPostProcessor(b).withCustomDrawer(m.makeDisplayDrawer(h))}var j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/ProbabilityDisplayFamily.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/DisplayShaders.js","src/gates/ProbabilityDisplayFamily.js"))["default"],l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/ProbabilityDisplayFamily.js"))["default"],m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/ProbabilityDisplayFamily.js"))["default"],n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/ProbabilityDisplayFamily.js"))["default"],o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/gates/ProbabilityDisplayFamily.js"))["default"],p=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/ProbabilityDisplayFamily.js"))["default"],q=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/ProbabilityDisplayFamily.js"))["default"],r=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/gates/ProbabilityDisplayFamily.js"))["default"],s=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/gates/ProbabilityDisplayFamily.js")),t=(s.seq,
s.Seq,$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/ShaderPipeline.js","src/gates/ProbabilityDisplayFamily.js"))["default"]),u=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/gates/ProbabilityDisplayFamily.js"))["default"],v=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/gates/ProbabilityDisplayFamily.js"))["default"],w=l.fromIdentity("Chance","Probability Display","Shows the chance that measuring a wire would return ON.\nUse controls to see conditional probabilities.").withCustomDrawer(m.makeDisplayDrawer(function(a){
var b=a.positionInCircuit,c=b.row,d=b.col;o.paintProbabilityBox(a.painter,a.stats.controlledWireProbabilityJustAfter(c,d),a.rect,a.focusPoints);
})),x=l.generateFamily(1,8,function(a){return 1===a?w:i(a)}),y=x;return{get default(){return y},get makeProbabilitySpanPipeline(){
return a},get probabilityPixelsToColumnVector(){return b}}}),$traceurRuntime.registerModule("src/gates/QuarterTurnGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/QuarterTurnGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/QuarterTurnGates.js"))["default"],c={},d=c;
return c.SqrtXForward=a.fromKnownMatrix("X^½",b.fromPauliRotation(.25,0,0),"√X Gate","Principle square root of Not."),c.SqrtXBackward=a.fromKnownMatrix("X^-½",b.fromPauliRotation(.75,0,0),"X^-½ Gate","Adjoint square root of Not."),
c.SqrtYForward=a.fromKnownMatrix("Y^½",b.fromPauliRotation(0,.25,0),"√Y Gate","Principle square root of Y."),c.SqrtYBackward=a.fromKnownMatrix("Y^-½",b.fromPauliRotation(0,.75,0),"Y^-½ Gate","Adjoint square root of Y."),
c.SqrtZForward=a.fromKnownMatrix("Z^½",b.fromPauliRotation(0,0,.25),"√Z Gate","Principle square root of Z.\nAlso known as the 'S' gate."),
c.SqrtZBackward=a.fromKnownMatrix("Z^-½",b.fromPauliRotation(0,0,.75),"Z^-½ Gate","Adjoint square root of Z."),c.all=[c.SqrtXForward,c.SqrtYForward,c.SqrtZForward,c.SqrtXBackward,c.SqrtYBackward,c.SqrtZBackward],
{get default(){return d}}}),$traceurRuntime.registerModule("src/gates/SampleDisplayFamily.js",[],function(){"use strict";function a(a){
for(var b=a.customStats,c=b.rawBuffer(),d=a.painter.rng.random(),e=b.height(),f=0;;f++){var g=c[2*f];if(d-=g,f===e-1||1e-5>d)return{
i:f,p:g}}}function b(b){for(var c=b,d=c.painter,f=c.rect,g=f.x,i=f.y,k=f.w,m=f.h,n=e.WIRE_SPACING,o=i+m/2-n*b.gate.height/2,p=a(b),q=p.i,r=p.p,s=0;s<b.gate.height;s++){
var t=0!==(q>>s&1);t&&d.fillRect(new j(g,o+n*s+5,k,n-10),e.OPERATION_FORE_COLOR),d.print(t?"on":"off",g+k/2,o+n*(s+.5),"center","middle","black","16px Helvetica",k,n);
}var u=!0,v=!1,w=void 0;try{for(var x=void 0,y=b.focusPoints[Symbol.iterator]();!(u=(x=y.next()).done);u=!0){var z=x.value,A=Math.floor(2*(z.y-i)/n)/2;
b.rect.containsPoint(z)&&h.paintDeferredValueTooltip(d,g+k,i+A*n,"Chance of |"+l.bin(q,b.gate.height)+"⟩",(100*r).toFixed(4)+"%",void 0,e.OPERATION_BACK_COLOR);
}}catch(B){v=!0,w=B}finally{try{u||null==y["return"]||y["return"]()}finally{if(v)throw w}}}function c(a){a.painter.fillRect(a.rect,e.OPERATION_BACK_COLOR);
var c=a.customStats,d=void 0===c||c.hasNaN();d?a.painter.printParagraph("NaN",a.rect,new i(.5,.5),"red"):b(a),a.painter.strokeRect(a.rect,"lightgray");
}function d(a){return f.fromIdentity("Sample","Sampled Results Display","Shows a random sample of possible measurement outcomes.\nUse controls to see conditional samples.").withHeight(a).withSerializedId("Sample"+a).withCustomStatPipelineMaker(function(b,c,d){
return n(c,d,a)}).withCustomStatPostProcessor(o).withCustomDrawer(g.makeDisplayDrawer(c)).withStableDuration(e.SEMI_STABLE_RANDOM_VALUE_LIFETIME_MILLIS/e.CYCLE_DURATION_MS);
}var e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/SampleDisplayFamily.js"))["default"],f=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/DisplayShaders.js","src/gates/SampleDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/SampleDisplayFamily.js"))["default"]),g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/SampleDisplayFamily.js"))["default"],h=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateShaders.js","src/gates/SampleDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/gates/SampleDisplayFamily.js"))["default"]),i=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/SampleDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/gates/SampleDisplayFamily.js"))["default"]),j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/gates/SampleDisplayFamily.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/gates/SampleDisplayFamily.js")),l=(k.seq,
k.Seq,$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/ShaderPipeline.js","src/gates/SampleDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/Shaders.js","src/gates/SampleDisplayFamily.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/gates/SampleDisplayFamily.js"))["default"]),m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/ProbabilityDisplayFamily.js","src/gates/SampleDisplayFamily.js")),n=m.makeProbabilitySpanPipeline,o=m.probabilityPixelsToColumnVector,p=f.generateFamily(1,8,d),q=p;
return{get default(){return q}}}),$traceurRuntime.registerModule("src/gates/SpacerGate.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/gates/SpacerGate.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/SpacerGate.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/gates/SpacerGate.js"))["default"],d=b.fromIdentity("…","Spacer","A gate with no effect.").withCustomDrawer(function(b){
if(b.isInToolbox||b.isHighlighted){var d=a.GATE_FILL_COLOR;b.isHighlighted&&(d=a.HIGHLIGHTED_GATE_FILL_COLOR),b.painter.fillRect(b.rect,d),
b.painter.strokeRect(b.rect)}else{var e=b.rect.center(),f=e.x,g=e.y,h=new c(f-14,g-2,28,4);b.painter.fillRect(h,a.BACKGROUND_COLOR_CIRCUIT);
}b.painter.fillCircle(b.rect.center().offsetBy(7,0),2,"black"),b.painter.fillCircle(b.rect.center(),2,"black"),b.painter.fillCircle(b.rect.center().offsetBy(-7,0),2,"black");
}),e=d;return{get default(){return e}}}),$traceurRuntime.registerModule("src/gates/SwapGateHalf.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/SwapGateHalf.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/gates/SwapGateHalf.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/SwapGateHalf.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/gates/SwapGateHalf.js"))["default"],e=a.fromKnownMatrix("Swap",c.square(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1),"Swap Gate [Half]","Swaps the values of two qubits.\nPlace two swap gate halves in the same column to form a swap gate.").withCustomDrawer(function(a){
if(a.isInToolbox||a.isHighlighted)return void b.DEFAULT_DRAWER(a);var c=d.centeredSquareWithRadius(a.rect.center(),a.rect.w/6);a.painter.strokeLine(c.topLeft(),c.bottomRight()),
a.painter.strokeLine(c.topRight(),c.bottomLeft())}),f=e;return{get default(){return f}}}),$traceurRuntime.registerModule("src/gates/VariousXGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/VariousXGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/VariousXGates.js"))["default"],c={},d=c;
return c.X3=a.fromKnownMatrix("X^⅓",b.fromPauliRotation(1/6,0,0),"X^⅓ Gate","Principle third root of X."),c.X3i=a.fromKnownMatrix("X^-⅓",b.fromPauliRotation(-1/6,0,0),"X^-⅓ Gate","Adjoint third root of X."),
c.X4=a.fromKnownMatrix("X^¼",b.fromPauliRotation(1/8,0,0),"X^¼ Gate","Principle fourth root of X."),c.X4i=a.fromKnownMatrix("X^-¼",b.fromPauliRotation(-1/8,0,0),"X^-¼ Gate","Adjoint fourth root of X."),
c.X8=a.fromKnownMatrix("X^⅛",b.fromPauliRotation(1/16,0,0),"X^⅛ Gate","Principle eighth root of X."),c.X8i=a.fromKnownMatrix("X^-⅛",b.fromPauliRotation(-1/16,0,0),"X^-⅛ Gate","Adjoint eighth root of X."),
c.X16=a.fromKnownMatrix("X^⅟₁₆",b.fromPauliRotation(1/32,0,0),"X^⅟₁₆ Gate","Principle sixteenth root of X."),c.X16i=a.fromKnownMatrix("X^-⅟₁₆",b.fromPauliRotation(-1/32,0,0),"X^-⅟₁₆ Gate","Adjoint sixteenth root of X."),
c.all=[c.X3,c.X4,c.X8,c.X16,c.X3i,c.X4i,c.X8i,c.X16i],{get default(){return d}}}),$traceurRuntime.registerModule("src/gates/VariousYGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/VariousYGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/VariousYGates.js"))["default"],c={},d=c;
return c.Y3=a.fromKnownMatrix("Y^⅓",b.fromPauliRotation(0,1/6,0),"Y^⅓ Gate","Principle third root of Y."),c.Y3i=a.fromKnownMatrix("Y^-⅓",b.fromPauliRotation(0,-1/6,0),"Y^-⅓ Gate","Adjoint third root of Y."),
c.Y4=a.fromKnownMatrix("Y^¼",b.fromPauliRotation(0,1/8,0),"Y^¼ Gate","Principle fourth root of Y."),c.Y4i=a.fromKnownMatrix("Y^-¼",b.fromPauliRotation(0,-1/8,0),"Y^-¼ Gate","Adjoint fourth root of Y."),
c.Y8=a.fromKnownMatrix("Y^⅛",b.fromPauliRotation(0,1/16,0),"Y^⅛ Gate","Principle eighth root of Y."),c.Y8i=a.fromKnownMatrix("Y^-⅛",b.fromPauliRotation(0,-1/16,0),"Y^-⅛ Gate","Adjoint eighth root of Y."),
c.Y16=a.fromKnownMatrix("Y^⅟₁₆",b.fromPauliRotation(0,1/32,0),"Y^⅟₁₆ Gate","Principle sixteenth root of Y."),c.Y16i=a.fromKnownMatrix("Y^-⅟₁₆",b.fromPauliRotation(0,-1/32,0),"Y^-⅟₁₆ Gate","Adjoint sixteenth root of Y."),
c.all=[c.Y3,c.Y4,c.Y8,c.Y16,c.Y3i,c.Y4i,c.Y8i,c.Y16i],{get default(){return d}}}),$traceurRuntime.registerModule("src/gates/VariousZGates.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/gates/VariousZGates.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/gates/VariousZGates.js"))["default"],c={},d=c;
return c.Z3=a.fromKnownMatrix("Z^⅓",b.fromPauliRotation(0,0,1/6),"Z^⅓ Gate","Principle third root of Z."),c.Z3i=a.fromKnownMatrix("Z^-⅓",b.fromPauliRotation(0,0,-1/6),"Z^-⅓ Gate","Adjoint third root of Z."),
c.Z4=a.fromKnownMatrix("Z^¼",b.fromPauliRotation(0,0,1/8),"Z^¼ Gate","Principle fourth root of Z.\nAlso known as the 'T' gate."),
c.Z4i=a.fromKnownMatrix("Z^-¼",b.fromPauliRotation(0,0,-1/8),"Z^-¼ Gate","Adjoint fourth root of Z."),c.Z8=a.fromKnownMatrix("Z^⅛",b.fromPauliRotation(0,0,1/16),"Z^⅛ Gate","Principle eighth root of Z."),
c.Z8i=a.fromKnownMatrix("Z^-⅛",b.fromPauliRotation(0,0,-1/16),"Z^-⅛ Gate","Adjoint eighth root of Z."),c.Z16=a.fromKnownMatrix("Z^⅟₁₆",b.fromPauliRotation(0,0,1/32),"Z^⅟₁₆ Gate","Principle sixteenth root of Z."),
c.Z16i=a.fromKnownMatrix("Z^-⅟₁₆",b.fromPauliRotation(0,0,-1/32),"Z^-⅟₁₆ Gate","Adjoint sixteenth root of Z."),c.all=[c.Z3,c.Z4,c.Z8,c.Z16,c.Z3i,c.Z4i,c.Z8i,c.Z16i],
{get default(){return d}}}),$traceurRuntime.registerModule("src/issues.js",[],function(){"use strict";function a(){return null===document.createElement("canvas").getContext("webgl").getExtension("OES_texture_float");
}function b(){var a=document.createElement("canvas"),b=a.getContext("webgl");b.getExtension("OES_texture_float");var c=b.createTexture(),d=b.createFramebuffer();
return b.bindTexture(b.TEXTURE_2D,c),b.bindFramebuffer(b.FRAMEBUFFER,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),
b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),
b.texImage2D(b.TEXTURE_2D,0,b.RGBA,2,2,0,b.RGBA,b.FLOAT,null),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,c,0),
b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE}var c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/fallback.js","src/issues.js")).notifyAboutKnownIssue;
return a()?c("Can't simulate circuits. Your browser/GPU doesn't support creating floating point textures.","https://github.com/Strilanc/Quirk/issues/156",[/Computing circuit values failed/]):b()&&c("Can't simulate circuits. Unable to bind a floating point texture.","https://github.com/Strilanc/Quirk/issues/157",[/FRAMEBUFFER_INCOMPLETE_ATTACHMENT/]),
{}}),$traceurRuntime.registerModule("src/main.js",[],function(){"use strict";$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/browser/Polyfills.js","src/main.js"));
var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/fallback.js","src/main.js")).notifyAboutRecoveryFromUnexpectedError;
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/issues.js","src/main.js"));var b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitDefinition.js","src/main.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/CooldownThrottle.js","src/main.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/main.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CycleCircuitStats.js","src/main.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/widgets/InspectorWidget.js","src/main.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/browser/HistoryPusher.js","src/main.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/Painter.js","src/main.js"))["default"],i=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/main.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/main.js"))["default"]),j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/RestartableRng.js","src/main.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Revision.js","src/main.js"))["default"],l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Serializer.js","src/main.js"))["default"],m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/browser/TouchScrollBlocker.js","src/main.js"))["default"],n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglContext.js","src/main.js")).initializedWglContext,o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/browser/MouseWatcher.js","src/main.js")),p=o.watchDrags,q=o.isMiddleClicking,r=o.eventPosRelativeTo,s=document.getElementById("canvasDiv"),t=document.getElementById("drawCanvas");
if(!t)throw new Error("Couldn't find 'drawCanvas'");t.width=s.clientWidth,t.height=.9*window.innerHeight;var u,v=!1,w=new g,x={cur:new j
};(u=function(){x.cur=new j,setTimeout(u,.99*d.SEMI_STABLE_RANDOM_VALUE_LIFETIME_MILLIS)})();var y,z=(document.getElementById("inspectorDiv"),
f.empty(new i(0,0,t.clientWidth,t.clientHeight))),A=function(a){var b="#"+d.URL_CIRCUIT_PARAM_KEY+"="+a;w.stateChange(a,b),document.title="Quirk: "+z.displayedCircuit.circuitDefinition.readableHash();
},B=function(){return JSON.stringify(l.toJson(z.displayedCircuit.circuitDefinition),null,0)},C=function(a){void 0!==a&&(A(a),z=z.withCircuitDefinition(l.fromJson(b,JSON.parse(a))),
y.trigger())},D=k.startingAt(B()),E=function(){var a=0,b=performance.now();return function(){var c=performance.now(),e=(c-b)/d.CYCLE_DURATION_MS;
return a+=e,a%=1,b=c,a}}(),F=new e(z.displayedCircuit.circuitDefinition,d.TIME_CACHE_GRANULARITY),G=function(a){return{w:Math.max(s.clientWidth,a.desiredWidth()),
h:f.defaultHeight(a.displayedCircuit.circuitDefinition.numWires)}},H=function(a){var b=G(a);return a.updateArea(new i(0,0,b.w,b.h)),
a},I=new m(s),J=function(){return y.trigger()},K=!1,L=function(a){a!==K&&(K=a,J())},M=function(){if(v){var a=H(z).previewDrop();if(!F.circuitDefinition.isEqualTo(a.displayedCircuit.circuitDefinition)){
var b=document.getElementById("error-div").style;b.opacity*=.9,b.opacity<.06&&(b.display="None"),F=new e(a.displayedCircuit.circuitDefinition,d.TIME_CACHE_GRANULARITY);
}var c=F.statsAtApproximateTime(E()),f=G(a);t.width=f.w,t.height=f.h;var g=new h(t,x.cur.restarted());a.updateArea(g.paintableArea()),
a.paint(g,c,K),g.paintDeferred(),z.hand.paintCursor(g),I.setBlockers(g.touchBlockers,g.desiredCursorStyle),t.style.cursor=g.desiredCursorStyle||"auto";
var i=z.stableDuration();1/0>i&&window.requestAnimationFrame(J)}};y=new c(M,d.REDRAW_COOLDOWN_MILLIS);var N=function(a,b){if(z.isEqualTo(a))return!1;
z=a;var c=B();return b&&(D.commit(c),A(c)),J(),!0};p(s,function(a,b){var c=z,d=c.hand.withPos(a),e=H(c.withHand(d)).afterGrabbing(b.shiftKey);
N(e,!1)&&e.hand.isBusy()&&(N(H(c.withHand(d).withJustEnoughWires(e.hand,1)).afterGrabbing(b.shiftKey),!1),D.startedWorkingOnCommit(),
b.preventDefault())},function(a){C(D.cancelCommitBeingWorkedOn()),a.preventDefault()},function(a,b){if(z.hand.isBusy()){var c=z.hand.withPos(a),d=z.withHand(c);
N(d,!1),b.preventDefault()}},function(a,b){if(z.hand.isBusy()){var c=z.hand.withPos(a),d=H(z).withHand(c).afterDropping().afterTidyingUp(),e=d.hand.withPos(void 0),f=d.withHand(e).withJustEnoughWires(e,0);
N(f,!0),b.preventDefault()}}),s.addEventListener("mousedown",function(a){if(q(a)){var b=z.hand.withPos(r(a,t)),c=H(z).withHand(b).afterGrabbing(!1).withHand(b).afterTidyingUp().withJustEnoughWires(b,0);
N(c,!0)&&a.preventDefault()}}),s.addEventListener("mousemove",function(a){if(!z.hand.isBusy()){a.preventDefault();var b=z.hand.withPos(r(a,t)),c=z.withHand(b);
N(c,!1)}}),window.addEventListener("resize",J,!1),document.addEventListener("keydown",function(a){L(a.shiftKey);var b=89,c=90,d=a.keyCode===c&&a.ctrlKey&&!a.shiftKey&&!a.altKey&&!a.metaKey,e=a.keyCode===c&&a.ctrlKey&&a.shiftKey&&!a.altKey&&!a.metaKey,f=a.keyCode===b&&a.ctrlKey&&!a.shiftKey&&!a.altKey&&!a.metaKey;
d&&C(D.undo()),(e||f)&&C(D.redo())}),document.addEventListener("keyup",function(a){L(a.shiftKey)});var O=function(){var a=document.location.hash.substr(1),b=new Map;
if(""!==a){var c=!0,d=!1,e=void 0;try{for(var f=void 0,g=a.split("&")[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=h.indexOf("=");
if(-1!==i){var j=h.substring(0,i),k=decodeURIComponent(h.substring(i+1));b.set(j,k)}}}catch(l){d=!0,e=l}finally{try{c||null==g["return"]||g["return"]();
}finally{if(d)throw e}}}return b},P=function(){try{w.currentStateIsMemorableButUnknown();var c=O();c.has(d.URL_CIRCUIT_PARAM_KEY)||c.set(d.URL_CIRCUIT_PARAM_KEY,JSON.stringify(l.toJson(b.EMPTY)));
var e=c.get(d.URL_CIRCUIT_PARAM_KEY);w.currentStateIsMemorableAndEqualTo(e);var f=JSON.parse(e),g=l.fromJson(b,f);N(z.withCircuitDefinition(g),!0),
D.clear(B()),0===g.columns.length&&1===c.size?w.currentStateIsNotMemorable():A(e)}catch(h){a("Defaulted to an empty circuit. Failed to understand circuit from URL.",{
document_location_hash:document.location.hash},h)}};return window.onpopstate=function(){return P(!1)},P(),v=!0,setTimeout(function(){
n().onContextRestored=function(){return y.trigger()},M(),document.getElementById("loading-div").style.display="none"},0),{}}),$traceurRuntime.registerModule("src/math/Complex.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/math/Complex.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/math/Complex.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/math/Complex.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/math/Complex.js"))["default"],e=function(){
function e(a,b){this.real=a,this.imag=b}return $traceurRuntime.createClass(e,{isEqualTo:function(a){return a instanceof e?this.real===a.real&&this.imag===a.imag:"number"==typeof a?this.real===a&&0===this.imag:!1;
},isApproximatelyEqualTo:function(a,b){if(a instanceof e||"number"==typeof a){var c=this.minus(e.from(a));return Math.abs(c.real)<=b&&Math.abs(c.imag)<=b&&c.abs()<=b;
}return!1},toString:function(a){if(a=a||b.EXACT,a.allowAbbreviation){if(Math.abs(this.imag)<=a.maxAbbreviationError)return a.formatFloat(this.real);
if(Math.abs(this.real)<=a.maxAbbreviationError)return Math.abs(this.imag-1)<=a.maxAbbreviationError?"i":Math.abs(this.imag+1)<=a.maxAbbreviationError?"-i":a.formatFloat(this.imag)+"i";
}var c=this.imag>=0?"+":"-",d=a.allowAbbreviation&&Math.abs(Math.abs(this.imag)-1)<=a.maxAbbreviationError?"":a.formatFloat(Math.abs(this.imag)),e=a.allowAbbreviation||void 0===a.fixedDigits||this.real<0?"":"+";
return e+a.formatFloat(this.real)+c+d+"i"},norm2:function(){return this.real*this.real+this.imag*this.imag},abs:function(){return Math.sqrt(this.norm2());
},conjugate:function(){return new e(this.real,-this.imag)},neg:function(){return new e(-this.real,-this.imag)},phase:function(){return Math.atan2(this.imag,this.real);
},unit:function(){var a=this.norm2();return 1e-5>a?e.polar(1,this.phase()):this.dividedBy(Math.sqrt(a))},plus:function(a){var b=e.from(a);
return new e(this.real+b.real,this.imag+b.imag)},minus:function(a){var b=e.from(a);return new e(this.real-b.real,this.imag-b.imag);
},times:function(a){var b=e.from(a);return new e(this.real*b.real-this.imag*b.imag,this.real*b.imag+this.imag*b.real)},dividedBy:function(a){
var b=e.from(a),c=b.norm2();if(0===c)throw new Error("Division by Zero");var d=this.times(b.conjugate());return new e(d.real/c,d.imag/c);
},sqrts:function(){var a,b,c=[this.real,this.imag],d=(a=c[Symbol.iterator](),(b=a.next()).done?void 0:b.value),f=(b=a.next()).done?void 0:b.value,g=Math.sqrt(Math.sqrt(d*d+f*f));
if(0===g)return[e.ZERO];if(0===f&&0>d)return[new e(0,g),new e(0,-g)];var h=this.phase()/2,i=e.polar(g,h);return[i,i.times(-1)]},exp:function(){
return e.polar(Math.exp(this.real),this.imag)},ln:function(){return new e(Math.log(this.abs()),this.phase())},raisedTo:function(a){
return this.ln().times(e.from(a)).exp()}},{from:function(b){if(b instanceof e)return b;if("number"==typeof b)return new e(b,0);throw new a("Unrecognized value type.",{
v:b})},polar:function(a,b){var c,f,g=d.snappedCosSin(b),h=(c=g[Symbol.iterator](),(f=c.next()).done?void 0:f.value),i=(f=c.next()).done?void 0:f.value;
return new e(a*h,a*i)},realPartOf:function(b){if(b instanceof e)return b.real;if("number"==typeof b)return b;throw new a("Unrecognized value type.",{
v:b})},imagPartOf:function(b){if(b instanceof e)return b.imag;if("number"==typeof b)return 0;throw new a("Unrecognized value type.",{
v:b})},parse:function(d){var f=d.toLowerCase();if(0===d.trim().length)throw new a("Empty",{text:d});if(-1!==f.indexOf("e_plus")||-1!==f.indexOf("e_minus"))throw new a("Invalid",{
text:d});return new c(f.replace("e+","e_plus").replace("e-","e_minus").split("+")).flatMap(function(f){return new c(f.split("-")).mapWithIndex(function(c,f){
var g=c.replace("e_minus","e-").replace("e_plus","e+");if(0===f&&""===g)return e.ZERO;var h="i"===g[g.length-1];h&&(g=g.slice(0,g.length-1));
var i=""===g?1:b.parseFloat(g);if(isNaN(i))throw new a("Not a float",{text:d,dif:g});return e.from(i).times(h?e.I:1).times(0===f?1:-1);
})}).aggregate(e.ZERO,function(a,b){return a.plus(b)})},rootsOfQuadratic:function(a,b,c){if(a=e.from(a),b=e.from(b),c=e.from(c),a.isEqualTo(0)){
if(!b.isEqualTo(0))return[c.times(-1).dividedBy(b)];if(!c.isEqualTo(0))return[];throw Error("Degenerate")}var d=b.times(b).minus(a.times(c).times(4)).sqrts(),f=b.times(-1),g=a.times(2);
return d.map(function(a){return f.minus(a).dividedBy(g)})}})}();e.ZERO=new e(0,0),e.ONE=new e(1,0),e.I=new e(0,1);var f=e;return{
get default(){return f}}}),$traceurRuntime.registerModule("src/math/Matrix.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/math/Matrix.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/math/Matrix.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/math/Matrix.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/math/Matrix.js")),e=d.seq,f=d.Seq,g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/math/Matrix.js"))["default"],h=function(){
function d(a,c,d){if(a*c*2!==d.length)throw new b("width*height*2 !== buffer.length",{width:a,height:c,len:d.length});this._width=a,
this._height=c,this._buffer=d}return $traceurRuntime.createClass(d,{cell:function(c,d){if(0>c||0>d||c>=this._width||d>=this._height)throw new b("Cell out of range",{
col:c,row:d,width:this._width,height:this._height});var e=2*(this._width*d+c);return new a(this._buffer[e],this._buffer[e+1])},rawBuffer:function(){
return this._buffer},rows:function(){var a=this;return f.range(this._height).map(function(b){return f.range(a._width).map(function(c){
return a.cell(c,b)}).toArray()}).toArray()},isEqualTo:function(a){var b=this;if(this===a)return!0;if(!(a instanceof d))return!1;var c=a;
return this._width===c._width&&this._height===c._height&&f.range(this._buffer.length).every(function(a){return b._buffer[a]===c._buffer[a];
})},isApproximatelyEqualTo:function(a,b){return a instanceof d&&this._width===a._width&&this._height===a._height&&Math.sqrt(this.minus(a).norm2())<=b;
},toString:function(){var a=void 0!==arguments[0]?arguments[0]:c.EXACT,b=this.rows().map(function(b){return b.map(function(b){return b.toString(a);
}).join(a.itemSeparator)}).join("}"+a.itemSeparator+"{");return"{{"+b+"}}"},width:function(){return this._width},height:function(){
return this._height},isUnitary:function(a){var b=this.width();return this.height()!==b?!1:this.times(this.adjoint()).isApproximatelyEqualTo(d.identity(b),a);
},isLowerTriangular:function(){for(var a=void 0!==arguments[0]?arguments[0]:0,b=0;b<this._height;b++)for(var c=b+1;c<this._width;c++){
var d=2*(b*this._width+c),e=this._buffer[d],f=this._buffer[d+1];if(isNaN(e)||isNaN(f)||e*e+f*f>a*a)return!1}return!0},isUpperTriangular:function(){
for(var a=void 0!==arguments[0]?arguments[0]:0,b=0;b<this._height;b++)for(var c=0;b>c&&c<this._width;c++){var d=2*(b*this._width+c),e=this._buffer[d],f=this._buffer[d+1];
if(isNaN(e)||isNaN(f)||e*e+f*f>a*a)return!1}return!0},isPhasedPermutation:function(){var a=void 0!==arguments[0]?arguments[0]:0;if(this._width!==this._height)return!1;
for(var b=this._width,c=new Uint32Array(b),d=new Uint32Array(b),f=0;b>f;f++)for(var g=0;b>g;g++){var h=2*(g*b+f),i=Math.max(Math.abs(this._buffer[h]),Math.abs(this._buffer[h+1]));
(isNaN(i)||i>a)&&(c[f]+=1,d[g]+=1)}return e(c).concat(d).every(function(a){return 1>=a})},isApproximatelyHermitian:function(a){if(this._width!==this._height)return!1;
for(var b=0;b<this._width;b++)for(var c=0;c<this._height;c++){var d=2*(this._width*c+b),e=2*(this._width*b+c);if(Math.abs(this._buffer[d]-this._buffer[e])>a)return!1;
if(Math.abs(this._buffer[d+1]+this._buffer[e+1])>a)return!1}return!0},isIdentity:function(){var a=void 0!==arguments[0]?arguments[0]:0;
if(this._width!==this._height)return!1;for(var b=0;b<this._width;b++)for(var c=0;c<this._height;c++){var d=2*(this._width*c+b),e=Math.abs(this._buffer[d]-(c===b?1:0)),f=Math.abs(this._buffer[d+1]);
if(Math.max(e,f)>a)return!1}return!this.hasNaN()},hasNaN:function(){for(var a=(void 0!==arguments[0]?arguments[0]:0,0);a<this._buffer.length;a++)if(isNaN(this._buffer[a]))return!0;
return!1},isDiagonal:function(){for(var a=void 0!==arguments[0]?arguments[0]:0,b=0;b<this._width;b++)for(var c=0;c<this._height;c++)if(c!==b){
var d=2*(this._width*c+b),e=Math.abs(this._buffer[d]),f=Math.abs(this._buffer[d+1]),g=Math.max(e,f);if(isNaN(g)||g>a)return!1}return this._width===this._height;
},adjoint:function(){for(var a=this._height,b=this._width,c=new Float64Array(a*b*2),e=0;b>e;e++)for(var f=0;a>f;f++){var g=2*(f*this._width+e),h=2*(e*a+f);
c[h]=this._buffer[g],c[h+1]=-this._buffer[g+1]}return new d(a,b,c)},trace:function(){for(var b=0,c=0,d=2*this._width+2,e=0;e<this._buffer.length;e+=d)b+=this._buffer[e],
c+=this._buffer[e+1];return new a(b,c)},_timesScalar:function(b){for(var c=new Float64Array(this._buffer.length),e=a.realPartOf(b),f=a.imagPartOf(b),g=0;g<c.length;g+=2){
var h=this._buffer[g],i=this._buffer[g+1];c[g]=h*e-i*f,c[g+1]=h*f+i*e}return new d(this._width,this._height,c)},plus:function(a){
var b=this,c=b._width,e=b._height,f=b._buffer,h=a._buffer;g.need(a._width===c&&a._height===e,"Matrix.plus: compatible sizes");for(var i=new Float64Array(this._buffer.length),j=0;j<i.length;j++)i[j]=f[j]+h[j];
return new d(c,e,i)},minus:function(a){var b=this,c=b._width,e=b._height,f=b._buffer,h=a._buffer;g.need(a._width===c&&a._height===e,"Matrix.minus: compatible sizes");
for(var i=new Float64Array(this._buffer.length),j=0;j<i.length;j++)i[j]=f[j]-h[j];return new d(c,e,i)},_timesMatrix:function(a){if(this._width!==a._height)throw new b("Incompatible sizes.",{
"this":this,other:a});for(var c=a._width,e=this._height,f=this._width,g=new Float64Array(c*e*2),h=0;e>h;h++)for(var i=0;c>i;i++)for(var j=2*(h*c+i),k=0;f>k;k++){
var l=2*(h*f+k),m=2*(k*c+i),n=this._buffer[l],o=this._buffer[l+1],p=a._buffer[m],q=a._buffer[m+1],r=n*p-o*q,s=n*q+p*o;g[j]+=r,g[j+1]+=s;
}return new d(c,e,g)},times:function(a){return a instanceof d?this._timesMatrix(a):this._timesScalar(a)},norm2:function(){return e(this.rows()).flatten().map(function(a){
return a.norm2()}).sum()},tensorProduct:function(a){for(var b=this._width,c=this._height,e=a._width,f=a._height,g=b*e,h=c*f,i=new Float64Array(g*h*2),j=0;c>j;j++)for(var k=0;f>k;k++)for(var l=0;b>l;l++)for(var m=0;e>m;m++){
var n=2*(j*b+l),o=2*(k*e+m),p=2*((j*f+k)*g+(l*e+m)),q=this._buffer[n],r=this._buffer[n+1],s=a._buffer[o],t=a._buffer[o+1],u=q*s-r*t,v=q*t+r*s;
i[p]=u,i[p+1]=v}return new d(g,h,i)},timesQubitOperation:function(a,b,c,e){var f,h,i,j,k,l;g.need(0===(c&1<<b),"Matrix.timesQubitOperation: self-controlled"),
g.need(2===a._width&&2===a._height,"Matrix.timesQubitOperation: not 2x2");var m=this,n=m._width,o=m._height,p=m._buffer,q=a.rows(),r=(f=q[Symbol.iterator](),
(h=f.next()).done?void 0:h.value),s=(i=r[Symbol.iterator](),(j=i.next()).done?void 0:j.value),t=s.real,u=s.imag,v=(j=i.next()).done?void 0:j.value,w=v.real,x=v.imag,y=(h=f.next()).done?void 0:h.value,z=(k=y[Symbol.iterator](),
(l=k.next()).done?void 0:l.value),A=z.real,B=z.imag,C=(l=k.next()).done?void 0:l.value,D=C.real,E=C.imag;g.need(o>=2<<b,"Matrix.timesQubitOperation: qubit index out of range");
for(var F=new Float64Array(p),G=0,H=0;o>H;H++)for(var I=0!==(c&H^e),J=0!==(H&1<<b),K=0;n>K;K++){if(!I&&!J){var L=G+2*(1<<b)*n,M=F[G],N=F[G+1],O=F[L],P=F[L+1];
F[G]=M*t-N*u+O*w-P*x,F[G+1]=M*u+N*t+O*x+P*w,F[L]=M*A-N*B+O*D-P*E,F[L+1]=M*B+N*A+O*E+P*D}G+=2}return new d(n,o,F)},tensorPower:function(a){
if(!Number.isInteger(a)||0>a)throw new b("Bad exponent",{exponent:a});for(var c=d.identity(1),e=this,f=1;a>=f;f*=2)0!==(f&a)&&(c=c.tensorProduct(e)),
e=e.tensorProduct(e);return c},transformRealAndImagComponentsWith:function(b){return d.fromRows(this.rows().map(function(c){return c.map(function(c){
return new a(b(c.real),b(c.imag))})}))},_inline_rowScale_preMultiply:function(a,b){for(var c=0;c<this._width;c++){var d=this.cell(c,a),e=d.times(b),f=2*(a*this._width+c);
this._buffer[f]=e.real,this._buffer[f+1]=e.imag}},_inline_colScale_postMultiply:function(a,b){for(var c=0;c<this._height;c++){var d=this.cell(a,c),e=d.times(b),f=2*(c*this._width+a);
this._buffer[f]=e.real,this._buffer[f+1]=e.imag}},_inline_rowMix_preMultiply:function(a,b,c){for(var d,e,f,g,h,i,j=c.rows(),k=(d=j[Symbol.iterator](),
(e=d.next()).done?void 0:e.value),l=(f=k[Symbol.iterator](),(g=f.next()).done?void 0:g.value),m=(g=f.next()).done?void 0:g.value,n=(e=d.next()).done?void 0:e.value,o=(h=n[Symbol.iterator](),
(i=h.next()).done?void 0:i.value),p=(i=h.next()).done?void 0:i.value,q=0;q<this._width;q++){var r=this.cell(q,a),s=this.cell(q,b),t=r.times(l).plus(s.times(m)),u=r.times(o).plus(s.times(p)),v=2*(a*this._width+q),w=2*(b*this._width+q);
this._buffer[v]=t.real,this._buffer[v+1]=t.imag,this._buffer[w]=u.real,this._buffer[w+1]=u.imag}},_inline_colMix_postMultiply:function(a,b,c){
for(var d,e,f,g,h,i,j=c.rows(),k=(d=j[Symbol.iterator](),(e=d.next()).done?void 0:e.value),l=(f=k[Symbol.iterator](),(g=f.next()).done?void 0:g.value),m=(g=f.next()).done?void 0:g.value,n=(e=d.next()).done?void 0:e.value,o=(h=n[Symbol.iterator](),
(i=h.next()).done?void 0:i.value),p=(i=h.next()).done?void 0:i.value,q=0;q<this._width;q++){var r=this.cell(a,q),s=this.cell(b,q),t=r.times(l).plus(s.times(o)),u=r.times(m).plus(s.times(p)),v=2*(q*this._width+a),w=2*(q*this._width+b);
this._buffer[v]=t.real,this._buffer[v+1]=t.imag,this._buffer[w]=u.real,this._buffer[w+1]=u.imag}},_clone:function(){return new d(this._width,this._height,this._buffer.slice());
},qrDecomposition:function(){if(this._width!==this._height)throw new b("Expected a square matrix.",this);for(var a=d.identity(this._width),c=this._clone(),e=0;e<this._height;e++)for(var f=0;e>f&&f<this._width;f++){
var g=c.cell(f,e),h=c.cell(f,f),i=h.abs(),j=g.abs();if(0!==j){var k=-Math.atan2(j,i),l=Math.cos(k),m=Math.sin(k),n=h.unit().conjugate(),o=g.unit().conjugate(),p=d.square(n.times(l),o.times(-m),n.times(m),o.times(l));
c._inline_rowMix_preMultiply(f,e,p),a._inline_colMix_postMultiply(f,e,p.adjoint())}}return{Q:a,R:c}},lqDecomposition:function(){var a=this.adjoint().qrDecomposition(),b=a.Q,c=a.R;
return{L:c.adjoint(),Q:b.adjoint()}},eigenvalueMagnitudes:function(a){var c=void 0!==arguments[1]?arguments[1]:1e3;if(this._width!==this._height)throw new b("Expected a square matrix.",this);
for(var d=0,e=this;!e.isUpperTriangular(a)&&c>d;){var g=e.qrDecomposition(),h=g.Q,i=g.R;if(i.isIdentity(a))return f.repeat(1,this._width).toArray();
e=i.times(h),d++}return f.range(this._width).map(function(a){return e.cell(a,a).abs()}).sortedBy(function(a){return-a}).toArray();
},eigenDecomposition:function(){var b,c,e,f,g,h;if(2!==this.width()||2!==this.height())throw new Error("Not implemented: non-2x2 eigen decomposition");
var i=this.rows(),j=(b=i[Symbol.iterator](),(c=b.next()).done?void 0:c.value),k=(e=j[Symbol.iterator](),(f=e.next()).done?void 0:f.value),l=(f=e.next()).done?void 0:f.value,m=(c=b.next()).done?void 0:c.value,n=(g=m[Symbol.iterator](),
(h=g.next()).done?void 0:h.value),o=(h=g.next()).done?void 0:h.value,p=a.rootsOfQuadratic(a.ONE,k.plus(o).times(-1),k.times(o).minus(l.times(n)));
if(0===p.length)throw new Error("Degenerate");return 1===p.length?[{val:p[0],vec:d.col(1,0)},{val:p[0],vec:d.col(0,1)}]:p.map(function(b){
var c,e,f,g,h,i=[l.times(-1),k.minus(b)],j=(c=i[Symbol.iterator](),(e=c.next()).done?void 0:e.value),m=(e=c.next()).done?void 0:e.value;
j.isEqualTo(0)&&m.isEqualTo(0)&&(f=[b.minus(o),n],g=f[Symbol.iterator](),j=(h=g.next()).done?void 0:h.value,m=(h=g.next()).done?void 0:h.value,
f),j.isEqualTo(0)||(m=m.dividedBy(j),j=a.ONE);var p=Math.sqrt(j.norm2()+m.norm2());if(0===p)throw new Error("Unexpected degenerate");
return{val:b,vec:d.col(j,m).times(1/p)}})},liftApply:function(a){var b=this.times(0),c=!0,d=!1,e=void 0;try{for(var f=void 0,g=this.eigenDecomposition()[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){
var h=f.value,i=h.val,j=h.vec,k=a(i),l=j.times(j.adjoint());b=b.plus(l.times(k))}}catch(m){d=!0,e=m}finally{try{c||null==g["return"]||g["return"]();
}finally{if(d)throw e}}return b},qubitDensityMatrixToBlochVector:function(){var a,c;if(2!==this._width||2!==this._height)throw new b("Need a 2x2 density matrix.",this);
if(!this.isApproximatelyHermitian(.01))throw new b("Density matrix should be Hermitian.",this);if(!this.trace().isApproximatelyEqualTo(1,.01))throw new b("Density matrix should have unit trace.",this);
var d=this._buffer,e=(a=d[Symbol.iterator](),(c=a.next()).done?void 0:c.value),f=((c=a.next()).done?void 0:c.value,(c=a.next()).done?void 0:c.value),g=(c=a.next()).done?void 0:c.value,h=(c=a.next()).done?void 0:c.value,i=(c=a.next()).done?void 0:c.value,j=(c=a.next()).done?void 0:c.value,k=((c=a.next()).done?void 0:c.value,
h+f),l=i-g,m=e-j;return[k,l,m]},determinant:function(){var b=this;g.need(this.width()===this.height(),"Must be square");var c=this.width();
return 1===c?this.cell(0,0):f.range(c).map(function(a){var e=d.generate(c-1,c-1,function(c,d){return b.cell(d+(a>d?0:1),c+1)});return e.determinant().times(b.cell(a,0)).times(Math.pow(-1,a));
}).aggregate(a.ZERO,function(a,b){return a.plus(b)})},qubitOperationToAngleAxisRotation:function(){var b,c,d,f,h,i;g.need(2===this.width()&&2===this.height(),"Need a 2x2 matrix."),
g.need(this.isUnitary(.01),"Need a unitary matrix.");var j=this.rows(),k=(b=j[Symbol.iterator](),(c=b.next()).done?void 0:c.value),l=(d=k[Symbol.iterator](),
(f=d.next()).done?void 0:f.value),m=(f=d.next()).done?void 0:f.value,n=(c=b.next()).done?void 0:c.value,o=(h=n[Symbol.iterator](),
(i=h.next()).done?void 0:i.value),p=(i=h.next()).done?void 0:i.value,q=l.plus(p),r=m.plus(o).dividedBy(a.I),s=m.minus(o),t=l.minus(p).dividedBy(a.I),u=e([q,r,s,t]).maxBy(function(a){
return a.abs()}).unit().times(2),v=Math.min(1,Math.max(-1,q.dividedBy(u).real)),w=r.dividedBy(u).real,x=s.dividedBy(u).real,y=t.dividedBy(u).real,z=-2*Math.acos(v),A=Math.sqrt(w*w+x*x+y*y);
return 1e-7>A?{axis:[1,0,0],angle:0,phase:u.phase()}:(w/=A,x/=A,y/=A,z<=-Math.PI&&(z+=2*Math.PI,u=u.times(-1)),0>w+x+y&&(w=-w,x=-x,
y=-y,z=-z),{axis:[w,x,y],angle:z,phase:u.phase()})},cross3:function(a){var b=this;return g.need(1===this.width()&&3===this.height(),"This isn't a 3d column vector."),
g.need(1===a.width()&&3===a.height(),"Other's not a 3d column vector."),d.generate(1,3,function(c){var d,e,f=[(c+1)%3,(c+2)%3],g=(d=f[Symbol.iterator](),
(e=d.next()).done?void 0:e.value),h=(e=d.next()).done?void 0:e.value,i=b.cell(0,g).times(a.cell(0,h)),j=b.cell(0,h).times(a.cell(0,g));
return i.minus(j)})},_unordered_singularValueDecomposition_2x2:function(){var a,b,c=d.identity(2),e=this.lqDecomposition(),f=e.L,g=e.Q,h=f.cell(0,0).unit(),i=f.cell(0,1).unit();
c._inline_colScale_postMultiply(0,h),c._inline_colScale_postMultiply(1,i),f._inline_rowScale_preMultiply(0,h.conjugate()),f._inline_rowScale_preMultiply(1,i.conjugate());
var j=f.cell(1,1).unit();f._inline_colScale_postMultiply(1,j.conjugate()),g._inline_rowScale_preMultiply(1,j);var k=f._buffer,l=(a=k[Symbol.iterator](),
(b=a.next()).done?void 0:b.value),m=(a.next(),(b=a.next()).done?void 0:b.value),n=(a.next(),(b=a.next()).done?void 0:b.value),o=(a.next(),
(b=a.next()).done?void 0:b.value),p=l+o,q=m+n,r=m-n,s=l-o,t=Math.atan2(q,p)/2,u=Math.atan2(r,s)/2,v=Math.sqrt(p*p+q*q)/2,w=Math.sqrt(s*s+r*r)/2;
return c._inline_colMix_postMultiply(0,1,d.rotation(t-u)),g._inline_rowMix_preMultiply(0,1,d.rotation(t+u)),f=d.square(v+w,0,0,v-w),
{U:c,S:f,V:g}},_unordered_singularValueDecomposition_iterative:function(){for(var a=void 0!==arguments[0]?arguments[0]:0,b=void 0!==arguments[1]?arguments[1]:100,c=d.identity(this._width),e=this._clone(),f=d.identity(this._width),g=0;!e.isDiagonal(a)&&g++<b;){
var h=e.qrDecomposition(),i=h.Q,j=h.R,k=j.lqDecomposition(),l=k.L,m=k.Q;c=c.times(i),e=l,f=m.times(f)}return{U:c,S:e,V:f}},singularValueDecomposition:function(){
var a,c,e,g=void 0!==arguments[0]?arguments[0]:0,h=void 0!==arguments[1]?arguments[1]:100;if(this._width!==this._height)throw new b("Expected a square matrix.",this);
for(var i=2===this._width?this._unordered_singularValueDecomposition_2x2():this._unordered_singularValueDecomposition_iterative(g,h),j=i.U,k=i.S,l=i.V,m=f.range(this._width).sortedBy(function(a){
return-k.cell(a,a).norm2()}).toArray(),n=0;n<k._width;n++){var o=m[n];n!==o&&(j._inline_colMix_postMultiply(n,o,d.PAULI_X),k._inline_rowMix_preMultiply(n,o,d.PAULI_X),
a=[m[n],m[o]],m[o]=(c=a[Symbol.iterator](),(e=c.next()).done?void 0:e.value),m[n]=(e=c.next()).done?void 0:e.value,a)}for(var p=0;p<k._width;p++)j._inline_colScale_postMultiply(p,k.cell(p,p).unit());
return k=d.generate(k._width,k._height,function(a,b){return a===b?k.cell(a,b).abs():0}),{U:j,S:k,V:l}},getColumn:function(a){return g.need(a>=0&&a<=this.width(),"colIndex >= 0 && colIndex <= this.width()"),
this.rows().map(function(b){return b[a]})},closestUnitary:function(){var a=this.singularValueDecomposition();return a.U.times(a.V);
}},{fromRows:function(b){g.need(Array.isArray(b)&&b.every(Array.isArray),"array rows",b),g.need(b.length>0,"non-zero height",arguments);
var c=e(b),f=b.length,h=c.map(function(a){return a.length}).distinct().single(0);g.need(h>0,"consistent non-zero width",b);var i=new Float64Array(h*f*2),j=0,k=!0,l=!1,m=void 0;
try{for(var n=void 0,o=b[Symbol.iterator]();!(k=(n=o.next()).done);k=!0){var p=n.value,q=!0,r=!1,s=void 0;try{for(var t=void 0,u=p[Symbol.iterator]();!(q=(t=u.next()).done);q=!0){
var v=t.value;i[j]=a.realPartOf(v),i[j+1]=a.imagPartOf(v),j+=2}}catch(w){r=!0,s=w}finally{try{q||null==u["return"]||u["return"]();
}finally{if(r)throw s}}}}catch(x){l=!0,m=x}finally{try{k||null==o["return"]||o["return"]()}finally{if(l)throw m}}return new d(h,f,i);
},parse:function(b){if(b=b.replace(/\s/g,""),b.length<4||"{{"!==b.substr(0,2)||"}}"!==b.substr(b.length-2,2))throw new Error("Not surrounded by {{}}.");
return d.fromRows(b.substr(2,b.length-4).split("},{").map(function(b){return b.split(",").map(a.parse)}))},generate:function(b,c,e){
for(var f=new Float64Array(b*c*2),g=0;c>g;g++)for(var h=0;b>h;h++){var i=2*(g*b+h),j=e(g,h);f[i]=a.realPartOf(j),f[i+1]=a.imagPartOf(j);
}return new d(b,c,f)},zero:function(a,b){return new d(a,b,new Float64Array(a*b*2))},solo:function(b){return new d(1,1,new Float64Array([a.realPartOf(b),a.imagPartOf(b)]));
},square:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];g.need(Array.isArray(a),"Array.isArray(coefs)",arguments);
var c=Math.round(Math.sqrt(a.length));return g.need(c*c===a.length,"Matrix.square: non-square number of arguments"),d.generate(c,c,function(b,d){
return a[b*c+d]})},col:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return g.need(Array.isArray(a),"Array.isArray(coefs)",arguments),
d.generate(1,a.length,function(b){return a[b]})},row:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return g.need(Array.isArray(a),"Array.isArray(coefs)",arguments),
d.generate(a.length,1,function(b,c){return a[c]})},fromPauliRotation:function(b,e,f){var h,i,j=function(a){return Math.abs(a)<2e-4?1-a*a/6:Math.sin(a)/a;
};b=-b*Math.PI*2,e=-e*Math.PI*2,f=-f*Math.PI*2;var k=-11*b+-13*e+-17*f>=0?1:-1,l=Math.sqrt(b*b+e*e+f*f),m=d.PAULI_X.times(b).plus(d.PAULI_Y.times(e)).plus(d.PAULI_Z.times(f)),n=g.snappedCosSin(k*l),o=(h=n[Symbol.iterator](),
(i=h.next()).done?void 0:i.value),p=(i=h.next()).done?void 0:i.value,q=new a(1+o,p).times(.5),r=new a(Math.sin(l/2)*j(l/2),-k*j(l)).times(.5*k),s=d.identity(2).times(q).minus(m.times(r)),t=function(a){
return c.simplifyByRounding(a,1e-13)};return s.transformRealAndImagComponentsWith(t)},fromWireSwap:function(a,b,c){var e=function(a){
var d=1<<b,e=1<<c,f=a&~(d|e);return 0!==(a&d)&&(f|=e),0!==(a&e)&&(f|=d),f};return d.generate(1<<a,1<<a,function(a,b){return e(a)===b?1:0;
})},identity:function(a){for(var b=new Float64Array(a*a*2),c=0;a>c;c++)b[c*(a+1)*2]=1;return new d(a,a,b)},rotation:function(a){var b=Math.cos(a),c=Math.sin(a);
return d.square(b,-c,c,b)},fromAngleAxisPhaseRotation:function(b,c,e){var f,h,i,j,k=c,l=(f=k[Symbol.iterator](),(h=f.next()).done?void 0:h.value),m=(h=f.next()).done?void 0:h.value,n=(h=f.next()).done?void 0:h.value;
g.need(Math.abs(l*l+m*m+n*n-1)<1e-6,"Not a unit axis.");var o=d.PAULI_X.times(l).plus(d.PAULI_Y.times(m)).plus(d.PAULI_Z.times(n)),p=g.snappedCosSin(-b/2),q=(i=p[Symbol.iterator](),
(j=i.next()).done?void 0:j.value),r=(j=i.next()).done?void 0:j.value;return d.identity(2).times(q).plus(o.times(new a(0,r))).times(a.polar(1,e));
}})}();h.PAULI_X=h.square(0,1,1,0),h.PAULI_Y=h.square(0,new a(0,-1),a.I,0),h.PAULI_Z=h.square(1,0,0,-1),h.HADAMARD=h.square(1,1,1,-1).times(Math.sqrt(.5));
var i=h;return{get default(){return i}}}),$traceurRuntime.registerModule("src/math/Point.js",[],function(){"use strict";var a=function(){
function a(a,b){this.x=a,this.y=b}return $traceurRuntime.createClass(a,{isEqualTo:function(b){if(!(b instanceof a))return!1;var c=b;
return c.x===this.x&&c.y===this.y},toString:function(){return"(x: "+this.x+", y: "+this.y+")"},offsetBy:function(b,c){return new a(this.x+b,this.y+c);
},plus:function(b){return new a(this.x+b.x,this.y+b.y)},minus:function(b){return new a(this.x-b.x,this.y-b.y)},times:function(b){
return new a(this.x*b,this.y*b)},distanceTo:function(a){var b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)}},{})}(),b=a;return{
get default(){return b}}}),$traceurRuntime.registerModule("src/math/Rect.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/math/Rect.js"))["default"],b=function(){
function b(a,b,c,d){this.x=a,this.y=b,this.w=c,this.h=d}return $traceurRuntime.createClass(b,{isEqualTo:function(a){if(!(a instanceof b))return!1;
var c=a;return c.x===this.x&&c.y===this.y&&c.w===this.w&&c.h===this.h},isApproximatelyEqualTo:function(a,c){if(!(a instanceof b))return!1;
var d=a;return Math.abs(d.x-this.x)<=c&&Math.abs(d.y-this.y)<=c&&Math.abs(d.right()-this.right())<=c&&Math.abs(d.bottom()-this.bottom())<=c;
},toString:function(){return"["+this.x+":"+this.right()+"]x["+this.y+":"+this.bottom()+"]"},center:function(){return new a(this.x+this.w/2,this.y+this.h/2);
},topLeft:function(){return new a(this.x,this.y)},topRight:function(){return new a(this.x+this.w,this.y)},bottomLeft:function(){return new a(this.x,this.y+this.h);
},bottomRight:function(){return new a(this.x+this.w,this.y+this.h)},centerLeft:function(){return new a(this.x,this.y+this.h/2)},centerRight:function(){
return new a(this.x+this.w,this.y+this.h/2)},topCenter:function(){return new a(this.x+this.w/2,this.y)},bottomCenter:function(){return new a(this.x+this.w/2,this.y+this.h);
},right:function(){return this.x+this.w},bottom:function(){return this.y+this.h},skipLeft:function(a){var c=Math.min(a,this.w);return new b(this.x+c,this.y,this.w-c,this.h);
},skipRight:function(a){var c=Math.min(a,this.w);return new b(this.x,this.y,this.w-c,this.h)},skipTop:function(a){var c=Math.min(a,this.h);
return new b(this.x,this.y+c,this.w,this.h-c)},skipBottom:function(a){var c=Math.min(a,this.h);return new b(this.x,this.y,this.w,this.h-c);
},takeLeft:function(a){var c=Math.max(a,0);return new b(this.x,this.y,c,this.h)},takeRight:function(a){var c=Math.max(a,0);return new b(this.x+this.w-c,this.y,c,this.h);
},takeTop:function(a){var c=Math.max(a,0);return new b(this.x,this.y,this.w,c)},takeBottom:function(a){var c=Math.max(a,0);return new b(this.x,this.y+this.h-c,this.w,c);
},paddedBy:function(a){return new b(this.x-a,this.y-a,this.w+2*a,this.h+2*a)},scaledOutwardBy:function(a){var c=this.center(),d=this.w*a,e=this.h*a;
return new b(c.x-d/2,c.y-e/2,d,e)},containsPoint:function(a){return a.x>=this.x&&a.x<this.x+this.w&&a.y>=this.y&&a.y<this.y+this.h;
},takeLeftProportion:function(a){return this.takeLeft(this.w*a)},takeRightProportion:function(a){return this.takeRight(this.w*a)},
takeTopProportion:function(a){return this.takeTop(this.h*a)},takeBottomProportion:function(a){return this.takeBottom(this.h*a)},leftHalf:function(){
return this.skipRight(this.w/2)},rightHalf:function(){return this.skipLeft(this.w/2)},topHalf:function(){return this.skipBottom(this.h/2);
},bottomHalf:function(){return this.skipTop(this.h/2)},shiftedBy:function(a,c){return new b(this.x+a,this.y+c,this.w,this.h)},proportionalShiftedBy:function(a,b){
return this.shiftedBy(a*this.w,b*this.h)},withX:function(a){return new b(a,this.y,this.w,this.h)},withY:function(a){return new b(this.x,a,this.w,this.h);
},withW:function(a){return new b(this.x,this.y,a,this.h)},withH:function(a){return new b(this.x,this.y,this.w,a)},snapInside:function(a){
var c=Math.min(a.w,this.w),d=Math.min(a.h,this.h),e=Math.max(Math.min(this.x,a.right()-c),a.x),f=Math.max(Math.min(this.y,a.bottom()-d),a.y);
return new b(e,f,c,d)}},{centeredSquareWithRadius:function(a,c){return new b(a.x-c,a.y-c,2*c,2*c)}})}(),c=b;return{get default(){
return c}}}),$traceurRuntime.registerModule("src/ui/GateDrawParams.js",[],function(){"use strict";var a=function(){function a(a,b,c,d,e,f,g,h,i,j,k){
this.painter=a,this.isInToolbox=b,this.isHighlighted=c,this.isResizeShowing=d,this.isResizeHighlighted=e,this.rect=f,this.gate=g,
this.stats=h,this.positionInCircuit=i,this.focusPoints=j,this.customStats=k}return $traceurRuntime.createClass(a,{},{})}(),b=a;return{
get default(){return b}}}),$traceurRuntime.registerModule("src/ui/GatePainting.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/ui/GatePainting.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/ui/GatePainting.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GateDrawParams.js","src/ui/GatePainting.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/ui/GatePainting.js"))["default"]),c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/ui/GatePainting.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/ui/GatePainting.js"))["default"]),d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/ui/GatePainting.js"))["default"],e=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/ui/GatePainting.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/ui/GatePainting.js"))["default"]),f=function(){
function a(){}return $traceurRuntime.createClass(a,{},{})}(),g=f;f.MAKE_HIGHLIGHTED_DRAWER=function(){var b=void 0!==arguments[0]?arguments[0]:a.GATE_FILL_COLOR,c=void 0!==arguments[1]?arguments[1]:a.GATE_FILL_COLOR;
return function(d){var e=d.isInToolbox?b:c;d.isHighlighted&&(e=a.HIGHLIGHTED_GATE_FILL_COLOR),d.painter.fillRect(d.rect,e),d.painter.strokeRect(d.rect),
f.paintResizeTab(d),f.paintGateSymbol(d)}},f.DEFAULT_DRAWER=f.MAKE_HIGHLIGHTED_DRAWER(),f.rectForResizeTab=function(b){var c=Math.min(a.GATE_RADIUS,b.h/4);
return new d(b.x,b.bottom()-c,b.w,2*a.GATE_RADIUS)},f.paintResizeTab=function(b){if(b.isResizeShowing&&b.gate.canChangeInSize()){
var c=a.GATE_RADIUS,d=f.rectForResizeTab(b.rect),e=d.skipLeft(2).skipRight(2),g=e.center(),h=g.x,i=g.y,j=b.isResizeHighlighted?a.HIGHLIGHTED_GATE_FILL_COLOR:a.GATE_FILL_COLOR,k=b.isResizeHighlighted?"#222":"gray";
b.painter.ctx.save(),b.painter.ctx.globalAlpha*=b.isResizeHighlighted?1:.7,b.painter.fillRect(e,j),b.painter.strokeRect(e,"gray"),
b.painter.ctx.restore(),b.painter.print("resize",h,i,"center","middle",k,"monospace",e.w-4,e.h-4),b.painter.trace(function(a){var d=[b.gate.canIncreaseInSize()?1:-1,b.gate.canDecreaseInSize()?-1:1],e=[1,-1],f=!0,g=!1,j=void 0;
try{for(var k=void 0,l=[-1,1][Symbol.iterator]();!(f=(k=l.next()).done);f=!0)for(var m=k.value,n=0;2>n;n++){var o=i+c*e[n]*5/8,p=o+c*d[n]/8,q=o-c*d[n]/8;
a.line(h,p,h+c*m*.3,q)}}catch(r){g=!0,j=r}finally{try{f||null==l["return"]||l["return"]()}finally{if(g)throw j}}}).thenStroke(k)}
},f.paintGateSymbol=function(a){var b,c,d=a.painter,e=a.gate.symbol,f=a.rect,g="16px Helvetica";f=f.paddedBy(-2);var h=a.gate.gateFamily.length>1&&a.isInToolbox?"↕":void 0,i=e.indexOf("\n");
-1!==i&&(h=e.substring(i+1),e=e.substring(0,i)),void 0!==h&&(a.isInToolbox||a.isHighlighted)&&d.print(h,f.x+f.w,f.y+f.h,"right","bottom","black","12px Helvetica",f.w,f.h);
var j=e.split("^");if(2!==j.length||""===j[0]||""===j[1])return void d.print(e,f.x+f.w/2,f.y+f.h/2,"center","middle","black",g,f.w,f.h);
var k=j,l=(b=k[Symbol.iterator](),(c=b.next()).done?void 0:c.value),m=(c=b.next()).done?void 0:c.value;d.ctx.font=g;var n=d.ctx.measureText(l).width,o=d.ctx.measureText(m).width,p=Math.min(f.w,n+o)/(n+o),q=f.w/2+(n-o)*p/2;
d.print(l,f.x+q,f.y+f.h/2,"right","hanging","black",g,q,f.h),d.print(m,f.x+q,f.y+f.h/2,"left","alphabetic","black",g,f.w-q,f.h)},
f.SECTIONED_DRAWER_MAKER=function(b,d){return function(e){if(e.isInToolbox)return void f.DEFAULT_DRAWER(e);var g=e.isHighlighted?a.HIGHLIGHTED_GATE_FILL_COLOR:a.GATE_FILL_COLOR,h="16px Helvetica";
e.painter.fillRect(e.rect,g);for(var i=0,j=0;j<b.length;j++){var k=void 0;if(j<b.length-1){k=i+d[j];var l=e.rect.y+e.rect.h*k;e.painter.strokeLine(new c(e.rect.x,l),new c(e.rect.right(),l),"#BBB");
}else k=1;e.painter.print(b[j],e.rect.x+e.rect.w/2,e.rect.y+e.rect.h*(i+k)/2,"center","middle","black",h,e.rect.w,e.rect.h*(k-i)),
i=k}e.painter.strokeRect(e.rect),f.paintResizeTab(e)}};var h=f.MAKE_HIGHLIGHTED_DRAWER(a.DISPLAY_GATE_IN_TOOLBOX_FILL_COLOR);return f.makeDisplayDrawer=function(a){
return function(b){return void 0===b.positionInCircuit?void h(b):(f.paintResizeTab(b),a(b),b.isHighlighted&&b.painter.strokeRect(b.rect,"black",1.5),
b.painter.ctx.save(),b.painter.ctx.globalAlpha*=.25,f.paintResizeTab(b),void b.painter.ctx.restore())}},f.MATRIX_DRAWER=function(c){
var d=c.gate.knownMatrixAt(c.stats.time);return void 0===d?void f.DEFAULT_DRAWER(c):(c.painter.fillRect(c.rect,c.isHighlighted?a.HIGHLIGHTED_GATE_FILL_COLOR:a.GATE_FILL_COLOR),
b.paintMatrix(c.painter,d,c.rect,a.OPERATION_FORE_COLOR,"black",void 0,a.OPERATION_BACK_COLOR,void 0,"transparent"),void(c.isHighlighted&&(c.painter.ctx.globalAlpha=.9,
c.painter.fillRect(c.rect,a.HIGHLIGHTED_GATE_FILL_COLOR),c.painter.ctx.globalAlpha=1)))},f.makeCycleDrawer=function(){var a=void 0!==arguments[0]?arguments[0]:1,b=void 0!==arguments[1]?arguments[1]:1,c=void 0!==arguments[2]?arguments[2]:1;
return function(d){if(f.DEFAULT_DRAWER(d),!d.isInToolbox||d.isHighlighted){var g=2*Math.PI,h=e.properMod(-d.stats.time*g*c,g),i=d.rect.center(),j=.4*d.rect.w;
d.painter.ctx.save(),d.painter.ctx.translate(i.x,i.y),d.painter.ctx.scale(a,b),d.painter.ctx.strokeStyle="black",d.painter.ctx.fillStyle="yellow",
d.painter.ctx.globalAlpha=.4,d.painter.ctx.beginPath(),d.painter.ctx.moveTo(0,0),d.painter.ctx.lineTo(0,j),d.painter.ctx.arc(0,0,j,g/4,g/4+h,!0),
d.painter.ctx.lineTo(0,0),d.painter.ctx.closePath(),d.painter.ctx.stroke(),d.painter.ctx.fill(),d.painter.ctx.restore()}}},f.MATRIX_SYMBOL_DRAWER_EXCEPT_IN_TOOLBOX=function(a){
return a.isInToolbox?void f.DEFAULT_DRAWER(a):void f.MATRIX_DRAWER(a)},{get default(){return g}}}),$traceurRuntime.registerModule("src/ui/Hand.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Describe.js","src/ui/Hand.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/ui/Hand.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/ui/Hand.js"))["default"],d=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateColumn.js","src/ui/Hand.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/ui/Hand.js"))["default"]),e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/ui/Hand.js"))["default"],f=function(){
function f(a,e,f,g){if(void 0!==a&&!(a instanceof d))throw new b("Bad pos",{pos:a,heldGate:e,holdOffset:f,resizingGateSlot:g});if(void 0!==e&&!(e instanceof c))throw new b("Bad heldGate",{
pos:a,heldGate:e,holdOffset:f,resizingGateSlot:g});if(void 0!==f&&!(f instanceof d))throw new b("Bad holdOffset",{pos:a,heldGate:e,
holdOffset:f,resizingGateSlot:g});if(void 0!==g&&!(g instanceof d))throw new b("Bad resizingGateSlot",{pos:a,heldGate:e,holdOffset:f,
resizingGateSlot:g});if(void 0!==e&&void 0!==this.resizingGateSlot)throw new b("Holding AND resizing",{pos:a,heldGate:e,holdOffset:f,
resizingGateSlot:g});this.pos=a,this.heldGate=e,this.holdOffset=f,this.resizingGateSlot=g}return $traceurRuntime.createClass(f,{paintCursor:function(a){
void 0!==this.heldGate?a.setDesiredCursor("move"):void 0!==this.resizingGateSlot&&a.setDesiredCursor("ns-resize")},isBusy:function(){
return void 0!==this.heldGate||void 0!==this.resizingGateSlot},hoverPoints:function(){return void 0===this.pos||this.isBusy()?[]:[this.pos];
},isEqualTo:function(a){return this===a?!0:a instanceof f&&e.CUSTOM_IS_EQUAL_TO_EQUALITY(this.pos,a.pos)&&e.CUSTOM_IS_EQUAL_TO_EQUALITY(this.holdOffset,a.holdOffset)&&e.CUSTOM_IS_EQUAL_TO_EQUALITY(this.heldGate,a.heldGate)&&e.CUSTOM_IS_EQUAL_TO_EQUALITY(this.resizingGateSlot,a.resizingGateSlot);
},toString:function(){return"Hand("+a({pos:this.pos,heldGate:this.heldGate,holdOffset:this.holdOffset,resizingGateSlot:this.resizingGateSlot
})},withPos:function(a){return new f(a,this.heldGate,this.holdOffset,this.resizingGateSlot)},withDrop:function(){return new f(this.pos,void 0,void 0,void 0);
},withHeldGate:function(a,b){return new f(this.pos,a,b,void 0)},withResizeSlot:function(a,b){return new f(this.pos,void 0,b,a)},stableDuration:function(){
return void 0===this.heldGate?1/0:this.heldGate.stableDuration()}},{})}(),g=f;return f.EMPTY=new f(void 0,void 0,void 0,void 0),{
get default(){return g}}}),$traceurRuntime.registerModule("src/ui/MathPainter.js",[],function(){"use strict";var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/Painter.js","src/ui/MathPainter.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/ui/MathPainter.js"))["default"]),b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/ui/MathPainter.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/ui/MathPainter.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/ui/MathPainter.js")),e=d.seq,f=d.Seq,g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/ui/MathPainter.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/ui/MathPainter.js"))["default"],i=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/ui/MathPainter.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/ui/MathPainter.js"))["default"]),j=function(){
function d(){}return $traceurRuntime.createClass(d,{},{describeProbability:function(a,b){var c=100*a,d=Math.pow(10,-b);return c>100-d/2?"On":d/2>c?"Off":Math.min(Math.max(c,d),100-d).toFixed(b)+"%";
},paintProbabilityBox:function(a,c,f){var g=void 0!==arguments[3]?arguments[3]:[],i=void 0!==arguments[4]?arguments[4]:h.DISPLAY_GATE_BACK_COLOR,j=void 0!==arguments[5]?arguments[5]:h.DISPLAY_GATE_FORE_COLOR;
a.fillRect(f,i),isNaN(c)?(a.fillPolygon([f.bottomLeft(),f.topLeft(),f.topRight()],j),a.printParagraph("NaN",f,new b(.5,.5),"red")):(a.fillRect(f.takeBottomProportion(c),j),
a.printParagraph(d.describeProbability(c,1),f,new b(.5,.5))),a.strokeRect(f,"lightgray"),e(g).any(function(a){return f.containsPoint(a);
})&&(a.strokeRect(f,"orange",2),d.paintDeferredValueTooltip(a,f.right(),f.y,"Chance of being ON if measured",(100*c).toFixed(5)+"%"));
},paintMatrixTooltip:function(a,b,e,f,g,h){var i=void 0!==arguments[6]?arguments[6]:function(){},j=b.width(),k=b.height(),l=e,m=l.x,n=l.y,o=Math.min(e.w/j,e.h/k),p=!0,q=!1,r=void 0;
try{for(var s=void 0,t=f[Symbol.iterator]();!(p=(s=t.next()).done);p=!0){var u=s.value,v=Math.floor((u.x-m)/o),w=Math.floor((u.y-n)/o);
if(v>=0&&v<b.width()&&w>=0&&w<b.height()){a.strokeRect(new c(m+o*v,n+o*w,o,o),"orange",2);var x=b.cell(v,w);d.paintDeferredValueTooltip(a,m+o*v+o,n+o*w,g(v,w),h(v,w,x),i(v,w,x));
}}}catch(y){q=!0,r=y}finally{try{p||null==t["return"]||t["return"]()}finally{if(q)throw r}}},_traceAmplitudeProbabilitySquare:function(a,b,c,d,e,f){
var g=b*b+c*c;g>.001&&a.polygon([d,e+f*(1-g),d+f,e+f*(1-g),d+f,e+f,d,e+f])},_traceProbabilitySquare:function(a,b,c,d,e,f){var g=b;
f*g>.1&&a.polygon([d,e+f*(1-g),d+f,e+f*(1-g),d+f,e+f,d,e+f])},_traceAmplitudeProbabilityCircle:function(a,b,c,d,e,f){var g=Math.sqrt(b*b+c*c);
f*g>.5&&a.circle(d+f/2,e+f/2,g*f/2)},_traceAmplitudeLogarithmCircle:function(a,b,c,d,e,f){var g=1+Math.log(b*b+c*c)/15;g>0&&a.circle(d+f/2,e+f/2,g*f/2);
},_traceAmplitudePhaseDirection:function(a,b,c,d,e,f){var g=Math.sqrt(b*b+c*c),h=1+Math.log(g)/10,i=Math.max(1,h/g)*Math.max(f/2,8);
if(!(isNaN(g)||.1>i)){var j=d+f/2,k=e+f/2;a.line(j,k,j+b*i,k-c*i)}},paintMatrix:function(a,b,c,e,f,g){var i=void 0!==arguments[6]?arguments[6]:h.DISPLAY_GATE_BACK_COLOR,j=arguments[7],k=void 0!==arguments[8]?arguments[8]:"#AAA",l=b.width(),m=b.height(),n=b.rawBuffer(),o=Math.min(c.w/l,c.h/m),p=c,q=p.x,r=p.y,s=b.hasNaN();
j=j||f,a.fillRect(c,i);var t=function(b){return a.trace(function(a){for(var c=0;m>c;c++)for(var d=0;l>d;d++){var e=2*(c*l+d);b(a,n[e],n[e+1],q+o*d,r+o*c,o);
}})};s||(void 0!==g&&t(d._traceAmplitudeProbabilitySquare).thenFill(g).thenStroke("lightgray",.5),void 0!==e&&(t(d._traceAmplitudeProbabilityCircle).thenFill(e).thenStroke(f,.5),
t(d._traceAmplitudeLogarithmCircle).thenStroke(k,.5)),void 0!==k&&t(d._traceAmplitudePhaseDirection).thenStroke(j)),a.trace(function(a){
return a.grid(q,r,c.w,c.h,l,m)}).thenStroke("lightgray"),s&&a.print("NaN",c.x+c.w/2,c.y+c.h/2,"center","middle","red","16px Helvetica",c.w,c.h);
},paintDeferredValueTooltip:function(a,b,d,e,f){var g=arguments[5],i=void 0!==arguments[6]?arguments[6]:h.DISPLAY_GATE_BACK_COLOR,j="12px Helvetica",k="bold 12px monospace";
a.defer(function(){a.ctx.font=j;var h=a.ctx.measureText(e).width;a.ctx.font=k;var l=a.ctx.measureText(f).width,m=void 0===g?0:a.ctx.measureText(g).width,n=20,o=40+(void 0===g?0:20),p=Math.max(Math.max(h,l),m),q=new c(b,d-o,p,o).snapInside(new c(0,0,a.ctx.canvas.clientWidth,a.ctx.canvas.clientHeight)),r=function(b,d){
var e=new c(q.x,q.bottom()-d,b,d).paddedBy(4);a.trace(function(a){return a.rect(e.x,e.y,e.w,e.h)}).thenFill(i).thenStroke("black");
},s=function(b,c){a.print(e,q.x,q.bottom()-c,"left","bottom","black",j,q.w,n,function(a,d){return r(Math.max(b,a),c+d)})},t=function(b,c){
a.print(f,q.x,q.bottom()-c,"left","bottom","black",k,q.w,n,function(a,d){return s(Math.max(b,a),c+d)})};void 0===g?t(0,0):a.print(g,q.x,q.bottom(),"left","bottom","black",k,q.w,n,t);
})},paintBlochSphereRotation:function(a,c,d){var g,j=void 0!==arguments[3]?arguments[3]:h.DISPLAY_GATE_BACK_COLOR,k=void 0!==arguments[4]?arguments[4]:h.DISPLAY_GATE_FORE_COLOR,l=d.center(),m=Math.min(d.w,d.h)/2,n=i.fromRows([[-m,0],[-m/3,m/3],[0,m]]).adjoint(),o=function(a){
var c=n.times(a);return new b(c.cell(0,0).real,c.cell(0,1).real)},p=f.range(3).map(function(a){return i.generate(1,3,function(b,c){
return b===a?1:0})}).toArray();a.fillCircle(l,m,j),a.trace(function(a){a.circle(l.x,l.y,m),a.ellipse(l.x,l.y,m,m/3),a.ellipse(l.x,l.y,m/3,m);
var b=!0,c=!1,d=void 0;try{for(var e=void 0,f=p[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=o(g);a.line(l.x-h.x,l.y-h.y,l.x+h.x,l.y+h.y);
}}catch(i){c=!0,d=i}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}}).thenStroke("#BBB");var q=c.qubitOperationToAngleAxisRotation(),r=q.angle,s=q.axis,t=(g=i).col.apply(g,$traceurRuntime.spread(s)),u=o(t),v=[i.col(s[0],s[1],0),t,i.col(0,0,s[2])].map(o);
a.strokePolygon(e(v).reverse().concat(v.map(function(a){return a.times(-1)})).map(function(a){return l.plus(a)}).toArray(),"#666"),
a.strokeLine(l.plus(u),l.plus(u.times(-1)),"black",2);var w=function(a){return Math.sqrt(a.adjoint().times(a).cell(0,0).real)},x=e(p).mapWithIndex(function(a,b){
return a.times([2,-3,1][b])}).map(function(a){return t.cross3(a)}).maxBy(w),y=t.cross3(x);x=x.times(.15/w(x)),y=y.times(.15/w(y));
var z=o(x),A=o(y),B=f.range(Math.floor(64*Math.abs(r))).map(function(a){var b=0>r?Math.PI-a/64:a/64;return z.times(Math.cos(b)).plus(A.times(Math.sin(b)));
}).toArray();if(B.length>1){var C=!0,D=!1,E=void 0;try{for(var F=function(){var b=G.value,c=l.plus(u.times(b)),d=B.map(function(a){
return c.plus(a)}),e=d[d.length-1],f=e.plus(d[d.length-2].times(-1)),g=[u.times(.15),f.times(60),u.times(-.15)].map(function(a){return e.plus(a);
});a.strokePath(d,"#444"),a.fillPolygon(g,k),a.strokePolygon(g,"#444")},G=void 0,H=[-.55,0,.55][Symbol.iterator]();!(C=(G=H.next()).done);C=!0)F();
}catch(I){D=!0,E=I}finally{try{C||null==H["return"]||H["return"]()}finally{if(D)throw E}}}},paintDensityMatrix:function(b,c,e){var f=void 0!==arguments[3]?arguments[3]:[],i=void 0!==arguments[4]?arguments[4]:h.DISPLAY_GATE_BACK_COLOR,j=void 0!==arguments[5]?arguments[5]:h.DISPLAY_GATE_FORE_COLOR,k=c.width(),l=c.height(),m=c.rawBuffer(),n=Math.min(e.w/k,e.h/l),o=e.x,p=e.y,q=c.hasNaN(),r=function(a){
return b.trace(function(b){for(var c=0;l>c;c++)for(var d=0;k>d;d++)if(d!==c){var e=2*(c*k+d);a(b,m[e],m[e+1],o+n*d,p+n*c,n)}})},s=function(a){
return b.trace(function(b){for(var c=0;l>c;c++){var d=c*(k+1)*2;a(b,m[d],m[d+1],o+n*c,p+n*c,n)}})};b.fillRect(e,i),q||(s(d._traceProbabilitySquare).thenFill(j).thenStroke("#040",.5),
r(d._traceAmplitudeProbabilityCircle).thenFill(j).thenStroke("#040",.5),r(d._traceAmplitudeLogarithmCircle).thenStroke("#BBB",.5),
r(d._traceAmplitudePhaseDirection).thenStroke("black")),b.trace(function(a){return a.grid(o,p,e.w,e.h,k,l)}).thenStroke("lightgray"),
q&&b.print("NaN",e.x+e.w/2,e.y+e.h/2,"center","middle","red","16px Helvetica",e.w,e.h);var t=Math.round(Math.log2(l));d.paintMatrixTooltip(b,c,e,f,function(a,b){
return a===b?"Probability of |"+g.bin(a,t)+"⟩":"Coupling of |"+g.bin(a,t)+"⟩ to ⟨"+g.bin(b,t)+"|"},function(b,d,e){return b===d?(100*c.cell(b,d).real).toFixed(4)+"%":c.cell(b,d).toString(new a(!1,0,6,", "));
})}})}(),k=j;return{get default(){return k}}}),$traceurRuntime.registerModule("src/ui/Painter.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/ui/Painter.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/ui/Painter.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/ui/Painter.js"))["default"]),c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/ui/Painter.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/RestartableRng.js","src/ui/Painter.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/ui/Painter.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/ui/Painter.js"))["default"],g=function(){
function g(a){var b=void 0!==arguments[1]?arguments[1]:new d;this.canvas=a,this.ctx=a.getContext("2d"),this._deferredPaintActions=[],
this._traceAction=new j(this.ctx),this._tracer=new i(this.ctx),this.desiredCursorStyle=void 0,this.touchBlockers=[],this.rng=b}return $traceurRuntime.createClass(g,{
noteTouchBlocker:function(a){this.touchBlockers.push(a)},setDesiredCursor:function(a){this.desiredCursorStyle=a},defer:function(a){
this._deferredPaintActions.push(a)},paintDeferred:function(){var a=!0,b=!1,c=void 0;try{for(var d=void 0,e=this._deferredPaintActions[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){
var f=d.value;f()}}catch(g){b=!0,c=g}finally{try{a||null==e["return"]||e["return"]()}finally{if(b)throw c}}this._deferredPaintActions=[];
},paintableArea:function(){return new c(0,0,this.canvas.width,this.canvas.height)},clear:function(){var b=void 0!==arguments[0]?arguments[0]:a.DEFAULT_FILL_COLOR;
this.ctx.fillStyle=b,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)},strokeLine:function(b,c){var d=void 0!==arguments[2]?arguments[2]:a.DEFAULT_STROKE_COLOR,e=void 0!==arguments[3]?arguments[3]:1;
this.ctx.beginPath(),this.ctx.moveTo(b.x,b.y),this.ctx.lineTo(c.x,c.y),this.ctx.strokeStyle=d,this.ctx.lineWidth=e,this.ctx.stroke();
},strokeRect:function(a){var b=void 0!==arguments[1]?arguments[1]:"black",c=void 0!==arguments[2]?arguments[2]:1;this.ctx.strokeStyle=b,
this.ctx.lineWidth=c,this.ctx.strokeRect(a.x,a.y,a.w,a.h)},fillRect:function(b){var c=void 0!==arguments[1]?arguments[1]:a.DEFAULT_FILL_COLOR;
this.ctx.fillStyle=c,this.ctx.fillRect(b.x,b.y,b.w,b.h)},strokeCircle:function(b,c){var d=void 0!==arguments[2]?arguments[2]:a.DEFAULT_STROKE_COLOR,e=void 0!==arguments[3]?arguments[3]:a.DEFAULT_STROKE_THICKNESS;
this.ctx.beginPath(),this.ctx.strokeStyle=d,this.ctx.lineWidth=e,this.ctx.arc(b.x,b.y,Math.max(c-.5,0),0,2*Math.PI),this.ctx.stroke();
},trace:function(a){return this.ctx.beginPath(),a(this._tracer),this._traceAction},fillCircle:function(b,c){var d=void 0!==arguments[2]?arguments[2]:a.DEFAULT_FILL_COLOR;
this.ctx.beginPath(),this.ctx.arc(b.x,b.y,Math.max(c-.5,0),0,2*Math.PI),this.ctx.fillStyle=d,this.ctx.fill()},print:function(a,b,c,d,e,f,g,h,i){
var j=arguments[9];this.ctx.font=g;var k=this.ctx.measureText(a).width,l=2.5*this.ctx.measureText("0").width,m=Math.min(Math.min(h/k,i/l),1);
void 0!==j&&j(k*m,l*m),this.ctx.save(),this.ctx.textAlign=d,this.ctx.textBaseline=e,this.ctx.font=g,this.ctx.fillStyle=f,this.ctx.translate(b,c),
this.ctx.scale(m,m),this.ctx.fillText(a,0,0),this.ctx.restore()},printParagraph:function(d,g){for(var h,i,j,k,l=void 0!==arguments[2]?arguments[2]:new b(0,0),m=void 0!==arguments[3]?arguments[3]:a.DEFAULT_TEXT_COLOR,n=void 0!==arguments[4]?arguments[4]:a.DEFAULT_FONT_SIZE,o=void 0!==arguments[5]?arguments[5]:a.DEFAULT_FONT_FAMILY,p=this,q=function(a){
var b=a.fontBoundingBoxAscent;return void 0===b?.75*h:b},r=function(a){var b=a.fontBoundingBoxDescent;return void 0===b?.25*h:b},s=function(a){
return q(a)+r(a)},t=new e(d.split("\n")),u=0;h=n-u,this.ctx.font=h+"px "+o,i=t.flatMap(function(a){return f.breakLine(a,g.w,function(a){
return p.ctx.measureText(a).width})}).toArray(),j=i.map(function(a){return p.ctx.measureText(a)}),k=new e(j).map(s).sum(),!(k<=g.h||4>=h);u++);
var v=function(a,b,c,d){return a+(b-c)*d},w=function(a){return v(g.x,g.w,a,l.x)},x=function(a){return v(g.y,g.h,a,l.y)},y=x(k);this.ctx.fillStyle=m;
for(var z=0,A=0;A<i.length;A++)z+=q(j[A]),this.ctx.fillText(i[A],w(j[A].width),y+z),z+=r(j[A]);var B=new e(j).map(function(a){return a.width;
}).max(0);return new c(w(B),y,B,k)},printLine:function(b,d){for(var e,f,g=void 0!==arguments[2]?arguments[2]:0,h=void 0!==arguments[3]?arguments[3]:a.DEFAULT_TEXT_COLOR,i=void 0!==arguments[4]?arguments[4]:a.DEFAULT_FONT_SIZE,j=void 0!==arguments[5]?arguments[5]:a.DEFAULT_FONT_FAMILY,k=arguments[6],l=function(a){
var b=a.fontBoundingBoxAscent;return void 0===b?.75*e:b},m=function(a){var b=a.fontBoundingBoxDescent;return void 0===b?.25*e:b},n=function(a){
return l(a)+m(a)},o=0;e=i-o,this.ctx.font=e+"px "+j,f=this.ctx.measureText(b),!(f.width<=d.w&&n(f)<=d.h||4>=e);o++);var p=n(f),q=void 0===k?l(f)/p:k,r=function(a,b,c,d){
return a+(b-c)*d},s=r(d.x,d.w,f.width,g),t=r(d.y,d.h,p,q);return this.ctx.fillStyle=h,this.ctx.fillText(b,s,t+l(f)),new c(s,t,f.width,p);
},strokePolygon:function(b){var c=void 0!==arguments[1]?arguments[1]:a.DEFAULT_STROKE_COLOR,d=void 0!==arguments[2]?arguments[2]:a.DEFAULT_STROKE_THICKNESS;
if(0!==b.length){var e=b[b.length-1];this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y);var f=!0,g=!1,h=void 0;try{for(var i=void 0,j=b[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){
var k=i.value;this.ctx.lineTo(k.x,k.y)}}catch(l){g=!0,h=l}finally{try{f||null==j["return"]||j["return"]()}finally{if(g)throw h}}this.ctx.strokeStyle=c,
this.ctx.lineWidth=d,this.ctx.stroke()}},strokePath:function(b){var c=void 0!==arguments[1]?arguments[1]:a.DEFAULT_STROKE_COLOR,d=void 0!==arguments[2]?arguments[2]:a.DEFAULT_STROKE_THICKNESS;
if(0!==b.length){this.ctx.beginPath(),this.ctx.moveTo(b[0].x,b[0].y);var e=!0,f=!1,g=void 0;try{for(var h=void 0,i=b.slice(1)[Symbol.iterator]();!(e=(h=i.next()).done);e=!0){
var j=h.value;this.ctx.lineTo(j.x,j.y)}}catch(k){f=!0,g=k}finally{try{e||null==i["return"]||i["return"]()}finally{if(f)throw g}}this.ctx.strokeStyle=c,
this.ctx.lineWidth=d,this.ctx.stroke()}},fillPolygon:function(a,b){var c=a[a.length-1];this.ctx.beginPath(),this.ctx.moveTo(c.x,c.y);
var d=!0,e=!1,f=void 0;try{for(var g=void 0,h=a[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var i=g.value;this.ctx.lineTo(i.x,i.y);
}}catch(j){e=!0,f=j}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}this.ctx.fillStyle=b,this.ctx.fill()}},{});
}(),h=g,i=function(){function a(a){this.ctx=a}return $traceurRuntime.createClass(a,{line:function(a,b,c,d){this.ctx.moveTo(a,b),this.ctx.lineTo(c,d);
},rect:function(a,b,c,d){this.ctx.moveTo(a,b),this.ctx.lineTo(a+c,b),this.ctx.lineTo(a+c,b+d),this.ctx.lineTo(a,b+d),this.ctx.lineTo(a,b);
},circle:function(a,b,c){this.ctx.moveTo(a+c,b),this.ctx.arc(a,b,c,0,2*Math.PI,!1)},ellipse:function(a,b,c,d){this.ctx.save(),this.ctx.translate(a-c,b-d),
this.ctx.scale(c,d),this.ctx.moveTo(2,1),this.ctx.arc(1,1,1,0,2*Math.PI,!1),this.ctx.restore()},grid:function(a,b,c,d,e,f){for(var g=c/e,h=d/f,i=a+e*g,j=b+f*h,k=0;e>=k;k++)this.ctx.moveTo(a+k*g,b),
this.ctx.lineTo(a+k*g,j);for(var l=0;f>=l;l++)this.ctx.moveTo(a,b+l*h),this.ctx.lineTo(i,b+l*h)},polygon:function(a){if(0!==a.length){
var b=a.length;this.ctx.moveTo(a[b-2],a[b-1]);for(var c=0;b>c;c+=2)this.ctx.lineTo(a[c],a[c+1])}},arrowHead:function(a,b,c,d,e){var f=d+e/2+Math.PI,g=d-e/2+Math.PI;
this.polygon([a+Math.cos(d)*c,b+Math.sin(d)*c,a+Math.cos(f)*c,b+Math.sin(f)*c,a+Math.cos(g)*c,b+Math.sin(g)*c])}},{})}(),j=function(){
function a(a){this.ctx=a}return $traceurRuntime.createClass(a,{thenFill:function(a){return this.ctx.fillStyle=a,this.ctx.fill(),this;
},thenStroke:function(a){var b=void 0!==arguments[1]?arguments[1]:1;return this.ctx.strokeStyle=a,this.ctx.lineWidth=b,this.ctx.stroke(),
this}},{})}();return{get default(){return h}}}),$traceurRuntime.registerModule("src/ui/WidgetPainter.js",[],function(){"use strict";
var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Complex.js","src/ui/WidgetPainter.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/ui/WidgetPainter.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/ui/WidgetPainter.js"))["default"],d=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/Gate.js","src/ui/WidgetPainter.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/ui/WidgetPainter.js"))["default"]),e=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/ui/WidgetPainter.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/Painter.js","src/ui/WidgetPainter.js"))["default"],$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/ui/WidgetPainter.js"))["default"]),f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/ui/WidgetPainter.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/ui/WidgetPainter.js")),h=g.seq,i=g.Seq,j=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/ui/WidgetPainter.js"))["default"],
function(){function g(){}return $traceurRuntime.createClass(g,{},{describeGateTransformations:function(a,b){var d=a.height(),e=Math.round(Math.log2(d));
return i.range(d).map(function(f){var h=g.describeKet(e,f,1,c.SIMPLIFIED),j=a.getColumn(f);if(j.every(function(a){return a.isEqualTo(0);
}))return"discards "+h;if(i.range(d).every(function(a){return j[a].isEqualTo(a===f?1:0)})){if(b!==c.CONSISTENT)return"doesn't affect "+h;
}else if(i.range(d).every(function(a){return a===f||j[a].isEqualTo(0)}))return"phases "+h+" by "+j[f].toString(b);var k=new i(j).mapWithIndex(function(a,c){
return g.describeKet(e,c,a,b)}).filter(function(a){return""!==a}).join(" + ").split(" + -").join(" - ").split(" + +").join(" + ");
return"transforms "+h+" into "+k}).toArray()},paintGateTooltipHelper:function(a,h,j,k){var l,m,n,o,p=[4,65],q=(l=p[Symbol.iterator](),
(m=l.next()).done?void 0:m.value),r=(m=l.next()).done?void 0:m.value,s=[0,q],t=(n=s[Symbol.iterator](),(o=n.next()).done?void 0:o.value),u=(o=n.next()).done?void 0:o.value,v=function(a){
var b=void 0!==arguments[1]?arguments[1]:q;u=Math.max(u,a.bottom()+b),t=Math.max(t,a.right()+b)};v(a.printLine(j.name,new f(q,u,h,18),0,"blue",24)),
v(a.printParagraph(j.blurb,new f(q,u,h,50),new e(0,0),"black",14));var w=j.knownMatrixAt(k);if(j.definitelyHasNoEffect()||void 0===w)return{
maxX:t,maxY:u};v(new f(0,u,1,0),3*q);var x=j.stableDuration()<.2?c.CONSISTENT:c.SIMPLIFIED;v(a.printParagraph("As matrix:",new f(q,u,h,18),new e(0,0),"black",12),0);
var y=new f(q,u,r,r),z=new f(0,y.y,h-q,r).skipLeft(y.right()+q);d.paintMatrix(a,w,y,b.OPERATION_FORE_COLOR,"black",void 0,b.OPERATION_BACK_COLOR,void 0,"transparent"),
v(y);for(var A=w.height(),B=g.describeGateTransformations(w,x),C=z.h/A,D=0;A>D;D++)v(a.printParagraph(B[D],z.skipTop(D*C).takeTop(C),new e(0,.5),"black",12));
if(2===w.width()&&w.isUnitary(.001)){v(a.printParagraph("As rotation:",new f(q,u,h,18),new e(0,0),"black",12),0);var E=w.qubitOperationToAngleAxisRotation(),F=E.angle,G=E.axis,H=E.phase,I=new f(q,u,r,r);
d.paintBlochSphereRotation(a,w,I,b.OPERATION_BACK_COLOR,b.OPERATION_FORE_COLOR),v(I);var J=new i(["rotates: "+x.formatFloat(180*F/Math.PI)+"°","around: "+g.describeAxis(G,x),"","hidden phase: exp("+x.formatFloat(180*H/Math.PI)+"°i)",""]).join("\n");
v(a.printParagraph(J,new f(0,I.y,h-q,r).skipLeft(I.right()+q),new e(0,.5),"black",12))}return{maxX:t,maxY:u}},paintGateTooltip:function(a,b,c,d){
a.ctx.save(),a.ctx.translate(b.x,b.y),b=b.withX(0).withY(0);var e=Math.min(b.w/500,b.h/200);1>e&&(a.ctx.scale(e,e),b=b.withH(b.h/e).withW(b.w/e));
var h=b.w,i=g.paintGateTooltipHelper(a,h,c,d),j=i.maxX,k=i.maxY,l=new f(0,0,j,k);a.fillRect(l,"#F9FFF9"),a.strokeRect(l,"black"),
g.paintGateTooltipHelper(a,h,c,d),a.ctx.restore()},describeKet:function(b,d,e,f){if(e=a.from(e),e.isEqualTo(0))return"";var g=e.isEqualTo(1)?"":e.isEqualTo(-1)?"-":e.isEqualTo(a.I)?"i":e.isEqualTo(a.I.times(-1))?"-i":0!==e.real&&0!==e.imag||f===c.CONSISTENT?"("+e.toString(f)+")·":e.toString(f),i=h(d.toString(2)).reverse().padded(b,"0").join("");
return g+"|"+i+"⟩"},describeAxis:function(a,b){var c=new i(a).map(Math.abs).max();return new i(a).map(function(a){return a/c}).zip(["X","Y","Z"],function(a,c){
return 0===a?"":1===a?c:-1===a?"-"+c:b.formatFloat(a)+"·"+c}).filter(function(a){return""!==a}).join(" + ").replace(" + -"," - ").replace(" + +"," + ");
}})}()),k=j;return{get default(){return k}}}),$traceurRuntime.registerModule("src/webgl/Shaders.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/webgl/Shaders.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/webgl/Shaders.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglContext.js","src/webgl/Shaders.js")).initializedWglContext,d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglShader.js","src/webgl/Shaders.js")),e=d.WglConfiguredShader,f=d.WglShader,g=function(){
function a(){}return $traceurRuntime.createClass(a,{},{})}(),h=g;g.color=function(a,c,d,e){return i.withArgs(b.vec4("color",a,c,d,e));
};var i=new f("\n    uniform vec4 color;\n    void main() {\n        gl_FragColor = color;\n    }");g.passthrough=function(a){return j.withArgs(b.vec2("textureSize",a.width,a.height),b.texture("dataTexture",a,0));
};var j=new f("\n    uniform vec2 textureSize;\n    uniform sampler2D dataTexture;\n    void main() {\n        gl_FragColor = texture2D(dataTexture, gl_FragCoord.xy / textureSize.xy);\n    }");
g.coords=new f("\n    void main() {\n        gl_FragColor = vec4(gl_FragCoord.x-0.5, gl_FragCoord.y-0.5, 0.0, 0.0);\n    }").withArgs(),
g.data=function(d){return new e(function(e){var f,g,h=[e.width,e.height],i=(f=h[Symbol.iterator](),(g=f.next()).done?void 0:g.value),k=(g=f.next()).done?void 0:g.value;
a.need(d.length===i*k*4,"rgbaData.length === w * h * 4");var l=WebGLRenderingContext,m=c().gl,n=m.createTexture();try{m.bindTexture(WebGLRenderingContext.TEXTURE_2D,n),
m.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),m.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),m.texImage2D(l.TEXTURE_2D,0,l.RGBA,i,k,0,l.RGBA,l.FLOAT,d),
j.withArgs(b.vec2("textureSize",i,k),b.webGlTexture("dataTexture",n,0)).renderTo(e)}finally{m.deleteTexture(n)}})},g.scale=function(a,c){
return k.withArgs(b.vec2("textureSize",a.width,a.height),b.texture("inputTexture",a,0),b["float"]("factor",c))};var k=new f("\n    uniform vec2 textureSize;\n    uniform sampler2D inputTexture;\n    uniform float factor;\n    void main() {\n        gl_FragColor = texture2D(inputTexture, gl_FragCoord.xy / textureSize.xy) * factor;\n    }");
g.sumFold=function(a,c,d){return l.withArgs(b.vec2("inputSize",a.width,a.height),b.vec2("offset",c,d),b.texture("inputTexture",a,0));
};var l=new f("\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform vec2 offset;\n    void main() {\n        vec2 uv0 = gl_FragCoord.xy / inputSize;\n        vec2 uv1 = uv0 + offset / inputSize;\n        gl_FragColor = texture2D(inputTexture, uv0) + texture2D(inputTexture, uv1);\n    }");
g.encodeFloatsIntoBytes=function(c){return new e(function(d){a.need(c.pixelType===WebGLRenderingContext.FLOAT,"input tex should have floats"),
a.need(d.pixelType===WebGLRenderingContext.UNSIGNED_BYTE,"output tex should take bytes"),a.need(d.width===2*c.width&&d.height===2*c.height,"output tex should be double the width and height of the input"),
m.withArgs(b.texture("inputTexture",c,0),b.vec2("inputSize",c.width,c.height),b["float"]("outputWidth",d.width)).renderTo(d)})};var m=new f("\n    uniform vec2 inputSize;\n    uniform sampler2D inputTexture;\n    uniform float outputWidth;\n\n    vec2 toUv(float state) {\n        return vec2(mod(state, inputSize.x) + 0.5, floor(state / inputSize.x) + 0.5) / inputSize;\n    }\n\n    /**\n     * Encodes a single-precision float into four bytes.\n     * The format used is similar to the standard IEEE 754 format, except the sign bit is on the opposite end.\n     * Also, zero is represented as all-1s because NaN is hard to detect and ends up all-0s.\n     */\n    vec4 encode_float(float val) {\n        float sign = val > 0.0 ? 0.0 : 1.0;\n\n        if (val == 0.0) return vec4(1.0, 1.0, 1.0, 1.0); // Zero\n        if (val*2.0 == val) return vec4(1.0, 0.0, 0.0, sign/255.0); // Infinity\n\n        val = abs(val);\n        float exponent = floor(log2(val));\n        if (pow(2.0, exponent) > val) {\n            // On my machine this happens for val=0.2499999850988388\n            exponent = floor(exponent - 0.5);\n        }\n        float mantissa = val * exp2(-exponent) - 1.0;\n\n        float a = exponent + 127.0;\n        float b = floor(mantissa * 256.0);\n        float c = floor(mod(mantissa * 65536.0, 256.0));\n        float d = floor(mod(mantissa * 8388608.0, 128.0)) * 2.0 + sign;\n        return vec4(a, b, c, d) / 255.0;\n    }\n\n    void main() {\n        vec2 xy = gl_FragCoord.xy - vec2(0.5, 0.5);\n        float state = xy.y * outputWidth + xy.x;\n        float inputState = floor(state / 4.0);\n        float c = mod(state, 4.0);\n        vec4 v = texture2D(inputTexture, toUv(inputState));\n        float f = c == 0.0 ? v.x\n                : c == 1.0 ? v.y\n                : c == 2.0 ? v.z\n                : v.w;\n        gl_FragColor = encode_float(f);\n    }"),n=function(a,b,c,d){
if(0===a&&0===b&&0===c&&0===d)return NaN;if(255===a&&255===b&&255===c&&255===d)return 0;if(255===a&&0===b&&0===c&&0===d)return 1/0;
if(255===a&&0===b&&0===c&&1===d)return-(1/0);var e=a-127,f=1&d,g=1+(b/256+c/65536+(d-f)/16777216);return g*Math.pow(2,e)*(1===f?-1:1);
};return g.decodeByteBufferToFloatBuffer=function(a){for(var b=new Float32Array(a.length/4),c=0;c<b.length;c++){var d=c<<2;b[c]=n(a[d],a[d+1],a[d+2],a[d+3]);
}return b},{get default(){return h}}}),$traceurRuntime.registerModule("src/webgl/WglArg.js",[],function(){"use strict";var a=function(){
function a(a,b,c){this.type=a,this.name=b,this.value=c}return $traceurRuntime.createClass(a,{toString:function(){return this.type+" "+this.name+" = "+JSON.stringify(this.value);
}},{bool:function(b,c){return new a(a.BOOL_TYPE,b,c)},"float":function(b,c){return new a(a.FLOAT_TYPE,b,c)},"int":function(b,c){return new a(a.INT_TYPE,b,c);
},vec2:function(b,c,d){return new a(a.VEC2_TYPE,b,[c,d])},vec4:function(b,c,d,e,f){return new a(a.VEC4_TYPE,b,[c,d,e,f])},mat4:function(b,c){
return new a(a.MAT4_TYPE,b,c)},texture:function(b,c,d){return new a(a.WGL_TEXTURE_TYPE,b,{texture:c,unit:d})},webGlTexture:function(b,c,d){
return new a(a.WEB_GL_TEXTURE_TYPE,b,{texture:c,unit:d})}})}(),b=a;return a.BOOL_TYPE="bool",a.FLOAT_TYPE="float",a.INT_TYPE="int",
a.VEC2_TYPE="vec2",a.VEC4_TYPE="vec4",a.MAT4_TYPE="mat4",a.WGL_TEXTURE_TYPE="wgl_texture",a.WEB_GL_TEXTURE_TYPE="web_gl_texture",
a.INPUT_ACTION_MAP=new Map([[a.BOOL_TYPE,function(a,b,c){return a.gl.uniform1f(b,c?1:0)}],[a.INT_TYPE,function(a,b,c){return a.gl.uniform1i(b,c);
}],[a.FLOAT_TYPE,function(a,b,c){return a.gl.uniform1f(b,c)}],[a.VEC2_TYPE,function(a,b,c){var d,e,f=c,g=(d=f[Symbol.iterator](),
(e=d.next()).done?void 0:e.value),h=(e=d.next()).done?void 0:e.value;return a.gl.uniform2f(b,g,h)}],[a.VEC4_TYPE,function(a,b,c){
var d,e,f=c,g=(d=f[Symbol.iterator](),(e=d.next()).done?void 0:e.value),h=(e=d.next()).done?void 0:e.value,i=(e=d.next()).done?void 0:e.value,j=(e=d.next()).done?void 0:e.value;
return a.gl.uniform4f(b,g,h,i,j)}],[a.MAT4_TYPE,function(a,b,c){return a.gl.uniformMatrix4fv(b,!1,c)}],[a.WGL_TEXTURE_TYPE,function(a,b,c){
var d=c,e=d.unit,f=d.texture;if(e>=a.maxTextureUnits)throw new Error("Uniform texture argument uses texture unit "+e+" but max "+("is "+a.maxTextureUnits+"."));
if(f.width>a.maxTextureSize||f.height>a.maxTextureSize)throw new Error("Uniform texture argument is "+f.width+"x"+f.height+", but max "+("texture diameter is "+a.maxTextureSize+"."));
var g=a.gl;g.uniform1i(b,e),g.activeTexture(WebGLRenderingContext.TEXTURE0+e),g.bindTexture(WebGLRenderingContext.TEXTURE_2D,f.initializedTexture());
}],[a.WEB_GL_TEXTURE_TYPE,function(a,b,c){var d=c,e=d.unit,f=d.texture;if(e>=a.maxTextureUnits)throw new Error("Uniform texture argument uses texture unit "+e+" but max "+("is "+a.maxTextureUnits+"."));
var g=a.gl;g.uniform1i(b,e),g.activeTexture(WebGLRenderingContext.TEXTURE0+e),g.bindTexture(WebGLRenderingContext.TEXTURE_2D,f)}]]),
{get default(){return b}}}),$traceurRuntime.registerModule("src/webgl/WglContext.js",[],function(){"use strict";function a(){return void 0===d&&(d=new c),
d}var b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/webgl/WglContext.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglMortalValueSlot.js","src/webgl/WglContext.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglUtil.js","src/webgl/WglContext.js"))),c=(b.checkGetErrorResult,
b.checkFrameBufferStatusResult,function(){function a(){var a=this;if(this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl"),
null===this.gl)throw new Error("Error creating WebGL context.");if(void 0===this.gl.getExtension("OES_texture_float"))throw new Error("OES_texture_float webgl extension not present.");
this.onContextRestored=void 0,this.lifetimeCounter=0,this.canvas.addEventListener("webglcontextrestored",function(b){b.preventDefault(),
a.recomputeProperties(),void 0!==a.onContextRestored&&a.onContextRestored()},!1),this.canvas.addEventListener("webglcontextlost",function(b){
b.preventDefault(),a.lifetimeCounter++},!1),this.recomputeProperties()}return $traceurRuntime.createClass(a,{recomputeProperties:function(){
this.lifetimeCounter++,this.maxTextureUnits=this.gl.getParameter(WebGLRenderingContext.MAX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=this.gl.getParameter(WebGLRenderingContext.MAX_TEXTURE_SIZE),
this.maximumShaderFloatPrecision=this._getMaximumShaderFloatPrecision()},_getMaximumShaderFloatPrecision:function(){var a=this.gl,b=WebGLRenderingContext,c=function(c,d){
var e=a.getShaderPrecisionFormat(c,d);return a.getError()===b.NO_ERROR&&void 0!==e&&null!==e&&e.precision>0},d=c(b.VERTEX_SHADER,b.HIGH_FLOAT)&&c(b.FRAGMENT_SHADER,b.HIGH_FLOAT);
if(d)return"highp";console.warn("WebGL high precision not available.");var e=c(b.VERTEX_SHADER,b.MEDIUM_FLOAT)&&c(b.FRAGMENT_SHADER,b.MEDIUM_FLOAT);
return e?"mediump":(console.warn("WebGL medium precision not available."),"lowp")}},{})}()),d=void 0;return{get initializedWglContext(){
return a}}}),$traceurRuntime.registerModule("src/webgl/WglMortalValueSlot.js",[],function(){"use strict";var a=function(){function a(a,b){
this.initializer=a,this.deinitializer=b,this.lifetimeId=void 0,this.mortalValue=void 0}return $traceurRuntime.createClass(a,{initializedValue:function(a){
return this.lifetimeId!==a&&(this.lifetimeId=a,this.mortalValue=this.initializer()),this.mortalValue},ensureInitialized:function(a){
this.initializedValue(a)},ensureDeinitialized:function(){if(void 0!==this.lifetimeId){var a=this.mortalValue;this.lifetimeId=void 0,
this.mortalValue=void 0,this.deinitializer(a)}}},{})}(),b=a;return{get default(){return b}}}),$traceurRuntime.registerModule("src/webgl/WglShader.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/webgl/WglShader.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/webgl/WglShader.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/webgl/WglShader.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglContext.js","src/webgl/WglShader.js")).initializedWglContext,e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglMortalValueSlot.js","src/webgl/WglShader.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglTexture.js","src/webgl/WglShader.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglUtil.js","src/webgl/WglShader.js")),h=g.checkGetErrorResult,i=g.checkFrameBufferStatusResult,j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/webgl/WglShader.js")),k=(j.seq,
j.Seq),l=new e(function(){var a=WebGLRenderingContext,b=d().gl,c=b.createBuffer(),e=new Float32Array([-1,1,1,1,-1,-1,1,-1]);b.bindBuffer(a.ARRAY_BUFFER,c),
b.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW);var f=b.createBuffer(),g=new Uint16Array([0,2,1,2,3,1]);return b.bindBuffer(a.ELEMENT_ARRAY_BUFFER,f),
b.bufferData(a.ELEMENT_ARRAY_BUFFER,g,a.STATIC_DRAW),{positionBuffer:c,indexBuffer:f}},function(){}),m=function(){function a(a){this.fragmentShaderSource=a,
this._compiledShaderSlot=void 0}return $traceurRuntime.createClass(a,{withArgs:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];
var c=this;if(void 0===this._compiledShaderSlot){var f=a.map(function(a){return a.name});this._compiledShaderSlot=new e(function(){
return new n(c.fragmentShaderSource,f)},function(a){return a.free()})}return new o(function(b){if(0!==b.width&&0!==b.height){var e=WebGLRenderingContext,f=d(),g=f.gl;
l.ensureInitialized(f.lifetimeCounter),g.bindFramebuffer(e.FRAMEBUFFER,b.initializedFramebuffer()),h(g,"framebufferTexture2D",!0),
i(g,!0),c._compiledShaderSlot.initializedValue(f.lifetimeCounter).useWithArgs(a),g.viewport(0,0,b.width,b.height),g.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),
h(g,"drawElements",!0),b.markRendered()}})},toString:function(){return"WglShader(fragmentShaderSource: "+this.fragmentShaderSource+")";
}},{})}(),n=function(){function e(b,c){var f=d(),g=f.maximumShaderFloatPrecision,h="\n            precision "+g+" float;\n            precision "+g+" int;\n            attribute vec2 position;\n            void main() {\n              gl_Position = vec4(position, 0, 1);\n            }",i="\n            precision "+g+" float;\n            precision "+g+" int;\n            "+b,j=WebGLRenderingContext,l=f.gl,m=e.compileShader(l,j.VERTEX_SHADER,h),n=e.compileShader(l,j.FRAGMENT_SHADER,i),o=l.createProgram();
l.attachShader(o,m),l.attachShader(o,n),l.linkProgram(o);var p=l.getProgramInfoLog(o);if(""!==p&&a.SUPPRESSED_GLSL_WARNING_PATTERNS.every(function(a){
return!a.test(p)})&&console.warn("gl.getProgramInfoLog()",p),l.getProgramParameter(o,j.LINK_STATUS)===!1)throw new Error("Failed to link shader program.\n\ngl.VALIDATE_STATUS: "+l.getProgramParameter(o,j.VALIDATE_STATUS)+"\ngl.getError(): "+l.getError());
l.deleteShader(m),l.deleteShader(n),this.uniformLocations=new k(c).toMap(function(a){return a},function(a){return l.getUniformLocation(o,a);
}),this.positionAttributeLocation=l.getAttribLocation(o,"position"),this.program=o}return $traceurRuntime.createClass(e,{useWithArgs:function(a){
var e=d(),f=e.gl;f.useProgram(this.program);var g=!0,h=!1,i=void 0;try{for(var j=void 0,k=a[Symbol.iterator]();!(g=(j=k.next()).done);g=!0){
var l=j.value,m=this.uniformLocations.get(l.name);if(void 0===m)throw new b("Unexpected uniform argument",{arg:l,uniformArgs:a});c.INPUT_ACTION_MAP.get(l.type)(e,m,l.value);
}}catch(n){h=!0,i=n}finally{try{g||null==k["return"]||k["return"]()}finally{if(h)throw i}}f.enableVertexAttribArray(this.positionAttributeLocation),
f.vertexAttribPointer(this.positionAttributeLocation,2,WebGLRenderingContext.FLOAT,!1,0,0)},free:function(){var a=d().gl;a.deleteProgram(this.program);
}},{compileShader:function(a,b,c){var d=a.createShader(b);if(a.shaderSource(d,c),a.compileShader(d),""!==a.getShaderInfoLog(d)&&(console.warn("WebGLShader: gl.getShaderInfoLog()",a.getShaderInfoLog(d)),
console.warn(c)),a.getShaderParameter(d,WebGLRenderingContext.COMPILE_STATUS)===!1)throw new Error("WebGLShader: Shader compile failed: "+c+" "+a.getError());
return d}})}(),o=function(){function a(a){this.renderToFunc=a}return $traceurRuntime.createClass(a,{renderTo:function(b){var c=this.renderToFunc(b);
if(c instanceof a)throw new Error("Returned a WglConfiguredShader instead of calling renderTo on it.")},toFloatTexture:function(a,b){
var c=new f(a,b);return this.renderTo(c),c},readFloatOutputs:function(a,b){var c=new f(a,b);try{return this.renderTo(c),c.readPixels();
}finally{c.ensureDeinitialized()}},readByteOutputs:function(a,b){var c=new f(a,b,WebGLRenderingContext.UNSIGNED_BYTE);this.renderTo(c);
var d=c.readPixels();return c.ensureDeinitialized(),d}},{})}(),p=m;return{get default(){return p},get WglShader(){return m},get WglConfiguredShader(){
return o}}}),$traceurRuntime.registerModule("src/webgl/WglTexture.js",[],function(){"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/webgl/WglTexture.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/webgl/WglTexture.js"))["default"],c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglArg.js","src/webgl/WglTexture.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglMortalValueSlot.js","src/webgl/WglTexture.js"))["default"]),d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglContext.js","src/webgl/WglTexture.js")).initializedWglContext,e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/webgl/WglUtil.js","src/webgl/WglTexture.js")),f=e.checkGetErrorResult,g=e.checkFrameBufferStatusResult,h=function(){
function e(d,f){var g=void 0!==arguments[2]?arguments[2]:WebGLRenderingContext.FLOAT,h=this;if(0===d&&0===f)return this.width=0,this.height=0,
this.pixelType=g,this._hasBeenRenderedTo=!0,void(this._textureAndFrameBufferSlot=new c(function(){throw new a("Touched a zero-size texture.",h);
},function(){throw new a("Touched a zero-size texture.",h)}));if(!b.isPowerOf2(d)||!b.isPowerOf2(f))throw new a("Sizes must be a power of 2.",{
width:d,height:f,pixelType:g});this.width=d,this.height=f,this.pixelType=g,this._hasBeenRenderedTo=!1,this._textureAndFrameBufferSlot=new c(function(){
return h._textureAndFramebufferInitializer()},function(a){return e._deinitialize(a)})}return $traceurRuntime.createClass(e,{markRendered:function(){
this._hasBeenRenderedTo=!0},invalidateButMoveToNewInstance:function(b){var d=new e(this.width,this.height,this.pixelType);d._textureAndFrameBufferSlot=this._textureAndFrameBufferSlot;
var f=function(){throw new a("WglTexture's value accessed after invalidation.",b)};return this._textureAndFrameBufferSlot=new c(f,f),
d},initializedTexture:function(){if(!this._hasBeenRenderedTo)throw new Error("Called initializedTexture on a texture that hasn't been rendered to.");
return this._textureAndFrameBufferSlot.initializedValue(d().lifetimeCounter).texture},initializedFramebuffer:function(){return this._textureAndFrameBufferSlot.initializedValue(d().lifetimeCounter).framebuffer;
},ensureDeinitialized:function(){this._textureAndFrameBufferSlot.ensureDeinitialized()},_textureAndFramebufferInitializer:function(){
var a=WebGLRenderingContext,b=d().gl,c={texture:b.createTexture(),framebuffer:b.createFramebuffer()};b.bindTexture(a.TEXTURE_2D,c.texture),
b.bindFramebuffer(a.FRAMEBUFFER,c.framebuffer);try{b.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),b.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),
b.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),b.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),b.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,this.pixelType,null),
f(b,"texImage2D"),b.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c.texture,0),f(b,"framebufferTexture2D"),
g(b)}finally{b.bindTexture(a.TEXTURE_2D,null),b.bindFramebuffer(a.FRAMEBUFFER,null)}return c},readPixels:function(){var a=WebGLRenderingContext;
if(!this._hasBeenRenderedTo)throw new Error("Called readPixels on a texture that hasn't been rendered to.");var b;switch(this.pixelType){
case a.UNSIGNED_BYTE:b=new Uint8Array(this.width*this.height*4);break;case a.FLOAT:b=new Float32Array(this.width*this.height*4);break;
default:throw new Error("Unrecognized pixel type.")}if(0===this.width||0===this.height)return b;var c=d().gl;return c.bindFramebuffer(a.FRAMEBUFFER,this.initializedFramebuffer()),
f(c,"framebufferTexture2D",!0),g(c,!0),c.readPixels(0,0,this.width,this.height,a.RGBA,this.pixelType,b),f(c,"readPixels(..., RGBA, "+this.pixelType+", ...)",!0),
b}},{_deinitialize:function(a){var b=a,c=b.texture,e=b.framebuffer,f=d().gl;f.deleteTexture(c),f.deleteFramebuffer(e)}})}(),i=h;return{
get default(){return i}}}),$traceurRuntime.registerModule("src/webgl/WglUtil.js",[],function(){"use strict";function a(a,b){var d,e=void 0!==arguments[2]?arguments[2]:!1;
if(!e||c.CHECK_WEB_GL_ERRORS_EVEN_ON_HOT_PATHS){var f=a.getError(),g=WebGLRenderingContext;if(f!==g.NO_ERROR){var h=(d={},Object.defineProperty(d,1280,{
value:"INVALID_ENUM [+constant not found]",configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,1281,{value:"INVALID_VALUE [+constant not found]",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,1282,{value:"INVALID_OPERATION [+constant not found]",configurable:!0,
enumerable:!0,writable:!0}),Object.defineProperty(d,1285,{value:"OUT_OF_MEMORY [+constant not found]",configurable:!0,enumerable:!0,
writable:!0}),Object.defineProperty(d,1286,{value:"INVALID_FRAMEBUFFER_OPERATION [+constant not found]",configurable:!0,enumerable:!0,
writable:!0}),Object.defineProperty(d,37442,{value:"CONTEXT_LOST_WEBGL [+constant not found]",configurable:!0,enumerable:!0,writable:!0
}),Object.defineProperty(d,g.INVALID_ENUM,{value:"INVALID_ENUM",configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,g.INVALID_VALUE,{
value:"INVALID_VALUE",configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,g.INVALID_OPERATION,{value:"INVALID_OPERATION",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(d,g.OUT_OF_MEMORY,{value:"OUT_OF_MEMORY",configurable:!0,enumerable:!0,
writable:!0}),Object.defineProperty(d,g.INVALID_FRAMEBUFFER_OPERATION,{value:"INVALID_FRAMEBUFFER_OPERATION",configurable:!0,enumerable:!0,
writable:!0}),Object.defineProperty(d,g.CONTEXT_LOST_WEBGL,{value:"CONTEXT_LOST_WEBGL",configurable:!0,enumerable:!0,writable:!0}),
d),i=void 0!==h[f]?h[f]:"?";throw new Error("gl.getError() returned 0x"+f.toString(16)+" ("+i+") after "+b+".")}}}function b(a){var b,d=void 0!==arguments[1]?arguments[1]:!1;
if(!d||c.CHECK_WEB_GL_ERRORS_EVEN_ON_HOT_PATHS){var e=WebGLRenderingContext,f=a.checkFramebufferStatus(e.FRAMEBUFFER);if(f!==e.FRAMEBUFFER_COMPLETE){
var g=(b={},Object.defineProperty(b,0,{value:"Argument wasn't a frame buffer",configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,1280,{
value:"INVALID_ENUM [+constant not found]",configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,36054,{value:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT [+constant not found]",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,36055,{value:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT [+constant not found]",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,36057,{value:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS [+constant not found]",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,36061,{value:"FRAMEBUFFER_UNSUPPORTED [+constant not found]",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,e.INVALID_ENUM,{value:"INVALID_ENUM",configurable:!0,enumerable:!0,
writable:!0}),Object.defineProperty(b,e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,{value:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",configurable:!0,
enumerable:!0,writable:!0}),Object.defineProperty(b,e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT,{value:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,{value:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",
configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(b,e.FRAMEBUFFER_UNSUPPORTED,{value:"FRAMEBUFFER_UNSUPPORTED",configurable:!0,
enumerable:!0,writable:!0}),b),h=void 0!==g[f]?g[f]:"?";throw new Error("gl.checkFramebufferStatus() returned 0x"+f.toString(16)+" ("+h+").");
}}}var c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/webgl/WglUtil.js"))["default"];return{
get checkGetErrorResult(){return a},get checkFrameBufferStatusResult(){return b}}}),$traceurRuntime.registerModule("src/widgets/DisplayedCircuit.js",[],function(){
"use strict";var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitDefinition.js","src/widgets/DisplayedCircuit.js"))["default"],b=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitStats.js","src/widgets/DisplayedCircuit.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/widgets/DisplayedCircuit.js"))["default"]),c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/DetailedError.js","src/widgets/DisplayedCircuit.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Equate.js","src/widgets/DisplayedCircuit.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Format.js","src/widgets/DisplayedCircuit.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateColumn.js","src/widgets/DisplayedCircuit.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GateDrawParams.js","src/widgets/DisplayedCircuit.js"))["default"],h=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/widgets/DisplayedCircuit.js"))["default"],i=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AllGates.js","src/widgets/DisplayedCircuit.js"))["default"],j=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/widgets/DisplayedCircuit.js"))["default"],k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/widgets/DisplayedCircuit.js"))["default"],l=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/widgets/DisplayedCircuit.js"))["default"],m=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/widgets/DisplayedCircuit.js"))["default"],n=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/widgets/DisplayedCircuit.js"))["default"],o=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/widgets/DisplayedCircuit.js")),p=o.seq,q=o.Seq,r=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/BlochSphereDisplay.js","src/widgets/DisplayedCircuit.js")).paintBlochSphereDisplay,s=10,t=35,u=function(){
function o(b,d,e,f,g){if(!Number.isFinite(b))throw new c("Bad top",{top:b,circuitDefinition:d});if(!(d instanceof a))throw new c("Bad circuitDefinition",{
top:b,circuitDefinition:d});this.top=b,this.circuitDefinition=d,this._compressedColumnIndex=e,this._highlightedSlot=f,this._extraWireStartIndex=g;
}return $traceurRuntime.createClass(o,{desiredWidth:function(){var a=this.opRect(this.circuitDefinition.columns.length+1+2+1);return a.x+this.height()+5;
},wireRect:function(a){if(0>a)throw new c("Bad wireIndex",{wireIndex:a});return new m(0,this.top+b.WIRE_SPACING*a,1/0,b.WIRE_SPACING);
},wireIndexAt:function(a){return Math.floor((a-this.top)/b.WIRE_SPACING)},toColumnSpaceCoordinate:function(a){var c=s+2*b.GATE_RADIUS,d=t-s/2;
return(a-d)/c-.5},indexOfDisplayedRowAt:function(a){var c=Math.floor((a-this.top)/b.WIRE_SPACING);if(!(0>c||c>=this.circuitDefinition.numWires))return c;
},indexOfDisplayedColumnAt:function(a){var b,c=this.toColumnSpaceCoordinate(a);return b=void 0===this._compressedColumnIndex||c<this._compressedColumnIndex-.75?Math.round(c):c<this._compressedColumnIndex-.25?this._compressedColumnIndex:Math.round(c)-1,
0>b||b>=this.circuitDefinition.columns.length?void 0:b},findOpHalfColumnAt:function(a){return a.x<0||a.y<top||a.y>top+this.height()?void 0:Math.max(-.5,Math.round(2*this.toColumnSpaceCoordinate(a.x))/2);
},findModificationIndex:function(a){if(void 0!==a.pos&&void 0!==a.heldGate){var c=a.pos.minus(a.holdOffset).plus(new k(b.GATE_RADIUS,b.GATE_RADIUS)),d=this.findOpHalfColumnAt(c),e=this.indexOfDisplayedRowAt(c.y);
if(void 0!==d&&void 0!==e){var f=Math.ceil(d),g=.5===Math.abs(d%1);if(f>=this.circuitDefinition.columns.length)return{col:f,row:e,
isInsert:g};if(!g){var h=this.circuitDefinition.isSlotRectCoveredByGateInSameColumn(f,e,a.heldGate.height);if(h){var i=a.pos.x>this.opRect(f).center().x;
g=!0,i&&(f+=1)}}return{col:f,row:e,isInsert:g}}}},opRect:function(a){var c=2*b.GATE_RADIUS,d=c+s,e=0;void 0!==this._compressedColumnIndex&&a===this._compressedColumnIndex&&(e=d/2),
void 0!==this._compressedColumnIndex&&a>this._compressedColumnIndex&&(e=d);var f=d*a-e+t;return new m(f,this.top,c,this.height());
},height:function(){return o.desiredHeight(this.circuitDefinition.numWires)},gateRect:function(a,c){var d=void 0!==arguments[2]?arguments[2]:1,e=void 0!==arguments[3]?arguments[3]:1,f=this.opRect(c),g=this.wireRect(a),h=new m(f.center().x-b.GATE_RADIUS,g.center().y-b.GATE_RADIUS,2*b.GATE_RADIUS+(d-1)*b.WIRE_SPACING,2*b.GATE_RADIUS+(e-1)*b.WIRE_SPACING);
return new m(Math.round(h.x-.5)+.5,Math.round(h.y-.5)+.5,Math.round(h.w),Math.round(h.h))},afterTidyingUp:function(){return this.withCircuit(this.circuitDefinition.withUncoveredColumnsRemoved().withHeightOverlapsFixed().withWidthOverlapsFixed().withUncoveredColumnsRemoved().withTrailingSpacersIncluded())._withCompressedColumnIndex(void 0)._withExtraWireStartIndex(void 0)._withHighlightedSlot(void 0);
},isEqualTo:function(a){return this===a?!0:a instanceof o&&this.top===a.top&&this.circuitDefinition.isEqualTo(a.circuitDefinition)&&this._compressedColumnIndex===a._compressedColumnIndex&&this._extraWireStartIndex===a._extraWireStartIndex&&d(this._highlightedSlot,a._highlightedSlot);
},paint:function(a,c,d,e){a.fillRect(new m(0,this.top,this.height(),a.canvas.clientWidth,b.BACKGROUND_COLOR_CIRCUIT)),this._drawWires(a);
for(var f=0;f<this.circuitDefinition.columns.length;f++)this._drawColumn(a,this.circuitDefinition.columns[f],f,c,d,e);this._drawOutputDisplays(a,d,c);
},_drawWires:function(a){for(var c=this,d=Math.min(this.circuitDefinition.numWires,(this._extraWireStartIndex||1/0)+1),e=0;d>e;e++){
var f=this.wireRect(e),g=f.center().y;a.print("|0⟩",20,g,"right","middle","black","14px Helvetica",20,b.WIRE_SPACING)}a.ctx.save();
for(var h=this,i=function(b){b===h._extraWireStartIndex&&(a.ctx.globalAlpha=.5),a.trace(function(d){for(var e=c.wireRect(b),f=Math.round(e.center().y-.5)+.5,g=25,h=0;g<a.canvas.width;h++){
var i=c.opRect(h).center().x;c.circuitDefinition.locIsMeasured(new k(h,b))?(d.line(g,f-1,i,f-1),d.line(g,f+1,i,f+1)):d.line(g,f,i,f),
g=i}}).thenStroke("black")},j=0;d>j;j++)i(j);a.ctx.restore(),void 0!==this._extraWireStartIndex&&this.circuitDefinition.numWires===b.MAX_WIRE_COUNT&&a.print("(Max wires. Qubit limit is "+b.MAX_WIRE_COUNT+".)",5,this.wireRect(b.MAX_WIRE_COUNT).y,"left","top","red","16px bold monospace",400,b.WIRE_SPACING);
},_highlightStatusAt:function(a,b,c){var d=this;if(void 0!==this._highlightedSlot&&this._highlightedSlot.col===a&&this._highlightedSlot.row===b)return{
isResizeShowing:!0,isResizeHighlighted:this._highlightedSlot.resizeStyle,isHighlighted:!this._highlightedSlot.resizeStyle};var e=this.circuitDefinition.gateInSlot(a,b);
if(void 0===e||void 0!==this._highlightedSlot)return{isResizeShowing:!1,isResizeHighlighted:!1,isHighlighted:!1};var f=this.gateRect(b,a,e.width,e.height),g=h.rectForResizeTab(f),i=function(c){
var e=d.findGateOverlappingPos(c);return void 0!==e&&e.col===a&&e.row===b},j=function(c){var e=d.findGateOverlappingPos(c);return void 0===e||e.col===a&&e.row===b;
},k=function(a){return j(a)&&g.containsPoint(a)},l=e.canChangeInSize()&&p(c).any(k),m=!l&&p(c).any(i),n=e.canChangeInSize()&&(l||m);
return{isHighlighted:m,isResizeShowing:n,isResizeHighlighted:l}},_drawColumn:function(a,b,c,d,e){this._drawColumnControlWires(a,b,c,e);
for(var f=this._highlightedSlot,i=0;i<this.circuitDefinition.numWires;i++)if(null!==b.gates[i]){var j=b.gates[i],l=this.gateRect(i,c,j.width,j.height),m=this._highlightStatusAt(c,i,d.hoverPoints()),n=m.isHighlighted,o=m.isResizeShowing,p=m.isResizeHighlighted,q=j.customDrawer||h.DEFAULT_DRAWER;
a.noteTouchBlocker({rect:l,cursor:"pointer"}),j.canChangeInSize()&&a.noteTouchBlocker({rect:h.rectForResizeTab(l),cursor:"ns-resize"
}),q(new g(a,!1,n&&!p,o,p,l,j,e,{row:i,col:c},void 0===f?d.hoverPoints():[],e.customStatsForSlot(c,i)));var r=this.circuitDefinition.gateAtLocIsDisabledReason(new k(c,i));
if(void 0!==r){a.ctx.save(),n&&(a.ctx.globalAlpha*=.3),a.ctx.globalAlpha*=.5,a.fillRect(l.paddedBy(5),"yellow"),a.ctx.globalAlpha*=2,
a.strokeLine(l.topLeft(),l.bottomRight(),"orange",3);var s=a.printParagraph(r,l.paddedBy(5),new k(.5,.5),"red");a.ctx.globalAlpha*=.5,
a.fillRect(s.paddedBy(2),"yellow"),a.ctx.globalAlpha*=2,a.printParagraph(r,l.paddedBy(5),new k(.5,.5),"red"),a.ctx.restore()}}},_drawColumnControlWires:function(a,b,c,d){
var e=this,f=b.gates.length,g=b.gates,h=d.circuitDefinition.colHasEnabledSwapGate(c),j=function(a){return d.circuitDefinition.locHasControllableGate(new k(c,a));
},l=function(a){return e.circuitDefinition.locStartsSingleControlWire(new k(c,a))},m=function(a){return e.circuitDefinition.locStartsDoubleControlWire(new k(c,a));
},n=function(a){return h&&g[a]===i.Special.SwapHalf},o=q.range(f).filter(j).first(null),p=q.range(f).filter(j).last(null),r=q.range(f).filter(l).first(null),s=q.range(f).filter(l).last(null),t=q.range(f).filter(m).first(null),u=q.range(f).filter(m).last(null),v=q.range(f).filter(n).first(null),w=q.range(f).filter(n).last(null),x=Math.round(this.opRect(c).center().x-.5)+.5;
if(null!==r&&null!==o){var y=this.wireRect(Math.min(o,r)).center().y,z=this.wireRect(Math.max(p,s)).center().y;a.strokeLine(new k(x,y),new k(x,z));
}if(null!==v){var A=this.wireRect(v).center().y,B=this.wireRect(w).center().y;a.strokeLine(new k(x,A),new k(x,B))}if(null!==t&&null!==o){
var C=this.wireRect(Math.min(o,t)).center().y,D=this.wireRect(Math.max(p,u)).center().y;a.strokeLine(new k(x+1,C),new k(x+1,D)),a.strokeLine(new k(x-1,C),new k(x-1,D));
}},previewDrop:function(a){return void 0!==a.heldGate?this._previewDropMovedGate(a):this._previewResizedGate(a)},_previewDropMovedGate:function(a){
var c=this.findModificationIndex(a);if(void 0===c)return this;var d=Math.floor(a.holdOffset.y/b.WIRE_SPACING);if(c.row+d>=this.circuitDefinition.numWires)return this;
var e=a.heldGate,g=f.empty(this.circuitDefinition.numWires),h=c.col,i=c.isInsert,j=Math.min(c.row,Math.max(0,b.MAX_WIRE_COUNT-e.height)),k=p(this.circuitDefinition.columns).padded(h,g).ifThen(i,function(a){
return a.withInsertedItem(h,g)}).padded(h+e.width,g).withTransformedItem(h,function(a){return a.withGatesAdded(j,new f([e]))}).toArray(),l=Math.max(this._extraWireStartIndex||0,Math.max(this.circuitDefinition.numWires,e.height+j));
return l>b.MAX_WIRE_COUNT?this:this.withCircuit(this.circuitDefinition.withColumns(k).withWireCount(l))._withHighlightedSlot({row:j,
col:c.col,resizeStyle:!1})._withCompressedColumnIndex(i?h:void 0)._withFallbackExtraWireStartIndex(this.circuitDefinition.numWires);
},_previewResizedGate:function(a){if(void 0===a.resizingGateSlot||void 0===a.pos)return this;var c=this.circuitDefinition.gateInSlot(a.resizingGateSlot.x,a.resizingGateSlot.y);
if(void 0===c)return this;var d=Math.min(this.wireIndexAt(a.pos.y-a.holdOffset.y),b.MAX_WIRE_COUNT-1),e=p(c.gateFamily).minBy(function(b){
return Math.abs(b.height-(d-a.resizingGateSlot.y+1))}),g=Math.min(b.MAX_WIRE_COUNT,Math.max(this.circuitDefinition.numWires,e.height+a.resizingGateSlot.y)),h=p(this.circuitDefinition.columns).withTransformedItem(a.resizingGateSlot.x,function(b){
return new f(p(b.gates).withOverlayedItem(a.resizingGateSlot.y,e).toArray())}).toArray(),i=this.circuitDefinition.withColumns(h).withWireCount(g),j=i.withHeightOverlapsFixed();
return this.withCircuit(j)._withHighlightedSlot(this._highlightedSlot)._withCompressedColumnIndex(i.isEqualTo(j)?void 0:a.resizingGateSlot.x+1)._withFallbackExtraWireStartIndex(this.circuitDefinition.numWires);
},afterDropping:function(a){return this.previewDrop(a)._withCompressedColumnIndex(void 0)},withCircuit:function(a){return new o(this.top,a,this._compressedColumnIndex,this._highlightedSlot,this._extraWireStartIndex);
},_withCompressedColumnIndex:function(a){return new o(this.top,this.circuitDefinition,a,this._highlightedSlot,this._extraWireStartIndex);
},_withHighlightedSlot:function(a){return new o(this.top,this.circuitDefinition,this._compressedColumnIndex,a,this._extraWireStartIndex);
},_withExtraWireStartIndex:function(a){return new o(this.top,this.circuitDefinition,this._compressedColumnIndex,this._highlightedSlot,a);
},_withFallbackExtraWireStartIndex:function(a){return this._withExtraWireStartIndex(this._extraWireStartIndex||a)},withJustEnoughWires:function(a,c){
var d=void 0!==a.heldGate?a.heldGate.height:0,e=this.circuitDefinition.minimumRequiredWireCount(),f=Math.min(b.MAX_WIRE_COUNT,Math.max(d,Math.max(b.MIN_WIRE_COUNT,e)+c));
return this.withCircuit(this.circuitDefinition.withWireCount(f))._withExtraWireStartIndex(0===c?void 0:this.circuitDefinition.numWires);
},findGateOverlappingPos:function(a){var b=this.indexOfDisplayedColumnAt(a.x),c=this.indexOfDisplayedRowAt(a.y);if(void 0!==b&&void 0!==c){
var d=this.circuitDefinition.findGateCoveringSlot(b,c);if(void 0!==d){var e=this.gateRect(d.row,d.col,d.gate.width,d.gate.height);
if(e.containsPoint(a))return{col:d.col,row:d.row,offset:a.minus(e.topLeft())}}}},tryGrab:function(a){var b=void 0!==arguments[1]?arguments[1]:!1,c=this._tryGrabResizeTab(a)||{
newCircuit:this,newHand:a},d=c.newCircuit,e=c.newHand;return d._tryGrabGate(e,b)||{newCircuit:d,newHand:e}},_tryGrabGate:function(a){
var b=void 0!==arguments[1]?arguments[1]:!1;if(!a.isBusy()&&void 0!==a.pos){var c=this.findGateOverlappingPos(a.pos);if(void 0!==c){
var d=c,e=d.col,g=d.row,h=d.offset,i=this.circuitDefinition.columns[e].gates[g],j=p(this.circuitDefinition.columns[e].gates).toArray();
b||(j[g]=null);var k=p(this.circuitDefinition.columns).withOverlayedItem(e,new f(j)).toArray();return{newCircuit:new o(this.top,this.circuitDefinition.withColumns(k),void 0,void 0,this._extraWireStartIndex),
newHand:a.withHeldGate(i,h)}}}},_tryGrabResizeTab:function(a){if(!a.isBusy()&&void 0!==a.pos)for(var b=0;b<this.circuitDefinition.columns.length;b++)for(var c=0;c<this.circuitDefinition.numWires;c++){
var d=this.circuitDefinition.columns[b].gates[c];if(null!==d){var e=this._highlightStatusAt(b,c,a.hoverPoints()).isResizeHighlighted;
if(e){var f=a.pos.minus(this.gateRect(c+d.height-1,b,1,1).center());return{newCircuit:this._withHighlightedSlot({col:b,row:c,resizeStyle:!0
}),newHand:a.withResizeSlot(new k(b,c),f)}}}}},stableDuration:function(){return this.circuitDefinition.stableDuration()},importantWireCount:function(){
return Math.max(this.circuitDefinition.numWires-1,Math.max(b.MIN_WIRE_COUNT,this.circuitDefinition.minimumRequiredWireCount()))},
_drawOutputDisplays:function(a,c,d){for(var e=Math.max(b.MIN_COL_COUNT+(void 0!==this._compressedColumnIndex?1:0),this.circuitDefinition.columns.length)+1,f=this.importantWireCount(),g=0;f>g;g++){
var h=c.controlledWireProbabilityJustAfter(g,1/0);j.paintProbabilityBox(a,h,this.gateRect(g,e),d.hoverPoints());var i=c.qubitDensityMatrix(g,1/0);
void 0!==i&&r(a,i,this.gateRect(g,e+1),d.hoverPoints())}for(var l=e+2,n=0;f>=n+1;n++){var o=c.qubitDensityMatrix(n,1/0),p=this.gateRect(n,l).topLeft(),q=this.gateRect(n,l).bottom()-p.y,s=new m(p.x,p.y,q,q);
j.paintDensityMatrix(a,o,s,d.hoverPoints())}l+=1;var t=this.wireRect(f-1).bottom(),u=this.opRect(e-1).x;a.printParagraph("Local wire states\n(Chance/Bloch/Density)",new m(u+25,t+4,190,40),new k(.5,0),"gray"),
this._drawOutputSuperpositionDisplay(a,c,l,d)},_drawOutputSuperpositionDisplay:function(a,c,d,f){var g,h,i,o,p,q,r=this.importantWireCount();
if(!(r>=b.NO_SUPERPOSITION_DRAWING_WIRE_THRESHOLD)){var s=[Math.floor(r/2),Math.ceil(r/2)],t=(g=s[Symbol.iterator](),(h=g.next()).done?void 0:h.value),u=(h=g.next()).done?void 0:h.value,v=[1<<t,1<<u],w=(i=v[Symbol.iterator](),
(o=i.next()).done?void 0:o.value),x=(o=i.next()).done?void 0:o.value,y=c.finalState.rawBuffer();c.circuitDefinition.numWires!==this.importantWireCount()&&(y=y.slice(0,y.length/2));
var z=new l(w,x,y),A=this.gateRect(0,d),B=this.gateRect(r-1,d),C=new m(A.x,A.y,0,B.bottom()-A.y);C=C.withW(C.h*(w/x)),j.paintMatrix(a,z,C,r<b.SIMPLE_SUPERPOSITION_DRAWING_WIRE_THRESHOLD?b.SUPERPOSITION_MID_COLOR:void 0,"black",r<b.SIMPLE_SUPERPOSITION_DRAWING_WIRE_THRESHOLD?b.SUPERPOSITION_FORE_COLOR:void 0,b.SUPERPOSITION_BACK_COLOR);
var D=function(a){return(a>=0?"+":"")+a.toFixed(2)};j.paintMatrixTooltip(a,z,C,f.hoverPoints(),function(a,b){return"Amplitude of |"+n.bin(b*z.width()+a,r)+"⟩";
},function(a,b,c){return"val:"+c.toString(new e(!1,0,5,", "))},function(a,b,c){return"mag²:"+(100*c.norm2()).toFixed(4)+"%, phase:"+D(180*c.phase()/Math.PI)+"°";
});for(var E=C.withW(C.w+50).withH(C.h+50),F=[C.w/w,C.h/x],G=(p=F[Symbol.iterator](),(q=p.next()).done?void 0:q.value),H=(q=p.next()).done?void 0:q.value,I=function(b){
var c="_".repeat(t)+n.bin(b,u),d=C.right(),e=E.y+H*(b+.5);a.print(c,d+2,e,"left","middle","black","12px monospace",50,H,function(b,c){
a.fillRect(new m(d,e-c/2,b+4,c),"lightgray")})},J=0;x>J;J++)I(J);a.ctx.save(),a.ctx.rotate(Math.PI/2);for(var K=0,L=function(b){var c=E.skipTop(C.h+2).skipLeft(G*b).skipBottom(2).withW(G);
c=new m(c.y,-c.x-c.w,c.h,c.w);var d=n.bin(b,t)+"_".repeat(u),e=E.x+G*(b+.5),f=C.bottom();a.print(d,f+2,-e,"left","middle","black","12px monospace",50,G,function(b,c){
a.fillRect(new m(f,-e-c/2,b+4,c),"lightgray"),K=Math.max(K,b+8)})},M=0;w>M;M++)L(M);a.ctx.restore(),a.printParagraph("Final amplitudes\n(assuming measurement deferred)",E.withY(C.bottom()+K).withH(40).withW(200),new k(0,0),"gray");
}}},{empty:function(c){return new o(c,new a(b.MIN_WIRE_COUNT,[]),void 0,void 0,void 0)},desiredHeight:function(a){return Math.max(b.MIN_WIRE_COUNT,a)*b.WIRE_SPACING+100;
}})}(),v=u;return{get default(){return v}}}),$traceurRuntime.registerModule("src/widgets/InspectorWidget.js",[],function(){"use strict";
var a=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitDefinition.js","src/widgets/InspectorWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/CircuitStats.js","src/widgets/InspectorWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/widgets/DisplayedCircuit.js","src/widgets/InspectorWidget.js"))["default"]),b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/widgets/InspectorWidget.js"))["default"],c=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GateDrawParams.js","src/widgets/InspectorWidget.js"))["default"],d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/widgets/InspectorWidget.js"))["default"],e=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/MathPainter.js","src/widgets/InspectorWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Matrix.js","src/widgets/InspectorWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/Hand.js","src/widgets/InspectorWidget.js"))["default"]),f=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/Painter.js","src/widgets/InspectorWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/widgets/InspectorWidget.js"))["default"]),g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/widgets/InspectorWidget.js")),h=g.seq,i=(g.Seq,
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/widgets/ToolboxWidget.js","src/widgets/InspectorWidget.js"))["default"]),j=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/widgets/InspectorWidget.js"))["default"],
4*(2*b.GATE_RADIUS+2)-b.GATE_RADIUS),k=function(){function g(a,b,c,d){this.displayedCircuit=b,this.toolboxWidget=c,this.hand=d,this.drawArea=new f(0,0,0,0),
this.updateArea(a)}return $traceurRuntime.createClass(g,{desiredWidth:function(){return Math.max(this.toolboxWidget.desiredWidth(),this.displayedCircuit.desiredWidth());
},updateArea:function(a){this.drawArea=a,this.toolboxWidget.updateArea(a.takeTop(j))},paint:function(c,d,e){c.fillRect(this.drawArea,b.BACKGROUND_COLOR),
this.toolboxWidget.paint(c,d,this.hand),this.displayedCircuit.paint(c,this.hand,d,e),this._paintHand(c,d),this._drawHint(c);var f=this.displayedCircuit.top+a.desiredHeight(this.displayedCircuit.circuitDefinition.numWires),g=this.drawArea.bottom(),h=c.ctx.createLinearGradient(0,f,0,g);
h.addColorStop(0,"rgba(255,255,255,0)"),h.addColorStop(1,"white"),c.ctx.fillStyle=h,c.ctx.fillRect(0,f,this.drawArea.w,g-f)},_paintHand:function(a,e){
if(void 0!==this.hand.pos&&void 0!==this.hand.heldGate){var g=this.hand.heldGate,h=this.hand.pos.minus(this.hand.holdOffset),i=new f(Math.round(h.x-.5)+.5,Math.round(h.y-.5)+.5,2*b.GATE_RADIUS+b.WIRE_SPACING*(g.width-1),2*b.GATE_RADIUS+b.WIRE_SPACING*(g.height-1)),j=g.customDrawer||d.DEFAULT_DRAWER;
j(new c(a,!1,!0,!0,!1,i,g,e,void 0,[],void 0))}},afterGrabbing:function(){var a=void 0!==arguments[0]?arguments[0]:!1,b=this.hand,c=this.displayedCircuit;
b=this.toolboxWidget.tryGrab(b);var d=c.tryGrab(b,a);return b=d.newHand,c=d.newCircuit,new g(this.drawArea,c,this.toolboxWidget,b);
},isEqualTo:function(a){return this===a?!0:a instanceof g&&this.drawArea.isEqualTo(a.drawArea)&&this.displayedCircuit.isEqualTo(a.displayedCircuit)&&this.toolboxWidget.isEqualTo(a.toolboxWidget)&&this.hand.isEqualTo(a.hand);
},withCircuitWidget:function(a){return a===this.displayedCircuit?this:new g(this.drawArea,a,this.toolboxWidget,this.hand)},withJustEnoughWires:function(a,b){
return this.withCircuitWidget(this.displayedCircuit.withJustEnoughWires(a,b))},afterTidyingUp:function(){return this.withCircuitWidget(this.displayedCircuit.afterTidyingUp());
},previewDrop:function(){if(!this.hand.isBusy())return this;var a=this.hand,b=this.displayedCircuit,c=b.previewDrop(a),d=c===b?a:a.withDrop();
return this.withHand(d).withCircuitWidget(c)},afterDropping:function(){return this.withCircuitWidget(this.displayedCircuit.afterDropping(this.hand)).withHand(this.hand.withDrop());
},stableDuration:function(){return h([this.toolboxWidget.stableDuration(this.hand),this.hand.stableDuration(),this.displayedCircuit.stableDuration()]).min(1/0);
},withHand:function(a){return new g(this.drawArea,this.displayedCircuit,this.toolboxWidget,a)},withCircuitDefinition:function(b){
return new g(this.drawArea,a.empty(j).withCircuit(b),this.toolboxWidget,e.EMPTY)},_drawHint:function(a){0===this.displayedCircuit.circuitDefinition.columns.length&&(a.ctx.save(),
a.ctx.globalAlpha=void 0!==this.hand.pos&&this.hand.isBusy()?Math.min(1,Math.max(0,(150-this.hand.pos.y)/50)):1,a.ctx.save(),a.ctx.translate(70,190),
a.ctx.rotate(.05*Math.PI),a.ctx.fillStyle="red",a.ctx.font="12pt Helvetica",a.ctx.fillText("drag gates onto circuit",0,0),a.ctx.restore(),
a.ctx.save(),a.ctx.translate(50,240),a.ctx.rotate(.02*Math.PI),a.ctx.fillStyle="red",a.ctx.font="12pt Helvetica",a.ctx.fillText("watch outputs change",0,0),
a.ctx.restore(),a.ctx.beginPath(),a.ctx.moveTo(268,132),a.ctx.bezierCurveTo(260,170,235,175,210,190),a.ctx.moveTo(210,245),a.ctx.bezierCurveTo(275,245,315,215,330,200),
a.ctx.strokeStyle="red",a.ctx.lineWidth=3,a.ctx.stroke(),a.trace(function(a){a.arrowHead(210,190,10,.84*Math.PI,1.3),a.arrowHead(330,200,10,Math.PI*-.23,1.3);
}).thenFill("red"),a.ctx.restore())}},{empty:function(b){return new g(b,a.empty(j),new i(b.takeTop(j)),e.EMPTY)},defaultHeight:function(){
var c=arguments[0];void 0===c&&(c=b.MIN_WIRE_COUNT);var d=4*(2*b.GATE_RADIUS+2)-b.GATE_RADIUS,e=a.desiredHeight(c),f=50;return Math.max(b.MINIMUM_CANVAS_HEIGHT,d+e+f);
}})}(),l=k;return{get default(){return l}}}),$traceurRuntime.registerModule("src/widgets/ToolboxWidget.js",[],function(){"use strict";
var a=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Util.js","src/widgets/ToolboxWidget.js"))["default"],b=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/AllGates.js","src/widgets/ToolboxWidget.js"))["default"],c=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/circuit/GateColumn.js","src/widgets/ToolboxWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GateDrawParams.js","src/widgets/ToolboxWidget.js"))["default"]),d=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/GatePainting.js","src/widgets/ToolboxWidget.js"))["default"],e=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Rect.js","src/widgets/ToolboxWidget.js"))["default"],f=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/math/Point.js","src/widgets/ToolboxWidget.js"))["default"],g=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/base/Seq.js","src/widgets/ToolboxWidget.js")),h=g.seq,i=(g.Seq,
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/Config.js","src/widgets/ToolboxWidget.js"))["default"]),j=($traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/Painter.js","src/widgets/ToolboxWidget.js"))["default"],
$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/ui/WidgetPainter.js","src/widgets/ToolboxWidget.js"))["default"]),k=$traceurRuntime.getModule($traceurRuntime.normalizeModuleName("src/gates/Joke_MysteryGate.js","src/widgets/ToolboxWidget.js")),l=k.MysteryGateSymbol,m=k.MysteryGateMaker,n=function(){
function g(a){this.area=a}return $traceurRuntime.createClass(g,{gateDrawRect:function(a,b){var c=b%2,d=Math.floor(b/2),f=this.area.x+i.TOOLBOX_MARGIN_X+c*i.TOOLBOX_GATE_SPAN+a*i.TOOLBOX_GROUP_SPAN,g=this.area.y+i.TOOLBOX_MARGIN_Y+d*i.TOOLBOX_GATE_SPAN;
return new e(Math.round(f-.5)+.5,Math.round(g-.5)+.5,2*i.GATE_RADIUS,2*i.GATE_RADIUS)},groupLabelRect:function(a){var b=this.gateDrawRect(a,0),c=new f(b.x+i.TOOLBOX_GATE_SPAN-i.TOOLBOX_GATE_SPACING/2,b.y-10);
return new e(c.x-i.TOOLBOX_GATE_SPAN,c.y-5,2*i.TOOLBOX_GATE_SPAN,14)},findGateAt:function(a){if(void 0!==a)for(var c=0;c<b.ToolboxGroups.length;c++)for(var d=b.ToolboxGroups[c],e=0;e<d.gates.length;e++){
var f=d.gates[e];if(void 0!==f&&this.gateDrawRect(c,e).containsPoint(a))return{groupIndex:c,gateIndex:e,gate:f}}},isEqualTo:function(a){
return a instanceof g&&this.area.isEqualTo(a.area)},updateArea:function(a){this.area=a},paint:function(f,g,k){f.fillRect(this.area,i.BACKGROUND_COLOR_TOOLBOX);
for(var l=0;l<b.ToolboxGroups.length;l++){var m=b.ToolboxGroups[l];f.printLine(m.hint,this.groupLabelRect(l),.5,"black",16);var n=this,o=function(b){
var e=m.gates[b];if(void 0===e)return 0;var i=n.gateDrawRect(l,b),j=h(k.hoverPoints()).any(function(a){return i.containsPoint(a)}),o=e.customDrawer||d.DEFAULT_DRAWER;
f.noteTouchBlocker({rect:i,cursor:"pointer"}),o(new c(f,!0,j,!1,!1,i,a.notNull(e),g,void 0,[],void 0))},p=void 0;a:for(var q=0;q<m.gates.length;q++)switch(p=o(q)){
case 0:continue a}}var r=this.findGateAt(k.pos);if(void 0!==r&&(void 0===k.heldGate||r.gate.symbol===k.heldGate.symbol)){var s=this.gateDrawRect(r.groupIndex,r.gateIndex),t=new e(s.right()+1,s.center().y,500,200).snapInside(f.paintableArea().skipTop(s.y));
f.defer(function(){return j.paintGateTooltip(f,t,r.gate,g.time)})}var u=new e(0,0,i.TOOLBOX_MARGIN_X,this.area.h),v=u.center(),w=v.x,x=v.y;
f.ctx.save(),f.ctx.translate(w,x),f.ctx.rotate(-Math.PI/2),f.printLine("Toolbox",new e(-u.h/2,-u.w/2,u.h,u.w),.5,"black",24),f.ctx.restore();
},desiredWidth:function(){return this.gateDrawRect(b.ToolboxGroups.length-1,5).right()+5},tryGrab:function(a){if(void 0===a.pos||a.isBusy())return a;
var c=this.findGateAt(a.pos);return void 0===c?a:(c.gate.symbol===l&&(b.ToolboxGroups[c.groupIndex].gates[c.gateIndex]=m()),a.withHeldGate(c.gate,new f(i.GATE_RADIUS,i.GATE_RADIUS)));
},stableDuration:function(a){var b=this;return h(a.hoverPoints()).map(function(a){return b.findGateAt(a)}).filter(function(a){return void 0!==a;
}).map(function(a){return a.gate.stableDuration()}).min(1/0)}},{})}(),o=n;return{get default(){return o}}}),$traceurRuntime.getModule("src/main.js");